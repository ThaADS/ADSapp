{"version":3,"names":["EnhancedWhatsAppClient","cov_1qdm7h2fji","f","s","getWhatsAppClient","constructor","accessToken","apiVersion","baseUrl","downloadMedia","mediaId","mediaResponse","fetch","headers","ok","b","Error","statusText","mediaData","json","fileResponse","url","Buffer","from","arrayBuffer","error","console","uploadMedia","file","type","filename","formData","FormData","blob","Blob","append","response","method","body","result","id","sendMessage","phoneNumberId","to","message","JSON","stringify","messaging_product","errorData","messages","markAsRead","messageId","status","message_id","getBusinessProfile","createTemplate","businessAccountId","template","getTemplates","data","deleteTemplate","templateName","name","organizationId","supabase","_server","createClient","organization","select","eq","single","whatsapp_access_token"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\lib\\whatsapp\\enhanced-client.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/server'\n\nexport interface WhatsAppMedia {\n  id: string\n  url?: string\n  mimeType: string\n  filename?: string\n  caption?: string\n  sha256?: string\n  fileSize?: number\n}\n\nexport interface WhatsAppMessage {\n  id: string\n  from: string\n  timestamp: string\n  type: 'text' | 'image' | 'document' | 'audio' | 'video' | 'location' | 'contacts' | 'sticker' | 'button' | 'list' | 'interactive'\n  text?: {\n    body: string\n  }\n  image?: WhatsAppMedia & { caption?: string }\n  document?: WhatsAppMedia & { caption?: string }\n  audio?: WhatsAppMedia\n  video?: WhatsAppMedia & { caption?: string }\n  location?: {\n    latitude: number\n    longitude: number\n    name?: string\n    address?: string\n  }\n  contacts?: Array<{\n    name: {\n      formatted_name: string\n      first_name?: string\n      last_name?: string\n    }\n    phones?: Array<{\n      phone: string\n      type?: string\n    }>\n    emails?: Array<{\n      email: string\n      type?: string\n    }>\n  }>\n  button?: {\n    text: string\n    payload: string\n  }\n  interactive?: {\n    type: 'button_reply' | 'list_reply'\n    button_reply?: {\n      id: string\n      title: string\n    }\n    list_reply?: {\n      id: string\n      title: string\n      description?: string\n    }\n  }\n  context?: {\n    from: string\n    id: string\n  }\n  errors?: Array<{\n    code: number\n    title: string\n    message: string\n  }>\n}\n\nexport interface WhatsAppStatus {\n  id: string\n  status: 'sent' | 'delivered' | 'read' | 'failed'\n  timestamp: string\n  recipient_id: string\n  conversation?: {\n    id: string\n    origin?: {\n      type: string\n    }\n  }\n  pricing?: {\n    billable: boolean\n    pricing_model: string\n    category: string\n  }\n  errors?: Array<{\n    code: number\n    title: string\n    message: string\n    error_data?: {\n      details: string\n    }\n  }>\n}\n\nexport interface WhatsAppContact {\n  profile: {\n    name: string\n  }\n  wa_id: string\n}\n\nexport interface WhatsAppWebhookValue {\n  messaging_product: string\n  metadata: {\n    display_phone_number: string\n    phone_number_id: string\n  }\n  contacts?: WhatsAppContact[]\n  messages?: WhatsAppMessage[]\n  statuses?: WhatsAppStatus[]\n}\n\nexport class EnhancedWhatsAppClient {\n  private apiVersion: string = 'v18.0'\n  private baseUrl: string = 'https://graph.facebook.com'\n  private accessToken: string\n\n  constructor(accessToken: string) {\n    this.accessToken = accessToken\n  }\n\n  async downloadMedia(mediaId: string): Promise<Buffer> {\n    try {\n      // First, get the media URL\n      const mediaResponse = await fetch(\n        `${this.baseUrl}/${this.apiVersion}/${mediaId}`,\n        {\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`\n          }\n        }\n      )\n\n      if (!mediaResponse.ok) {\n        throw new Error(`Failed to get media URL: ${mediaResponse.statusText}`)\n      }\n\n      const mediaData = await mediaResponse.json()\n\n      // Download the actual media file\n      const fileResponse = await fetch(mediaData.url, {\n        headers: {\n          'Authorization': `Bearer ${this.accessToken}`\n        }\n      })\n\n      if (!fileResponse.ok) {\n        throw new Error(`Failed to download media: ${fileResponse.statusText}`)\n      }\n\n      return Buffer.from(await fileResponse.arrayBuffer())\n    } catch (error) {\n      console.error('Error downloading media:', error)\n      throw error\n    }\n  }\n\n  async uploadMedia(file: Buffer, type: string, filename?: string): Promise<string> {\n    try {\n      const formData = new FormData()\n      const blob = new Blob([file], { type })\n\n      formData.append('file', blob, filename)\n      formData.append('type', type)\n      formData.append('messaging_product', 'whatsapp')\n\n      const response = await fetch(\n        `${this.baseUrl}/${this.apiVersion}/media`,\n        {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`\n          },\n          body: formData\n        }\n      )\n\n      if (!response.ok) {\n        throw new Error(`Failed to upload media: ${response.statusText}`)\n      }\n\n      const result = await response.json()\n      return result.id\n    } catch (error) {\n      console.error('Error uploading media:', error)\n      throw error\n    }\n  }\n\n  async sendMessage(phoneNumberId: string, to: string, message: Record<string, unknown>): Promise<string> {\n    try {\n      const response = await fetch(\n        `${this.baseUrl}/${this.apiVersion}/${phoneNumberId}/messages`,\n        {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`,\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            messaging_product: 'whatsapp',\n            to,\n            ...message\n          })\n        }\n      )\n\n      if (!response.ok) {\n        const errorData = await response.json()\n        throw new Error(`Failed to send message: ${JSON.stringify(errorData)}`)\n      }\n\n      const result = await response.json()\n      return result.messages[0].id\n    } catch (error) {\n      console.error('Error sending message:', error)\n      throw error\n    }\n  }\n\n  async markAsRead(phoneNumberId: string, messageId: string): Promise<void> {\n    try {\n      const response = await fetch(\n        `${this.baseUrl}/${this.apiVersion}/${phoneNumberId}/messages`,\n        {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`,\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            messaging_product: 'whatsapp',\n            status: 'read',\n            message_id: messageId\n          })\n        }\n      )\n\n      if (!response.ok) {\n        throw new Error(`Failed to mark message as read: ${response.statusText}`)\n      }\n    } catch (error) {\n      console.error('Error marking message as read:', error)\n      throw error\n    }\n  }\n\n  async getBusinessProfile(phoneNumberId: string): Promise<Record<string, unknown>> {\n    try {\n      const response = await fetch(\n        `${this.baseUrl}/${this.apiVersion}/${phoneNumberId}?fields=verified_name,display_phone_number,quality_rating,messaging_limit_tier`,\n        {\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`\n          }\n        }\n      )\n\n      if (!response.ok) {\n        throw new Error(`Failed to get business profile: ${response.statusText}`)\n      }\n\n      return await response.json()\n    } catch (error) {\n      console.error('Error getting business profile:', error)\n      throw error\n    }\n  }\n\n  async createTemplate(businessAccountId: string, template: Record<string, unknown>): Promise<string> {\n    try {\n      const response = await fetch(\n        `${this.baseUrl}/${this.apiVersion}/${businessAccountId}/message_templates`,\n        {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`,\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(template)\n        }\n      )\n\n      if (!response.ok) {\n        const errorData = await response.json()\n        throw new Error(`Failed to create template: ${JSON.stringify(errorData)}`)\n      }\n\n      const result = await response.json()\n      return result.id\n    } catch (error) {\n      console.error('Error creating template:', error)\n      throw error\n    }\n  }\n\n  async getTemplates(businessAccountId: string): Promise<Record<string, unknown>[]> {\n    try {\n      const response = await fetch(\n        `${this.baseUrl}/${this.apiVersion}/${businessAccountId}/message_templates`,\n        {\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`\n          }\n        }\n      )\n\n      if (!response.ok) {\n        throw new Error(`Failed to get templates: ${response.statusText}`)\n      }\n\n      const result = await response.json()\n      return result.data || []\n    } catch (error) {\n      console.error('Error getting templates:', error)\n      throw error\n    }\n  }\n\n  async deleteTemplate(businessAccountId: string, templateName: string): Promise<void> {\n    try {\n      const response = await fetch(\n        `${this.baseUrl}/${this.apiVersion}/${businessAccountId}/message_templates`,\n        {\n          method: 'DELETE',\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`,\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            name: templateName\n          })\n        }\n      )\n\n      if (!response.ok) {\n        throw new Error(`Failed to delete template: ${response.statusText}`)\n      }\n    } catch (error) {\n      console.error('Error deleting template:', error)\n      throw error\n    }\n  }\n}\n\nexport async function getWhatsAppClient(organizationId: string): Promise<EnhancedWhatsAppClient> {\n  const supabase = await createClient()\n\n  const { data: organization, error } = await supabase\n    .from('organizations')\n    .select('whatsapp_access_token')\n    .eq('id', organizationId)\n    .single()\n\n  if (error || !organization?.whatsapp_access_token) {\n    throw new Error('WhatsApp access token not found for organization')\n  }\n\n  return new EnhancedWhatsAppClient(organization.whatsapp_access_token)\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}