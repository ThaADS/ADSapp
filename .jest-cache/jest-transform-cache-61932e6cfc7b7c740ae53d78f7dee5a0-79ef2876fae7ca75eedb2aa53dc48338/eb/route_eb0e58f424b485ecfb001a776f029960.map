{"version":3,"names":["cov_sgk609bab","actualCoverage","s","POST","request","f","organizationId","headers","get","setAsDefault","b","usage","json","_server","NextResponse","error","status","paymentMethodManager","_paymentmethods","PaymentMethodManager","setupIntent","createSetupIntent","console","Error","message"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\billing\\payment-methods\\setup\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createClient } from '@/lib/supabase/server'\nimport { PaymentMethodManager } from '@/lib/billing/payment-methods'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const organizationId = request.headers.get('X-Organization-ID')\n    const { setAsDefault = false, usage = 'off_session' } = await request.json()\n\n    if (!organizationId) {\n      return NextResponse.json(\n        { error: 'Organization ID is required' },\n        { status: 400 }\n      )\n    }\n\n    const paymentMethodManager = new PaymentMethodManager()\n    const setupIntent = await paymentMethodManager.createSetupIntent(organizationId, {\n      setAsDefault,\n      usage,\n    })\n\n    return NextResponse.json(setupIntent)\n  } catch (error) {\n    console.error('Setup intent API error:', error)\n    return NextResponse.json(\n      { error: error instanceof Error ? error.message : 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAOI;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAAAA,aAAA,GAAAE,CAAA;;;;;;+BAHkB;;;;;;WAAAC,IAAA;;;;;iCAJoB;;;iCAEL;AAE9B,eAAeA,KAAKC,OAAoB;EAAA;EAAAJ,aAAA,GAAAK,CAAA;EAAAL,aAAA,GAAAE,CAAA;EAC7C,IAAI;IACF,MAAMI,cAAA;IAAA;IAAA,CAAAN,aAAA,GAAAE,CAAA,OAAiBE,OAAA,CAAQG,OAAO,CAACC,GAAG,CAAC;IAC3C,MAAM;MAAEC,YAAA;MAAA;MAAA,CAAAT,aAAA,GAAAU,CAAA,UAAe,KAAK;MAAEC,KAAA;MAAA;MAAA,CAAAX,aAAA,GAAAU,CAAA,UAAQ,aAAa;IAAA,CAAE;IAAA;IAAA,CAAAV,aAAA,GAAAE,CAAA,OAAG,MAAME,OAAA,CAAQQ,IAAI;IAAA;IAAAZ,aAAA,GAAAE,CAAA;IAE1E,IAAI,CAACI,cAAA,EAAgB;MAAA;MAAAN,aAAA,GAAAU,CAAA;MAAAV,aAAA,GAAAE,CAAA;MACnB,OAAOW,OAAA,CAAAC,YAAY,CAACF,IAAI,CACtB;QAAEG,KAAA,EAAO;MAA8B,GACvC;QAAEC,MAAA,EAAQ;MAAI;IAElB;IAAA;IAAA;MAAAhB,aAAA,GAAAU,CAAA;IAAA;IAEA,MAAMO,oBAAA;IAAA;IAAA,CAAAjB,aAAA,GAAAE,CAAA,QAAuB,IAAIgB,eAAA,CAAAC,oBAAoB;IACrD,MAAMC,WAAA;IAAA;IAAA,CAAApB,aAAA,GAAAE,CAAA,QAAc,MAAMe,oBAAA,CAAqBI,iBAAiB,CAACf,cAAA,EAAgB;MAC/EG,YAAA;MACAE;IACF;IAAA;IAAAX,aAAA,GAAAE,CAAA;IAEA,OAAOW,OAAA,CAAAC,YAAY,CAACF,IAAI,CAACQ,WAAA;EAC3B,EAAE,OAAOL,KAAA,EAAO;IAAA;IAAAf,aAAA,GAAAE,CAAA;IACdoB,OAAA,CAAQP,KAAK,CAAC,2BAA2BA,KAAA;IAAA;IAAAf,aAAA,GAAAE,CAAA;IACzC,OAAOW,OAAA,CAAAC,YAAY,CAACF,IAAI,CACtB;MAAEG,KAAA,EAAOA,KAAA,YAAiBQ,KAAA;MAAA;MAAA,CAAAvB,aAAA,GAAAU,CAAA,UAAQK,KAAA,CAAMS,OAAO;MAAA;MAAA,CAAAxB,aAAA,GAAAU,CAAA,UAAG;IAAwB,GAC1E;MAAEM,MAAA,EAAQ;IAAI;EAElB;AACF","ignoreList":[]}