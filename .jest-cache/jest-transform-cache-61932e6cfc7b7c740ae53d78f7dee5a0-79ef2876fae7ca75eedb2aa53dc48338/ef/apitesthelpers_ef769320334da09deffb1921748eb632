9d3e7b3fa3ca577df89bfef9abfa52bd
/**
 * API Test Helpers
 *
 * Utilities for testing API routes including request mocking,
 * response validation, and authentication helpers.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get ApiErrors () {
        return ApiErrors;
    },
    get ApiTestScenarios () {
        return ApiTestScenarios;
    },
    get createApiError () {
        return createApiError;
    },
    get createAuthenticatedRequest () {
        return createAuthenticatedRequest;
    },
    get createInvalidRequestBodies () {
        return createInvalidRequestBodies;
    },
    get createMockJwtToken () {
        return createMockJwtToken;
    },
    get createMockRequest () {
        return createMockRequest;
    },
    get createPaginatedResponse () {
        return createPaginatedResponse;
    },
    get createPaginatedUrl () {
        return createPaginatedUrl;
    },
    get createPaginationParams () {
        return createPaginationParams;
    },
    get createUnauthenticatedRequest () {
        return createUnauthenticatedRequest;
    },
    get default () {
        return _default;
    },
    get expectErrorResponse () {
        return expectErrorResponse;
    },
    get expectPaginatedResponse () {
        return expectPaginatedResponse;
    },
    get expectSuccessResponse () {
        return expectSuccessResponse;
    },
    get extractResponseData () {
        return extractResponseData;
    },
    get mockApiRequest () {
        return mockApiRequest;
    },
    get mockApiResponse () {
        return mockApiResponse;
    },
    get mockAuthMiddlewareFailure () {
        return mockAuthMiddlewareFailure;
    },
    get mockAuthMiddlewareSuccess () {
        return mockAuthMiddlewareSuccess;
    },
    get mockDatabaseError () {
        return mockDatabaseError;
    },
    get mockDatabaseQuery () {
        return mockDatabaseQuery;
    },
    get mockErrorResponse () {
        return mockErrorResponse;
    },
    get mockTenantIsolation () {
        return mockTenantIsolation;
    },
    get parseResponse () {
        return parseResponse;
    },
    get simulateRateLimit () {
        return simulateRateLimit;
    },
    get simulateRateLimitOk () {
        return simulateRateLimitOk;
    },
    get validateRequestBody () {
        return validateRequestBody;
    }
});
const _server = require("next/server");
const _testhelpers = require("./test-helpers");
function mockApiRequest(options = {}) {
    const { method = 'GET', url = 'http://localhost:3000/api/test', body, headers = {}, searchParams = {}, cookies = {} } = options;
    // Construct URL with search params
    const urlObj = new URL(url);
    Object.entries(searchParams).forEach(([key, value])=>{
        urlObj.searchParams.set(key, value);
    });
    // Create request init object
    const init = {
        method,
        headers: new Headers({
            'Content-Type': 'application/json',
            ...headers
        })
    };
    // Add body if present
    if (body) {
        init.body = JSON.stringify(body);
    }
    // Create the request
    const request = new _server.NextRequest(urlObj.toString(), init);
    // Add cookies if present
    Object.entries(cookies).forEach(([key, value])=>{
        request.cookies.set(key, value);
    });
    return request;
}
function createAuthenticatedRequest(options = {}) {
    const user = (0, _testhelpers.createMockUser)(options.user);
    const organizationId = options.organizationId || user.organization_id;
    // Add authentication headers
    const headers = {
        ...options.headers,
        'x-user-id': user.id,
        'x-organization-id': organizationId,
        Authorization: `Bearer mock-jwt-token-${user.id}`
    };
    return mockApiRequest({
        ...options,
        headers
    });
}
function createUnauthenticatedRequest(options = {}) {
    return mockApiRequest(options);
}
function mockApiResponse(data, status = 200) {
    return _server.NextResponse.json(data, {
        status
    });
}
function mockErrorResponse(message, status = 400) {
    return _server.NextResponse.json({
        error: message
    }, {
        status
    });
}
async function extractResponseData(response) {
    const data = await response.json();
    return {
        status: response.status,
        data,
        headers: response.headers
    };
}
async function parseResponse(response) {
    const text = await response.text();
    let data;
    try {
        data = JSON.parse(text);
    } catch  {
        data = text;
    }
    return {
        status: response.status,
        data,
        headers: response.headers
    };
}
function expectSuccessResponse(response, expectedStatus = 200) {
    expect(response.status).toBe(expectedStatus);
    expect(response.headers.get('content-type')).toContain('application/json');
}
function expectErrorResponse(response, expectedStatus = 400, errorMessage) {
    expect(response.status).toBe(expectedStatus);
    expect(response.headers.get('content-type')).toContain('application/json');
    if (errorMessage) {
        response.json().then((data)=>{
            expect(data.error).toContain(errorMessage);
        });
    }
}
function createMockJwtToken(userId, organizationId) {
    const payload = {
        sub: userId,
        org_id: organizationId,
        role: 'agent',
        iat: Math.floor(Date.now() / 1000),
        exp: Math.floor(Date.now() / 1000) + 3600
    };
    // In real implementation, this would be signed with a secret
    const base64Payload = Buffer.from(JSON.stringify(payload)).toString('base64');
    return `mock.${base64Payload}.signature`;
}
function mockAuthMiddlewareSuccess(user) {
    jest.mock('@/lib/api-middleware', ()=>({
            withAuth: (handler)=>handler,
            getCurrentUser: jest.fn().mockResolvedValue(user),
            requireRole: (role)=>(handler)=>handler
        }));
}
function mockAuthMiddlewareFailure(error = 'Unauthorized') {
    jest.mock('@/lib/api-middleware', ()=>({
            withAuth: ()=>{
                throw new Error(error);
            },
            getCurrentUser: jest.fn().mockRejectedValue(new Error(error))
        }));
}
function validateRequestBody(body, requiredFields) {
    const missingFields = requiredFields.filter((field)=>!(field in body));
    return {
        valid: missingFields.length === 0,
        missingFields
    };
}
function createInvalidRequestBodies(validBody) {
    const invalidBodies = [];
    // Missing each required field
    Object.keys(validBody).forEach((key)=>{
        const body = {
            ...validBody
        };
        delete body[key];
        invalidBodies.push(body);
    });
    // Empty strings for string fields
    Object.entries(validBody).forEach(([key, value])=>{
        if (typeof value === 'string') {
            invalidBodies.push({
                ...validBody,
                [key]: ''
            });
        }
    });
    // Invalid types
    Object.entries(validBody).forEach(([key, value])=>{
        if (typeof value === 'string') {
            invalidBodies.push({
                ...validBody,
                [key]: 123
            });
        }
        if (typeof value === 'number') {
            invalidBodies.push({
                ...validBody,
                [key]: 'invalid'
            });
        }
    });
    return invalidBodies;
}
function mockDatabaseQuery(data) {
    return {
        data,
        error: null
    };
}
function mockDatabaseError(message) {
    return {
        data: null,
        error: {
            message,
            code: 'PGRST116'
        }
    };
}
function mockTenantIsolation(organizationId) {
    return jest.fn().mockImplementation((query)=>{
        return {
            ...query,
            eq: jest.fn((field, value)=>{
                if (field === 'organization_id') {
                    expect(value).toBe(organizationId);
                }
                return query;
            })
        };
    });
}
function simulateRateLimit(maxRequests = 100) {
    return {
        shouldBlock: true,
        remaining: 0
    };
}
function simulateRateLimitOk(remaining = 95) {
    return {
        shouldBlock: false,
        remaining
    };
}
const ApiErrors = {
    Unauthorized: {
        status: 401,
        message: 'Unauthorized - Please sign in'
    },
    Forbidden: {
        status: 403,
        message: 'Forbidden - Insufficient permissions'
    },
    NotFound: {
        status: 404,
        message: 'Resource not found'
    },
    BadRequest: {
        status: 400,
        message: 'Bad request - Invalid input'
    },
    Conflict: {
        status: 409,
        message: 'Conflict - Resource already exists'
    },
    InternalServerError: {
        status: 500,
        message: 'Internal server error'
    },
    TooManyRequests: {
        status: 429,
        message: 'Too many requests - Please try again later'
    }
};
function createApiError(errorType, customMessage) {
    const error = ApiErrors[errorType];
    return _server.NextResponse.json({
        error: customMessage || error.message
    }, {
        status: error.status
    });
}
function createPaginationParams(page = 1, limit = 20) {
    return {
        page,
        limit,
        offset: (page - 1) * limit
    };
}
function createPaginatedResponse(data, page, limit, total) {
    return {
        data,
        pagination: {
            page,
            limit,
            total,
            total_pages: Math.ceil(total / limit),
            has_next: page * limit < total,
            has_prev: page > 1
        }
    };
}
const ApiTestScenarios = {
    /**
   * Test authentication requirement
   */ requiresAuth: async (handler)=>{
        const request = createUnauthenticatedRequest();
        const response = await handler(request);
        expectErrorResponse(response, 401);
    },
    /**
   * Test tenant isolation
   */ enforcesTenantIsolation: async (handler, organizationId)=>{
        const request = createAuthenticatedRequest({
            organizationId
        });
        // Handler should only access data from this organization
        const response = await handler(request);
        expectSuccessResponse(response);
    },
    /**
   * Test input validation
   */ validatesInput: async (handler, validBody, requiredFields)=>{
        const invalidBodies = createInvalidRequestBodies(validBody);
        for (const body of invalidBodies){
            const request = createAuthenticatedRequest({
                body,
                method: 'POST'
            });
            const response = await handler(request);
            expectErrorResponse(response, 400);
        }
    },
    /**
   * Test rate limiting
   */ enforcesRateLimit: async (handler, maxRequests = 100)=>{
        // Simulate max requests
        for(let i = 0; i < maxRequests + 1; i++){
            const request = createAuthenticatedRequest();
            const response = await handler(request);
            if (i < maxRequests) {
                expect(response.status).not.toBe(429);
            } else {
                expectErrorResponse(response, 429);
            }
        }
    }
};
const createMockRequest = mockApiRequest;
function createPaginatedUrl(baseUrl, params) {
    const url = new URL(baseUrl, 'http://localhost:3000');
    if (params.page) url.searchParams.set('page', params.page.toString());
    if (params.limit) url.searchParams.set('limit', params.limit.toString());
    if (params.sort) url.searchParams.set('sort', params.sort);
    if (params.order) url.searchParams.set('order', params.order);
    return url.toString();
}
function expectPaginatedResponse(data) {
    expect(data).toHaveProperty('pagination');
    expect(data.pagination).toHaveProperty('page');
    expect(data.pagination).toHaveProperty('limit');
    expect(data.pagination).toHaveProperty('total');
}
const _default = {
    mockApiRequest,
    createMockRequest,
    createAuthenticatedRequest,
    createUnauthenticatedRequest,
    mockApiResponse,
    mockErrorResponse,
    extractResponseData,
    parseResponse,
    expectSuccessResponse,
    expectErrorResponse,
    createMockJwtToken,
    mockAuthMiddlewareSuccess,
    mockAuthMiddlewareFailure,
    validateRequestBody,
    createInvalidRequestBodies,
    mockDatabaseQuery,
    mockDatabaseError,
    mockTenantIsolation,
    simulateRateLimit,
    simulateRateLimitOk,
    ApiErrors,
    createApiError,
    createPaginationParams,
    createPaginatedResponse,
    ApiTestScenarios
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxBaSBQcm9qZWN0ZW5cXEFEU2FwcFxcdGVzdHNcXHV0aWxzXFxhcGktdGVzdC1oZWxwZXJzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQVBJIFRlc3QgSGVscGVyc1xuICpcbiAqIFV0aWxpdGllcyBmb3IgdGVzdGluZyBBUEkgcm91dGVzIGluY2x1ZGluZyByZXF1ZXN0IG1vY2tpbmcsXG4gKiByZXNwb25zZSB2YWxpZGF0aW9uLCBhbmQgYXV0aGVudGljYXRpb24gaGVscGVycy5cbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgdHlwZSB7IFByb2ZpbGUgfSBmcm9tICdAL3R5cGVzL2RhdGFiYXNlJ1xuaW1wb3J0IHsgY3JlYXRlTW9ja1VzZXIgfSBmcm9tICcuL3Rlc3QtaGVscGVycydcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFR5cGUgRGVmaW5pdGlvbnNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9ja1JlcXVlc3RPcHRpb25zIHtcbiAgbWV0aG9kPzogc3RyaW5nXG4gIHVybD86IHN0cmluZ1xuICBib2R5PzogYW55XG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4gIHNlYXJjaFBhcmFtcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgY29va2llcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBNb2NrQXV0aGVudGljYXRlZFJlcXVlc3RPcHRpb25zIGV4dGVuZHMgTW9ja1JlcXVlc3RPcHRpb25zIHtcbiAgdXNlcj86IFBhcnRpYWw8UHJvZmlsZT5cbiAgb3JnYW5pemF0aW9uSWQ/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBcGlUZXN0UmVzcG9uc2Uge1xuICBzdGF0dXM6IG51bWJlclxuICBkYXRhOiBhbnlcbiAgaGVhZGVyczogSGVhZGVyc1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUmVxdWVzdCBNb2NraW5nXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIENyZWF0ZXMgYSBtb2NrIE5leHRSZXF1ZXN0IG9iamVjdCBmb3IgQVBJIHRlc3RpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1vY2tBcGlSZXF1ZXN0KG9wdGlvbnM6IE1vY2tSZXF1ZXN0T3B0aW9ucyA9IHt9KTogTmV4dFJlcXVlc3Qge1xuICBjb25zdCB7XG4gICAgbWV0aG9kID0gJ0dFVCcsXG4gICAgdXJsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdGVzdCcsXG4gICAgYm9keSxcbiAgICBoZWFkZXJzID0ge30sXG4gICAgc2VhcmNoUGFyYW1zID0ge30sXG4gICAgY29va2llcyA9IHt9LFxuICB9ID0gb3B0aW9uc1xuXG4gIC8vIENvbnN0cnVjdCBVUkwgd2l0aCBzZWFyY2ggcGFyYW1zXG4gIGNvbnN0IHVybE9iaiA9IG5ldyBVUkwodXJsKVxuICBPYmplY3QuZW50cmllcyhzZWFyY2hQYXJhbXMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgIHVybE9iai5zZWFyY2hQYXJhbXMuc2V0KGtleSwgdmFsdWUpXG4gIH0pXG5cbiAgLy8gQ3JlYXRlIHJlcXVlc3QgaW5pdCBvYmplY3RcbiAgY29uc3QgaW5pdDogUmVxdWVzdEluaXQgPSB7XG4gICAgbWV0aG9kLFxuICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAuLi5oZWFkZXJzLFxuICAgIH0pLFxuICB9XG5cbiAgLy8gQWRkIGJvZHkgaWYgcHJlc2VudFxuICBpZiAoYm9keSkge1xuICAgIGluaXQuYm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHkpXG4gIH1cblxuICAvLyBDcmVhdGUgdGhlIHJlcXVlc3RcbiAgY29uc3QgcmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCh1cmxPYmoudG9TdHJpbmcoKSwgaW5pdClcblxuICAvLyBBZGQgY29va2llcyBpZiBwcmVzZW50XG4gIE9iamVjdC5lbnRyaWVzKGNvb2tpZXMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgIHJlcXVlc3QuY29va2llcy5zZXQoa2V5LCB2YWx1ZSlcbiAgfSlcblxuICByZXR1cm4gcmVxdWVzdFxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBtb2NrIGF1dGhlbnRpY2F0ZWQgQVBJIHJlcXVlc3RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUF1dGhlbnRpY2F0ZWRSZXF1ZXN0KFxuICBvcHRpb25zOiBNb2NrQXV0aGVudGljYXRlZFJlcXVlc3RPcHRpb25zID0ge31cbik6IE5leHRSZXF1ZXN0IHtcbiAgY29uc3QgdXNlciA9IGNyZWF0ZU1vY2tVc2VyKG9wdGlvbnMudXNlcilcbiAgY29uc3Qgb3JnYW5pemF0aW9uSWQgPSBvcHRpb25zLm9yZ2FuaXphdGlvbklkIHx8IHVzZXIub3JnYW5pemF0aW9uX2lkXG5cbiAgLy8gQWRkIGF1dGhlbnRpY2F0aW9uIGhlYWRlcnNcbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAuLi5vcHRpb25zLmhlYWRlcnMsXG4gICAgJ3gtdXNlci1pZCc6IHVzZXIuaWQsXG4gICAgJ3gtb3JnYW5pemF0aW9uLWlkJzogb3JnYW5pemF0aW9uSWQsXG4gICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciBtb2NrLWp3dC10b2tlbi0ke3VzZXIuaWR9YCxcbiAgfVxuXG4gIHJldHVybiBtb2NrQXBpUmVxdWVzdCh7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBoZWFkZXJzLFxuICB9KVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBtb2NrIHVuYXV0aGVudGljYXRlZCBBUEkgcmVxdWVzdFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVW5hdXRoZW50aWNhdGVkUmVxdWVzdChvcHRpb25zOiBNb2NrUmVxdWVzdE9wdGlvbnMgPSB7fSk6IE5leHRSZXF1ZXN0IHtcbiAgcmV0dXJuIG1vY2tBcGlSZXF1ZXN0KG9wdGlvbnMpXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBSZXNwb25zZSBNb2NraW5nICYgVmFsaWRhdGlvblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBNb2NrcyBhIHN1Y2Nlc3NmdWwgQVBJIHJlc3BvbnNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtb2NrQXBpUmVzcG9uc2UoZGF0YTogYW55LCBzdGF0dXMgPSAyMDApOiBOZXh0UmVzcG9uc2Uge1xuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZGF0YSwgeyBzdGF0dXMgfSlcbn1cblxuLyoqXG4gKiBNb2NrcyBhbiBlcnJvciBBUEkgcmVzcG9uc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1vY2tFcnJvclJlc3BvbnNlKG1lc3NhZ2U6IHN0cmluZywgc3RhdHVzID0gNDAwKTogTmV4dFJlc3BvbnNlIHtcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IG1lc3NhZ2UgfSwgeyBzdGF0dXMgfSlcbn1cblxuLyoqXG4gKiBFeHRyYWN0cyByZXNwb25zZSBkYXRhIGZvciB0ZXN0aW5nXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleHRyYWN0UmVzcG9uc2VEYXRhKHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UpOiBQcm9taXNlPEFwaVRlc3RSZXNwb25zZT4ge1xuICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gIHJldHVybiB7XG4gICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgZGF0YSxcbiAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzLFxuICB9XG59XG5cbi8qKlxuICogUGFyc2VzIHJlc3BvbnNlIGZvciB0ZXN0aW5nICh3b3JrcyB3aXRoIGJvdGggTmV4dFJlc3BvbnNlIGFuZCBSZXNwb25zZSlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBhcnNlUmVzcG9uc2UocmVzcG9uc2U6IGFueSk6IFByb21pc2U8QXBpVGVzdFJlc3BvbnNlPiB7XG4gIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KClcbiAgbGV0IGRhdGE6IGFueVxuICB0cnkge1xuICAgIGRhdGEgPSBKU09OLnBhcnNlKHRleHQpXG4gIH0gY2F0Y2gge1xuICAgIGRhdGEgPSB0ZXh0XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICBkYXRhLFxuICAgIGhlYWRlcnM6IHJlc3BvbnNlLmhlYWRlcnNcbiAgfVxufVxuXG4vKipcbiAqIFZhbGlkYXRlcyBzdWNjZXNzZnVsIEFQSSByZXNwb25zZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwZWN0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlOiBOZXh0UmVzcG9uc2UsIGV4cGVjdGVkU3RhdHVzID0gMjAwKTogdm9pZCB7XG4gIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoZXhwZWN0ZWRTdGF0dXMpXG4gIGV4cGVjdChyZXNwb25zZS5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpLnRvQ29udGFpbignYXBwbGljYXRpb24vanNvbicpXG59XG5cbi8qKlxuICogVmFsaWRhdGVzIGVycm9yIEFQSSByZXNwb25zZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwZWN0RXJyb3JSZXNwb25zZShcbiAgcmVzcG9uc2U6IE5leHRSZXNwb25zZSxcbiAgZXhwZWN0ZWRTdGF0dXMgPSA0MDAsXG4gIGVycm9yTWVzc2FnZT86IHN0cmluZ1xuKTogdm9pZCB7XG4gIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoZXhwZWN0ZWRTdGF0dXMpXG4gIGV4cGVjdChyZXNwb25zZS5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykpLnRvQ29udGFpbignYXBwbGljYXRpb24vanNvbicpXG5cbiAgaWYgKGVycm9yTWVzc2FnZSkge1xuICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKChkYXRhKSA9PiB7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9Db250YWluKGVycm9yTWVzc2FnZSlcbiAgICB9KVxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBdXRoZW50aWNhdGlvbiBIZWxwZXJzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIENyZWF0ZXMgYSBtb2NrIEpXVCB0b2tlbiBmb3IgdGVzdGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTW9ja0p3dFRva2VuKHVzZXJJZDogc3RyaW5nLCBvcmdhbml6YXRpb25JZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICBzdWI6IHVzZXJJZCxcbiAgICBvcmdfaWQ6IG9yZ2FuaXphdGlvbklkLFxuICAgIHJvbGU6ICdhZ2VudCcsXG4gICAgaWF0OiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSxcbiAgICBleHA6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgMzYwMCxcbiAgfVxuXG4gIC8vIEluIHJlYWwgaW1wbGVtZW50YXRpb24sIHRoaXMgd291bGQgYmUgc2lnbmVkIHdpdGggYSBzZWNyZXRcbiAgY29uc3QgYmFzZTY0UGF5bG9hZCA9IEJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKS50b1N0cmluZygnYmFzZTY0JylcbiAgcmV0dXJuIGBtb2NrLiR7YmFzZTY0UGF5bG9hZH0uc2lnbmF0dXJlYFxufVxuXG4vKipcbiAqIE1vY2tzIGF1dGhlbnRpY2F0aW9uIG1pZGRsZXdhcmUgc3VjY2Vzc1xuICovXG5leHBvcnQgZnVuY3Rpb24gbW9ja0F1dGhNaWRkbGV3YXJlU3VjY2Vzcyh1c2VyOiBQcm9maWxlKTogdm9pZCB7XG4gIGplc3QubW9jaygnQC9saWIvYXBpLW1pZGRsZXdhcmUnLCAoKSA9PiAoe1xuICAgIHdpdGhBdXRoOiAoaGFuZGxlcjogYW55KSA9PiBoYW5kbGVyLFxuICAgIGdldEN1cnJlbnRVc2VyOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUodXNlciksXG4gICAgcmVxdWlyZVJvbGU6IChyb2xlOiBzdHJpbmcpID0+IChoYW5kbGVyOiBhbnkpID0+IGhhbmRsZXIsXG4gIH0pKVxufVxuXG4vKipcbiAqIE1vY2tzIGF1dGhlbnRpY2F0aW9uIG1pZGRsZXdhcmUgZmFpbHVyZVxuICovXG5leHBvcnQgZnVuY3Rpb24gbW9ja0F1dGhNaWRkbGV3YXJlRmFpbHVyZShlcnJvcjogc3RyaW5nID0gJ1VuYXV0aG9yaXplZCcpOiB2b2lkIHtcbiAgamVzdC5tb2NrKCdAL2xpYi9hcGktbWlkZGxld2FyZScsICgpID0+ICh7XG4gICAgd2l0aEF1dGg6ICgpID0+IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcilcbiAgICB9LFxuICAgIGdldEN1cnJlbnRVc2VyOiBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKGVycm9yKSksXG4gIH0pKVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUmVxdWVzdCBCb2R5IFZhbGlkYXRpb25cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogVmFsaWRhdGVzIHJlcXVlc3QgYm9keSBhZ2FpbnN0IHNjaGVtYVxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVSZXF1ZXN0Qm9keShib2R5OiBhbnksIHJlcXVpcmVkRmllbGRzOiBzdHJpbmdbXSk6IHtcbiAgdmFsaWQ6IGJvb2xlYW5cbiAgbWlzc2luZ0ZpZWxkczogc3RyaW5nW11cbn0ge1xuICBjb25zdCBtaXNzaW5nRmllbGRzID0gcmVxdWlyZWRGaWVsZHMuZmlsdGVyKChmaWVsZCkgPT4gIShmaWVsZCBpbiBib2R5KSlcbiAgcmV0dXJuIHtcbiAgICB2YWxpZDogbWlzc2luZ0ZpZWxkcy5sZW5ndGggPT09IDAsXG4gICAgbWlzc2luZ0ZpZWxkcyxcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgaW52YWxpZCByZXF1ZXN0IGJvZGllcyBmb3IgdGVzdGluZyB2YWxpZGF0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbnZhbGlkUmVxdWVzdEJvZGllcyhcbiAgdmFsaWRCb2R5OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W10ge1xuICBjb25zdCBpbnZhbGlkQm9kaWVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W10gPSBbXVxuXG4gIC8vIE1pc3NpbmcgZWFjaCByZXF1aXJlZCBmaWVsZFxuICBPYmplY3Qua2V5cyh2YWxpZEJvZHkpLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGNvbnN0IGJvZHkgPSB7IC4uLnZhbGlkQm9keSB9XG4gICAgZGVsZXRlIGJvZHlba2V5XVxuICAgIGludmFsaWRCb2RpZXMucHVzaChib2R5KVxuICB9KVxuXG4gIC8vIEVtcHR5IHN0cmluZ3MgZm9yIHN0cmluZyBmaWVsZHNcbiAgT2JqZWN0LmVudHJpZXModmFsaWRCb2R5KS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgaW52YWxpZEJvZGllcy5wdXNoKHsgLi4udmFsaWRCb2R5LCBba2V5XTogJycgfSlcbiAgICB9XG4gIH0pXG5cbiAgLy8gSW52YWxpZCB0eXBlc1xuICBPYmplY3QuZW50cmllcyh2YWxpZEJvZHkpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBpbnZhbGlkQm9kaWVzLnB1c2goeyAuLi52YWxpZEJvZHksIFtrZXldOiAxMjMgfSlcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGludmFsaWRCb2RpZXMucHVzaCh7IC4uLnZhbGlkQm9keSwgW2tleV06ICdpbnZhbGlkJyB9KVxuICAgIH1cbiAgfSlcblxuICByZXR1cm4gaW52YWxpZEJvZGllc1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRGF0YWJhc2UgUXVlcnkgTW9ja2luZ1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBNb2NrcyBhIHN1Y2Nlc3NmdWwgZGF0YWJhc2UgcXVlcnlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1vY2tEYXRhYmFzZVF1ZXJ5PFQ+KGRhdGE6IFQgfCBUW10pOiB7XG4gIGRhdGE6IFQgfCBUW11cbiAgZXJyb3I6IG51bGxcbn0ge1xuICByZXR1cm4geyBkYXRhLCBlcnJvcjogbnVsbCB9XG59XG5cbi8qKlxuICogTW9ja3MgYSBmYWlsZWQgZGF0YWJhc2UgcXVlcnlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1vY2tEYXRhYmFzZUVycm9yKG1lc3NhZ2U6IHN0cmluZyk6IHtcbiAgZGF0YTogbnVsbFxuICBlcnJvcjogeyBtZXNzYWdlOiBzdHJpbmc7IGNvZGU6IHN0cmluZyB9XG59IHtcbiAgcmV0dXJuIHtcbiAgICBkYXRhOiBudWxsLFxuICAgIGVycm9yOiB7XG4gICAgICBtZXNzYWdlLFxuICAgICAgY29kZTogJ1BHUlNUMTE2JyxcbiAgICB9LFxuICB9XG59XG5cbi8qKlxuICogTW9ja3MgdGVuYW50IGlzb2xhdGlvbiBjaGVja1xuICovXG5leHBvcnQgZnVuY3Rpb24gbW9ja1RlbmFudElzb2xhdGlvbihvcmdhbml6YXRpb25JZDogc3RyaW5nKTogamVzdC5Nb2NrIHtcbiAgcmV0dXJuIGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKHF1ZXJ5KSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnF1ZXJ5LFxuICAgICAgZXE6IGplc3QuZm4oKGZpZWxkOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKGZpZWxkID09PSAnb3JnYW5pemF0aW9uX2lkJykge1xuICAgICAgICAgIGV4cGVjdCh2YWx1ZSkudG9CZShvcmdhbml6YXRpb25JZClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcXVlcnlcbiAgICAgIH0pLFxuICAgIH1cbiAgfSlcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJhdGUgTGltaXRpbmcgSGVscGVyc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBTaW11bGF0ZXMgcmF0ZSBsaW1pdCByZWFjaGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaW11bGF0ZVJhdGVMaW1pdChcbiAgbWF4UmVxdWVzdHM6IG51bWJlciA9IDEwMFxuKTogeyBzaG91bGRCbG9jazogYm9vbGVhbjsgcmVtYWluaW5nOiBudW1iZXIgfSB7XG4gIHJldHVybiB7XG4gICAgc2hvdWxkQmxvY2s6IHRydWUsXG4gICAgcmVtYWluaW5nOiAwLFxuICB9XG59XG5cbi8qKlxuICogU2ltdWxhdGVzIHJhdGUgbGltaXQgbm90IHJlYWNoZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNpbXVsYXRlUmF0ZUxpbWl0T2soXG4gIHJlbWFpbmluZzogbnVtYmVyID0gOTVcbik6IHsgc2hvdWxkQmxvY2s6IGJvb2xlYW47IHJlbWFpbmluZzogbnVtYmVyIH0ge1xuICByZXR1cm4ge1xuICAgIHNob3VsZEJsb2NrOiBmYWxzZSxcbiAgICByZW1haW5pbmcsXG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFQSSBFcnJvciBIZWxwZXJzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgQXBpRXJyb3JzID0ge1xuICBVbmF1dGhvcml6ZWQ6IHtcbiAgICBzdGF0dXM6IDQwMSxcbiAgICBtZXNzYWdlOiAnVW5hdXRob3JpemVkIC0gUGxlYXNlIHNpZ24gaW4nLFxuICB9LFxuICBGb3JiaWRkZW46IHtcbiAgICBzdGF0dXM6IDQwMyxcbiAgICBtZXNzYWdlOiAnRm9yYmlkZGVuIC0gSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zJyxcbiAgfSxcbiAgTm90Rm91bmQ6IHtcbiAgICBzdGF0dXM6IDQwNCxcbiAgICBtZXNzYWdlOiAnUmVzb3VyY2Ugbm90IGZvdW5kJyxcbiAgfSxcbiAgQmFkUmVxdWVzdDoge1xuICAgIHN0YXR1czogNDAwLFxuICAgIG1lc3NhZ2U6ICdCYWQgcmVxdWVzdCAtIEludmFsaWQgaW5wdXQnLFxuICB9LFxuICBDb25mbGljdDoge1xuICAgIHN0YXR1czogNDA5LFxuICAgIG1lc3NhZ2U6ICdDb25mbGljdCAtIFJlc291cmNlIGFscmVhZHkgZXhpc3RzJyxcbiAgfSxcbiAgSW50ZXJuYWxTZXJ2ZXJFcnJvcjoge1xuICAgIHN0YXR1czogNTAwLFxuICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxuICB9LFxuICBUb29NYW55UmVxdWVzdHM6IHtcbiAgICBzdGF0dXM6IDQyOSxcbiAgICBtZXNzYWdlOiAnVG9vIG1hbnkgcmVxdWVzdHMgLSBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyJyxcbiAgfSxcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIEFQSSBlcnJvciByZXNwb25zZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQXBpRXJyb3IoXG4gIGVycm9yVHlwZToga2V5b2YgdHlwZW9mIEFwaUVycm9ycyxcbiAgY3VzdG9tTWVzc2FnZT86IHN0cmluZ1xuKTogTmV4dFJlc3BvbnNlIHtcbiAgY29uc3QgZXJyb3IgPSBBcGlFcnJvcnNbZXJyb3JUeXBlXVxuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgeyBlcnJvcjogY3VzdG9tTWVzc2FnZSB8fCBlcnJvci5tZXNzYWdlIH0sXG4gICAgeyBzdGF0dXM6IGVycm9yLnN0YXR1cyB9XG4gIClcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBhZ2luYXRpb24gSGVscGVyc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBDcmVhdGVzIHBhZ2luYXRpb24gcGFyYW1ldGVyc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUGFnaW5hdGlvblBhcmFtcyhwYWdlID0gMSwgbGltaXQgPSAyMCk6IHtcbiAgcGFnZTogbnVtYmVyXG4gIGxpbWl0OiBudW1iZXJcbiAgb2Zmc2V0OiBudW1iZXJcbn0ge1xuICByZXR1cm4ge1xuICAgIHBhZ2UsXG4gICAgbGltaXQsXG4gICAgb2Zmc2V0OiAocGFnZSAtIDEpICogbGltaXQsXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgcGFnaW5hdGVkIHJlc3BvbnNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYWdpbmF0ZWRSZXNwb25zZTxUPihcbiAgZGF0YTogVFtdLFxuICBwYWdlOiBudW1iZXIsXG4gIGxpbWl0OiBudW1iZXIsXG4gIHRvdGFsOiBudW1iZXJcbik6IHtcbiAgZGF0YTogVFtdXG4gIHBhZ2luYXRpb246IHtcbiAgICBwYWdlOiBudW1iZXJcbiAgICBsaW1pdDogbnVtYmVyXG4gICAgdG90YWw6IG51bWJlclxuICAgIHRvdGFsX3BhZ2VzOiBudW1iZXJcbiAgICBoYXNfbmV4dDogYm9vbGVhblxuICAgIGhhc19wcmV2OiBib29sZWFuXG4gIH1cbn0ge1xuICByZXR1cm4ge1xuICAgIGRhdGEsXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgcGFnZSxcbiAgICAgIGxpbWl0LFxuICAgICAgdG90YWwsXG4gICAgICB0b3RhbF9wYWdlczogTWF0aC5jZWlsKHRvdGFsIC8gbGltaXQpLFxuICAgICAgaGFzX25leHQ6IHBhZ2UgKiBsaW1pdCA8IHRvdGFsLFxuICAgICAgaGFzX3ByZXY6IHBhZ2UgPiAxLFxuICAgIH0sXG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRlc3QgU2NlbmFyaW9zXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIENvbW1vbiB0ZXN0IHNjZW5hcmlvcyBmb3IgQVBJIHJvdXRlc1xuICovXG5leHBvcnQgY29uc3QgQXBpVGVzdFNjZW5hcmlvcyA9IHtcbiAgLyoqXG4gICAqIFRlc3QgYXV0aGVudGljYXRpb24gcmVxdWlyZW1lbnRcbiAgICovXG4gIHJlcXVpcmVzQXV0aDogYXN5bmMgKGhhbmRsZXI6IChyZXE6IE5leHRSZXF1ZXN0KSA9PiBQcm9taXNlPE5leHRSZXNwb25zZT4pID0+IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gY3JlYXRlVW5hdXRoZW50aWNhdGVkUmVxdWVzdCgpXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVyKHJlcXVlc3QpXG4gICAgZXhwZWN0RXJyb3JSZXNwb25zZShyZXNwb25zZSwgNDAxKVxuICB9LFxuXG4gIC8qKlxuICAgKiBUZXN0IHRlbmFudCBpc29sYXRpb25cbiAgICovXG4gIGVuZm9yY2VzVGVuYW50SXNvbGF0aW9uOiBhc3luYyAoXG4gICAgaGFuZGxlcjogKHJlcTogTmV4dFJlcXVlc3QpID0+IFByb21pc2U8TmV4dFJlc3BvbnNlPixcbiAgICBvcmdhbml6YXRpb25JZDogc3RyaW5nXG4gICkgPT4ge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBjcmVhdGVBdXRoZW50aWNhdGVkUmVxdWVzdCh7IG9yZ2FuaXphdGlvbklkIH0pXG4gICAgLy8gSGFuZGxlciBzaG91bGQgb25seSBhY2Nlc3MgZGF0YSBmcm9tIHRoaXMgb3JnYW5pemF0aW9uXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVyKHJlcXVlc3QpXG4gICAgZXhwZWN0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlKVxuICB9LFxuXG4gIC8qKlxuICAgKiBUZXN0IGlucHV0IHZhbGlkYXRpb25cbiAgICovXG4gIHZhbGlkYXRlc0lucHV0OiBhc3luYyAoXG4gICAgaGFuZGxlcjogKHJlcTogTmV4dFJlcXVlc3QpID0+IFByb21pc2U8TmV4dFJlc3BvbnNlPixcbiAgICB2YWxpZEJvZHk6IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gICAgcmVxdWlyZWRGaWVsZHM6IHN0cmluZ1tdXG4gICkgPT4ge1xuICAgIGNvbnN0IGludmFsaWRCb2RpZXMgPSBjcmVhdGVJbnZhbGlkUmVxdWVzdEJvZGllcyh2YWxpZEJvZHkpXG5cbiAgICBmb3IgKGNvbnN0IGJvZHkgb2YgaW52YWxpZEJvZGllcykge1xuICAgICAgY29uc3QgcmVxdWVzdCA9IGNyZWF0ZUF1dGhlbnRpY2F0ZWRSZXF1ZXN0KHsgYm9keSwgbWV0aG9kOiAnUE9TVCcgfSlcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaGFuZGxlcihyZXF1ZXN0KVxuICAgICAgZXhwZWN0RXJyb3JSZXNwb25zZShyZXNwb25zZSwgNDAwKVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogVGVzdCByYXRlIGxpbWl0aW5nXG4gICAqL1xuICBlbmZvcmNlc1JhdGVMaW1pdDogYXN5bmMgKFxuICAgIGhhbmRsZXI6IChyZXE6IE5leHRSZXF1ZXN0KSA9PiBQcm9taXNlPE5leHRSZXNwb25zZT4sXG4gICAgbWF4UmVxdWVzdHMgPSAxMDBcbiAgKSA9PiB7XG4gICAgLy8gU2ltdWxhdGUgbWF4IHJlcXVlc3RzXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhSZXF1ZXN0cyArIDE7IGkrKykge1xuICAgICAgY29uc3QgcmVxdWVzdCA9IGNyZWF0ZUF1dGhlbnRpY2F0ZWRSZXF1ZXN0KClcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaGFuZGxlcihyZXF1ZXN0KVxuXG4gICAgICBpZiAoaSA8IG1heFJlcXVlc3RzKSB7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLm5vdC50b0JlKDQyOSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGV4cGVjdEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDQyOSlcbiAgICAgIH1cbiAgICB9XG4gIH0sXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBFeHBvcnQgQWxsIEhlbHBlcnNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQWxpYXMgZm9yIG1vY2tBcGlSZXF1ZXN0IGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVNb2NrUmVxdWVzdCA9IG1vY2tBcGlSZXF1ZXN0XG5cbi8qKlxuICogQ3JlYXRlcyBhIHBhZ2luYXRlZCBVUkwgd2l0aCBxdWVyeSBwYXJhbWV0ZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYWdpbmF0ZWRVcmwoXG4gIGJhc2VVcmw6IHN0cmluZyxcbiAgcGFyYW1zOiB7IHBhZ2U/OiBudW1iZXI7IGxpbWl0PzogbnVtYmVyOyBzb3J0Pzogc3RyaW5nOyBvcmRlcj86IHN0cmluZyB9XG4pOiBzdHJpbmcge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKGJhc2VVcmwsICdodHRwOi8vbG9jYWxob3N0OjMwMDAnKVxuICBpZiAocGFyYW1zLnBhZ2UpIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdwYWdlJywgcGFyYW1zLnBhZ2UudG9TdHJpbmcoKSlcbiAgaWYgKHBhcmFtcy5saW1pdCkgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2xpbWl0JywgcGFyYW1zLmxpbWl0LnRvU3RyaW5nKCkpXG4gIGlmIChwYXJhbXMuc29ydCkgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3NvcnQnLCBwYXJhbXMuc29ydClcbiAgaWYgKHBhcmFtcy5vcmRlcikgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ29yZGVyJywgcGFyYW1zLm9yZGVyKVxuICByZXR1cm4gdXJsLnRvU3RyaW5nKClcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgcGFnaW5hdGVkIHJlc3BvbnNlIHN0cnVjdHVyZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwZWN0UGFnaW5hdGVkUmVzcG9uc2UoZGF0YTogYW55KTogdm9pZCB7XG4gIGV4cGVjdChkYXRhKS50b0hhdmVQcm9wZXJ0eSgncGFnaW5hdGlvbicpXG4gIGV4cGVjdChkYXRhLnBhZ2luYXRpb24pLnRvSGF2ZVByb3BlcnR5KCdwYWdlJylcbiAgZXhwZWN0KGRhdGEucGFnaW5hdGlvbikudG9IYXZlUHJvcGVydHkoJ2xpbWl0JylcbiAgZXhwZWN0KGRhdGEucGFnaW5hdGlvbikudG9IYXZlUHJvcGVydHkoJ3RvdGFsJylcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBtb2NrQXBpUmVxdWVzdCxcbiAgY3JlYXRlTW9ja1JlcXVlc3QsXG4gIGNyZWF0ZUF1dGhlbnRpY2F0ZWRSZXF1ZXN0LFxuICBjcmVhdGVVbmF1dGhlbnRpY2F0ZWRSZXF1ZXN0LFxuICBtb2NrQXBpUmVzcG9uc2UsXG4gIG1vY2tFcnJvclJlc3BvbnNlLFxuICBleHRyYWN0UmVzcG9uc2VEYXRhLFxuICBwYXJzZVJlc3BvbnNlLFxuICBleHBlY3RTdWNjZXNzUmVzcG9uc2UsXG4gIGV4cGVjdEVycm9yUmVzcG9uc2UsXG4gIGNyZWF0ZU1vY2tKd3RUb2tlbixcbiAgbW9ja0F1dGhNaWRkbGV3YXJlU3VjY2VzcyxcbiAgbW9ja0F1dGhNaWRkbGV3YXJlRmFpbHVyZSxcbiAgdmFsaWRhdGVSZXF1ZXN0Qm9keSxcbiAgY3JlYXRlSW52YWxpZFJlcXVlc3RCb2RpZXMsXG4gIG1vY2tEYXRhYmFzZVF1ZXJ5LFxuICBtb2NrRGF0YWJhc2VFcnJvcixcbiAgbW9ja1RlbmFudElzb2xhdGlvbixcbiAgc2ltdWxhdGVSYXRlTGltaXQsXG4gIHNpbXVsYXRlUmF0ZUxpbWl0T2ssXG4gIEFwaUVycm9ycyxcbiAgY3JlYXRlQXBpRXJyb3IsXG4gIGNyZWF0ZVBhZ2luYXRpb25QYXJhbXMsXG4gIGNyZWF0ZVBhZ2luYXRlZFJlc3BvbnNlLFxuICBBcGlUZXN0U2NlbmFyaW9zLFxufVxuIl0sIm5hbWVzIjpbIkFwaUVycm9ycyIsIkFwaVRlc3RTY2VuYXJpb3MiLCJjcmVhdGVBcGlFcnJvciIsImNyZWF0ZUF1dGhlbnRpY2F0ZWRSZXF1ZXN0IiwiY3JlYXRlSW52YWxpZFJlcXVlc3RCb2RpZXMiLCJjcmVhdGVNb2NrSnd0VG9rZW4iLCJjcmVhdGVNb2NrUmVxdWVzdCIsImNyZWF0ZVBhZ2luYXRlZFJlc3BvbnNlIiwiY3JlYXRlUGFnaW5hdGVkVXJsIiwiY3JlYXRlUGFnaW5hdGlvblBhcmFtcyIsImNyZWF0ZVVuYXV0aGVudGljYXRlZFJlcXVlc3QiLCJleHBlY3RFcnJvclJlc3BvbnNlIiwiZXhwZWN0UGFnaW5hdGVkUmVzcG9uc2UiLCJleHBlY3RTdWNjZXNzUmVzcG9uc2UiLCJleHRyYWN0UmVzcG9uc2VEYXRhIiwibW9ja0FwaVJlcXVlc3QiLCJtb2NrQXBpUmVzcG9uc2UiLCJtb2NrQXV0aE1pZGRsZXdhcmVGYWlsdXJlIiwibW9ja0F1dGhNaWRkbGV3YXJlU3VjY2VzcyIsIm1vY2tEYXRhYmFzZUVycm9yIiwibW9ja0RhdGFiYXNlUXVlcnkiLCJtb2NrRXJyb3JSZXNwb25zZSIsIm1vY2tUZW5hbnRJc29sYXRpb24iLCJwYXJzZVJlc3BvbnNlIiwic2ltdWxhdGVSYXRlTGltaXQiLCJzaW11bGF0ZVJhdGVMaW1pdE9rIiwidmFsaWRhdGVSZXF1ZXN0Qm9keSIsIm9wdGlvbnMiLCJtZXRob2QiLCJ1cmwiLCJib2R5IiwiaGVhZGVycyIsInNlYXJjaFBhcmFtcyIsImNvb2tpZXMiLCJ1cmxPYmoiLCJVUkwiLCJPYmplY3QiLCJlbnRyaWVzIiwiZm9yRWFjaCIsImtleSIsInZhbHVlIiwic2V0IiwiaW5pdCIsIkhlYWRlcnMiLCJKU09OIiwic3RyaW5naWZ5IiwicmVxdWVzdCIsIk5leHRSZXF1ZXN0IiwidG9TdHJpbmciLCJ1c2VyIiwiY3JlYXRlTW9ja1VzZXIiLCJvcmdhbml6YXRpb25JZCIsIm9yZ2FuaXphdGlvbl9pZCIsImlkIiwiQXV0aG9yaXphdGlvbiIsImRhdGEiLCJzdGF0dXMiLCJOZXh0UmVzcG9uc2UiLCJqc29uIiwibWVzc2FnZSIsImVycm9yIiwicmVzcG9uc2UiLCJ0ZXh0IiwicGFyc2UiLCJleHBlY3RlZFN0YXR1cyIsImV4cGVjdCIsInRvQmUiLCJnZXQiLCJ0b0NvbnRhaW4iLCJlcnJvck1lc3NhZ2UiLCJ0aGVuIiwidXNlcklkIiwicGF5bG9hZCIsInN1YiIsIm9yZ19pZCIsInJvbGUiLCJpYXQiLCJNYXRoIiwiZmxvb3IiLCJEYXRlIiwibm93IiwiZXhwIiwiYmFzZTY0UGF5bG9hZCIsIkJ1ZmZlciIsImZyb20iLCJqZXN0IiwibW9jayIsIndpdGhBdXRoIiwiaGFuZGxlciIsImdldEN1cnJlbnRVc2VyIiwiZm4iLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInJlcXVpcmVSb2xlIiwiRXJyb3IiLCJtb2NrUmVqZWN0ZWRWYWx1ZSIsInJlcXVpcmVkRmllbGRzIiwibWlzc2luZ0ZpZWxkcyIsImZpbHRlciIsImZpZWxkIiwidmFsaWQiLCJsZW5ndGgiLCJ2YWxpZEJvZHkiLCJpbnZhbGlkQm9kaWVzIiwia2V5cyIsInB1c2giLCJjb2RlIiwibW9ja0ltcGxlbWVudGF0aW9uIiwicXVlcnkiLCJlcSIsIm1heFJlcXVlc3RzIiwic2hvdWxkQmxvY2siLCJyZW1haW5pbmciLCJVbmF1dGhvcml6ZWQiLCJGb3JiaWRkZW4iLCJOb3RGb3VuZCIsIkJhZFJlcXVlc3QiLCJDb25mbGljdCIsIkludGVybmFsU2VydmVyRXJyb3IiLCJUb29NYW55UmVxdWVzdHMiLCJlcnJvclR5cGUiLCJjdXN0b21NZXNzYWdlIiwicGFnZSIsImxpbWl0Iiwib2Zmc2V0IiwidG90YWwiLCJwYWdpbmF0aW9uIiwidG90YWxfcGFnZXMiLCJjZWlsIiwiaGFzX25leHQiLCJoYXNfcHJldiIsInJlcXVpcmVzQXV0aCIsImVuZm9yY2VzVGVuYW50SXNvbGF0aW9uIiwidmFsaWRhdGVzSW5wdXQiLCJlbmZvcmNlc1JhdGVMaW1pdCIsImkiLCJub3QiLCJiYXNlVXJsIiwicGFy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