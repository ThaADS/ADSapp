{"version":3,"names":["getUser","cov_1nif3ylbc9","f","s","getUserProfile","requireAuth","requireOrganization","requireSuperAdminOrOrganization","signOut","supabase","_server","createClient","data","user","auth","b","profile","from","select","eq","id","single","_navigation","redirect","organization_id","is_super_admin"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\lib\\auth.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/server'\nimport { redirect } from 'next/navigation'\n\nexport async function getUser() {\n  const supabase = await createClient()\n  const {\n    data: { user },\n  } = await supabase.auth.getUser()\n\n  return user\n}\n\nexport async function getUserProfile() {\n  const supabase = await createClient()\n  const user = await getUser()\n\n  if (!user) {\n    return null\n  }\n\n  const { data: profile } = await supabase\n    .from('profiles')\n    .select('*, organization:organizations(*)')\n    .eq('id', user.id)\n    .single()\n\n  return profile\n}\n\nexport async function requireAuth() {\n  const user = await getUser()\n\n  if (!user) {\n    redirect('/auth/signin')\n  }\n\n  return user\n}\n\nexport async function requireOrganization() {\n  const profile = await getUserProfile()\n\n  if (!profile?.organization_id) {\n    // Check if user is super admin - they don't need an organization\n    if (profile?.is_super_admin) {\n      // Super admins should go to admin dashboard instead\n      redirect('/admin')\n    } else {\n      redirect('/onboarding')\n    }\n  }\n\n  return profile\n}\n\nexport async function requireSuperAdminOrOrganization() {\n  const profile = await getUserProfile()\n\n  // If user is super admin, they can access without organization\n  if (profile?.is_super_admin) {\n    return profile\n  }\n\n  // Otherwise, require organization\n  if (!profile?.organization_id) {\n    redirect('/onboarding')\n  }\n\n  return profile\n}\n\nexport async function signOut() {\n  const supabase = await createClient()\n  await supabase.auth.signOut()\n  redirect('/auth/signin')\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAGsBA,QAAA;IAAA;IAAAC,cAAA,GAAAC,CAAA;IAAAD,cAAA,GAAAE,CAAA;WAAAH,OAAA;;MASAI,eAAA;IAAA;IAAAH,cAAA,GAAAC,CAAA;IAAAD,cAAA,GAAAE,CAAA;WAAAC,cAAA;;MAiBAC,YAAA;IAAA;IAAAJ,cAAA,GAAAC,CAAA;IAAAD,cAAA,GAAAE,CAAA;WAAAE,WAAA;;MAUAC,oBAAA;IAAA;IAAAL,cAAA,GAAAC,CAAA;IAAAD,cAAA,GAAAE,CAAA;WAAAG,mBAAA;;MAgBAC,gCAAA;IAAA;IAAAN,cAAA,GAAAC,CAAA;IAAAD,cAAA,GAAAE,CAAA;WAAAI,+BAAA;;MAgBAC,QAAA;IAAA;IAAAP,cAAA,GAAAC,CAAA;IAAAD,cAAA,GAAAE,CAAA;WAAAK,OAAA;;;;;mCAvEO;;;mCACJ;AAElB,eAAeR,QAAA;EAAA;EAAAC,cAAA,GAAAC,CAAA;EACpB,MAAMO,QAAA;EAAA;EAAA,CAAAR,cAAA,GAAAE,CAAA,QAAW,MAAM,IAAAO,OAAA,CAAAC,YAAY;EACnC,MAAM;IACJC,IAAA,EAAM;MAAEC;IAAI;EAAE,CACf;EAAA;EAAA,CAAAZ,cAAA,GAAAE,CAAA,QAAG,MAAMM,QAAA,CAASK,IAAI,CAACd,OAAO;EAAA;EAAAC,cAAA,GAAAE,CAAA;EAE/B,OAAOU,IAAA;AACT;AAEO,eAAeT,eAAA;EAAA;EAAAH,cAAA,GAAAC,CAAA;EACpB,MAAMO,QAAA;EAAA;EAAA,CAAAR,cAAA,GAAAE,CAAA,QAAW,MAAM,IAAAO,OAAA,CAAAC,YAAY;EACnC,MAAME,IAAA;EAAA;EAAA,CAAAZ,cAAA,GAAAE,CAAA,QAAO,MAAMH,OAAA;EAAA;EAAAC,cAAA,GAAAE,CAAA;EAEnB,IAAI,CAACU,IAAA,EAAM;IAAA;IAAAZ,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAE,CAAA;IACT,OAAO;EACT;EAAA;EAAA;IAAAF,cAAA,GAAAc,CAAA;EAAA;EAEA,MAAM;IAAEH,IAAA,EAAMI;EAAO,CAAE;EAAA;EAAA,CAAAf,cAAA,GAAAE,CAAA,QAAG,MAAMM,QAAA,CAC7BQ,IAAI,CAAC,YACLC,MAAM,CAAC,oCACPC,EAAE,CAAC,MAAMN,IAAA,CAAKO,EAAE,EAChBC,MAAM;EAAA;EAAApB,cAAA,GAAAE,CAAA;EAET,OAAOa,OAAA;AACT;AAEO,eAAeX,YAAA;EAAA;EAAAJ,cAAA,GAAAC,CAAA;EACpB,MAAMW,IAAA;EAAA;EAAA,CAAAZ,cAAA,GAAAE,CAAA,QAAO,MAAMH,OAAA;EAAA;EAAAC,cAAA,GAAAE,CAAA;EAEnB,IAAI,CAACU,IAAA,EAAM;IAAA;IAAAZ,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAE,CAAA;IACT,IAAAmB,WAAA,CAAAC,QAAQ,EAAC;EACX;EAAA;EAAA;IAAAtB,cAAA,GAAAc,CAAA;EAAA;EAAAd,cAAA,GAAAE,CAAA;EAEA,OAAOU,IAAA;AACT;AAEO,eAAeP,oBAAA;EAAA;EAAAL,cAAA,GAAAC,CAAA;EACpB,MAAMc,OAAA;EAAA;EAAA,CAAAf,cAAA,GAAAE,CAAA,QAAU,MAAMC,cAAA;EAAA;EAAAH,cAAA,GAAAE,CAAA;EAEtB,IAAI,CAACa,OAAA,EAASQ,eAAA,EAAiB;IAAA;IAAAvB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAE,CAAA;IAC7B;IACA,IAAIa,OAAA,EAASS,cAAA,EAAgB;MAAA;MAAAxB,cAAA,GAAAc,CAAA;MAAAd,cAAA,GAAAE,CAAA;MAC3B;MACA,IAAAmB,WAAA,CAAAC,QAAQ,EAAC;IACX,OAAO;MAAA;MAAAtB,cAAA,GAAAc,CAAA;MAAAd,cAAA,GAAAE,CAAA;MACL,IAAAmB,WAAA,CAAAC,QAAQ,EAAC;IACX;EACF;EAAA;EAAA;IAAAtB,cAAA,GAAAc,CAAA;EAAA;EAAAd,cAAA,GAAAE,CAAA;EAEA,OAAOa,OAAA;AACT;AAEO,eAAeT,gCAAA;EAAA;EAAAN,cAAA,GAAAC,CAAA;EACpB,MAAMc,OAAA;EAAA;EAAA,CAAAf,cAAA,GAAAE,CAAA,QAAU,MAAMC,cAAA;EAEtB;EAAA;EAAAH,cAAA,GAAAE,CAAA;EACA,IAAIa,OAAA,EAASS,cAAA,EAAgB;IAAA;IAAAxB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAE,CAAA;IAC3B,OAAOa,OAAA;EACT;EAAA;EAAA;IAAAf,cAAA,GAAAc,CAAA;EAAA;EAEA;EAAAd,cAAA,GAAAE,CAAA;EACA,IAAI,CAACa,OAAA,EAASQ,eAAA,EAAiB;IAAA;IAAAvB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAE,CAAA;IAC7B,IAAAmB,WAAA,CAAAC,QAAQ,EAAC;EACX;EAAA;EAAA;IAAAtB,cAAA,GAAAc,CAAA;EAAA;EAAAd,cAAA,GAAAE,CAAA;EAEA,OAAOa,OAAA;AACT;AAEO,eAAeR,QAAA;EAAA;EAAAP,cAAA,GAAAC,CAAA;EACpB,MAAMO,QAAA;EAAA;EAAA,CAAAR,cAAA,GAAAE,CAAA,QAAW,MAAM,IAAAO,OAAA,CAAAC,YAAY;EAAA;EAAAV,cAAA,GAAAE,CAAA;EACnC,MAAMM,QAAA,CAASK,IAAI,CAACN,OAAO;EAAA;EAAAP,cAAA,GAAAE,CAAA;EAC3B,IAAAmB,WAAA,CAAAC,QAAQ,EAAC;AACX","ignoreList":[]}