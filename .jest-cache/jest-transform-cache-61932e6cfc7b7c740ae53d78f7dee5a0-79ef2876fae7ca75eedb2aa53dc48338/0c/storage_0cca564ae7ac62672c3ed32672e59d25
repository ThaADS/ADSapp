12b209d17f2eb07c2273e4e96b34f4f0
"use strict";

/* istanbul ignore next */
function cov_21dhq4bt12() {
  var path = "C:\\Ai Projecten\\ADSapp\\src\\lib\\media\\storage.ts";
  var hash = "66c2bcb3cfacad8c2cc00b42af520f8d59548033";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Ai Projecten\\ADSapp\\src\\lib\\media\\storage.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 35
        }
      },
      "3": {
        start: {
          line: 11,
          column: 16
        },
        end: {
          line: 11,
          column: 45
        }
      },
      "4": {
        start: {
          line: 12,
          column: 14
        },
        end: {
          line: 12,
          column: 29
        }
      },
      "5": {
        start: {
          line: 13,
          column: 29
        },
        end: {
          line: 13,
          column: 71
        }
      },
      "6": {
        start: {
          line: 15,
          column: 4
        },
        end: {
          line: 17,
          column: 6
        }
      },
      "7": {
        start: {
          line: 21,
          column: 8
        },
        end: {
          line: 21,
          column: 52
        }
      },
      "8": {
        start: {
          line: 22,
          column: 8
        },
        end: {
          line: 22,
          column: 34
        }
      },
      "9": {
        start: {
          line: 23,
          column: 8
        },
        end: {
          line: 23,
          column: 52
        }
      },
      "10": {
        start: {
          line: 27,
          column: 8
        },
        end: {
          line: 29,
          column: 9
        }
      },
      "11": {
        start: {
          line: 28,
          column: 12
        },
        end: {
          line: 28,
          column: 98
        }
      },
      "12": {
        start: {
          line: 31,
          column: 8
        },
        end: {
          line: 33,
          column: 9
        }
      },
      "13": {
        start: {
          line: 32,
          column: 12
        },
        end: {
          line: 32,
          column: 68
        }
      },
      "14": {
        start: {
          line: 34,
          column: 23
        },
        end: {
          line: 34,
          column: 38
        }
      },
      "15": {
        start: {
          line: 35,
          column: 30
        },
        end: {
          line: 35,
          column: 75
        }
      },
      "16": {
        start: {
          line: 36,
          column: 25
        },
        end: {
          line: 36,
          column: 78
        }
      },
      "17": {
        start: {
          line: 37,
          column: 8
        },
        end: {
          line: 90,
          column: 9
        }
      },
      "18": {
        start: {
          line: 39,
          column: 61
        },
        end: {
          line: 42,
          column: 14
        }
      },
      "19": {
        start: {
          line: 43,
          column: 12
        },
        end: {
          line: 45,
          column: 13
        }
      },
      "20": {
        start: {
          line: 44,
          column: 16
        },
        end: {
          line: 44,
          column: 81
        }
      },
      "21": {
        start: {
          line: 47,
          column: 38
        },
        end: {
          line: 47,
          column: 118
        }
      },
      "22": {
        start: {
          line: 49,
          column: 27
        },
        end: {
          line: 49,
          column: 29
        }
      },
      "23": {
        start: {
          line: 51,
          column: 12
        },
        end: {
          line: 54,
          column: 13
        }
      },
      "24": {
        start: {
          line: 52,
          column: 16
        },
        end: {
          line: 52,
          column: 100
        }
      },
      "25": {
        start: {
          line: 53,
          column: 16
        },
        end: {
          line: 53,
          column: 61
        }
      },
      "26": {
        start: {
          line: 56,
          column: 30
        },
        end: {
          line: 66,
          column: 13
        }
      },
      "27": {
        start: {
          line: 67,
          column: 39
        },
        end: {
          line: 78,
          column: 14
        }
      },
      "28": {
        start: {
          line: 79,
          column: 12
        },
        end: {
          line: 85,
          column: 13
        }
      },
      "29": {
        start: {
          line: 81,
          column: 16
        },
        end: {
          line: 83,
          column: 19
        }
      },
      "30": {
        start: {
          line: 84,
          column: 16
        },
        end: {
          line: 84,
          column: 83
        }
      },
      "31": {
        start: {
          line: 86,
          column: 12
        },
        end: {
          line: 86,
          column: 29
        }
      },
      "32": {
        start: {
          line: 88,
          column: 12
        },
        end: {
          line: 88,
          column: 58
        }
      },
      "33": {
        start: {
          line: 89,
          column: 12
        },
        end: {
          line: 89,
          column: 24
        }
      },
      "34": {
        start: {
          line: 93,
          column: 32
        },
        end: {
          line: 93,
          column: 155
        }
      },
      "35": {
        start: {
          line: 94,
          column: 8
        },
        end: {
          line: 96,
          column: 9
        }
      },
      "36": {
        start: {
          line: 95,
          column: 12
        },
        end: {
          line: 95,
          column: 24
        }
      },
      "37": {
        start: {
          line: 97,
          column: 8
        },
        end: {
          line: 107,
          column: 10
        }
      },
      "38": {
        start: {
          line: 110,
          column: 21
        },
        end: {
          line: 110,
          column: 63
        }
      },
      "39": {
        start: {
          line: 111,
          column: 8
        },
        end: {
          line: 113,
          column: 9
        }
      },
      "40": {
        start: {
          line: 112,
          column: 12
        },
        end: {
          line: 112,
          column: 46
        }
      },
      "41": {
        start: {
          line: 114,
          column: 8
        },
        end: {
          line: 139,
          column: 9
        }
      },
      "42": {
        start: {
          line: 116,
          column: 32
        },
        end: {
          line: 116,
          column: 119
        }
      },
      "43": {
        start: {
          line: 118,
          column: 44
        },
        end: {
          line: 120,
          column: 14
        }
      },
      "44": {
        start: {
          line: 121,
          column: 12
        },
        end: {
          line: 123,
          column: 13
        }
      },
      "45": {
        start: {
          line: 122,
          column: 16
        },
        end: {
          line: 122,
          column: 81
        }
      },
      "46": {
        start: {
          line: 125,
          column: 12
        },
        end: {
          line: 130,
          column: 13
        }
      },
      "47": {
        start: {
          line: 126,
          column: 38
        },
        end: {
          line: 126,
          column: 82
        }
      },
      "48": {
        start: {
          line: 127,
          column: 16
        },
        end: {
          line: 129,
          column: 19
        }
      },
      "49": {
        start: {
          line: 132,
          column: 39
        },
        end: {
          line: 132,
          column: 150
        }
      },
      "50": {
        start: {
          line: 133,
          column: 12
        },
        end: {
          line: 135,
          column: 13
        }
      },
      "51": {
        start: {
          line: 134,
          column: 16
        },
        end: {
          line: 134,
          column: 84
        }
      },
      "52": {
        start: {
          line: 137,
          column: 12
        },
        end: {
          line: 137,
          column: 57
        }
      },
      "53": {
        start: {
          line: 138,
          column: 12
        },
        end: {
          line: 138,
          column: 24
        }
      },
      "54": {
        start: {
          line: 142,
          column: 20
        },
        end: {
          line: 144,
          column: 48
        }
      },
      "55": {
        start: {
          line: 145,
          column: 8
        },
        end: {
          line: 147,
          column: 9
        }
      },
      "56": {
        start: {
          line: 146,
          column: 12
        },
        end: {
          line: 146,
          column: 69
        }
      },
      "57": {
        start: {
          line: 148,
          column: 8
        },
        end: {
          line: 150,
          column: 9
        }
      },
      "58": {
        start: {
          line: 149,
          column: 12
        },
        end: {
          line: 149,
          column: 64
        }
      },
      "59": {
        start: {
          line: 151,
          column: 8
        },
        end: {
          line: 153,
          column: 9
        }
      },
      "60": {
        start: {
          line: 152,
          column: 12
        },
        end: {
          line: 152,
          column: 47
        }
      },
      "61": {
        start: {
          line: 154,
          column: 8
        },
        end: {
          line: 156,
          column: 9
        }
      },
      "62": {
        start: {
          line: 155,
          column: 12
        },
        end: {
          line: 155,
          column: 92
        }
      },
      "63": {
        start: {
          line: 157,
          column: 39
        },
        end: {
          line: 159,
          column: 10
        }
      },
      "64": {
        start: {
          line: 160,
          column: 8
        },
        end: {
          line: 162,
          column: 9
        }
      },
      "65": {
        start: {
          line: 161,
          column: 12
        },
        end: {
          line: 161,
          column: 70
        }
      },
      "66": {
        start: {
          line: 163,
          column: 22
        },
        end: {
          line: 173,
          column: 15
        }
      },
      "67": {
        start: {
          line: 163,
          column: 48
        },
        end: {
          line: 173,
          column: 13
        }
      },
      "68": {
        start: {
          line: 174,
          column: 8
        },
        end: {
          line: 177,
          column: 10
        }
      },
      "69": {
        start: {
          line: 180,
          column: 8
        },
        end: {
          line: 202,
          column: 9
        }
      },
      "70": {
        start: {
          line: 181,
          column: 36
        },
        end: {
          line: 186,
          column: 25
        }
      },
      "71": {
        start: {
          line: 187,
          column: 27
        },
        end: {
          line: 187,
          column: 71
        }
      },
      "72": {
        start: {
          line: 188,
          column: 34
        },
        end: {
          line: 188,
          column: 78
        }
      },
      "73": {
        start: {
          line: 189,
          column: 30
        },
        end: {
          line: 192,
          column: 14
        }
      },
      "74": {
        start: {
          line: 193,
          column: 12
        },
        end: {
          line: 196,
          column: 13
        }
      },
      "75": {
        start: {
          line: 194,
          column: 16
        },
        end: {
          line: 194,
          column: 67
        }
      },
      "76": {
        start: {
          line: 195,
          column: 16
        },
        end: {
          line: 195,
          column: 26
        }
      },
      "77": {
        start: {
          line: 197,
          column: 38
        },
        end: {
          line: 197,
          column: 123
        }
      },
      "78": {
        start: {
          line: 198,
          column: 12
        },
        end: {
          line: 198,
          column: 37
        }
      },
      "79": {
        start: {
          line: 200,
          column: 12
        },
        end: {
          line: 200,
          column: 64
        }
      },
      "80": {
        start: {
          line: 201,
          column: 12
        },
        end: {
          line: 201,
          column: 22
        }
      },
      "81": {
        start: {
          line: 205,
          column: 8
        },
        end: {
          line: 217,
          column: 9
        }
      },
      "82": {
        start: {
          line: 206,
          column: 29
        },
        end: {
          line: 206,
          column: 78
        }
      },
      "83": {
        start: {
          line: 207,
          column: 12
        },
        end: {
          line: 213,
          column: 14
        }
      },
      "84": {
        start: {
          line: 215,
          column: 12
        },
        end: {
          line: 215,
          column: 66
        }
      },
      "85": {
        start: {
          line: 216,
          column: 12
        },
        end: {
          line: 216,
          column: 22
        }
      },
      "86": {
        start: {
          line: 220,
          column: 8
        },
        end: {
          line: 220,
          column: 45
        }
      },
      "87": {
        start: {
          line: 224,
          column: 34
        },
        end: {
          line: 224,
          column: 74
        }
      },
      "88": {
        start: {
          line: 225,
          column: 8
        },
        end: {
          line: 227,
          column: 9
        }
      },
      "89": {
        start: {
          line: 226,
          column: 12
        },
        end: {
          line: 226,
          column: 43
        }
      },
      "90": {
        start: {
          line: 229,
          column: 35
        },
        end: {
          line: 242,
          column: 9
        }
      },
      "91": {
        start: {
          line: 243,
          column: 8
        },
        end: {
          line: 243,
          column: 50
        }
      },
      "92": {
        start: {
          line: 247,
          column: 8
        },
        end: {
          line: 258,
          column: 9
        }
      },
      "93": {
        start: {
          line: 249,
          column: 34
        },
        end: {
          line: 249,
          column: 95
        }
      },
      "94": {
        start: {
          line: 250,
          column: 44
        },
        end: {
          line: 250,
          column: 271
        }
      },
      "95": {
        start: {
          line: 251,
          column: 12
        },
        end: {
          line: 255,
          column: 13
        }
      },
      "96": {
        start: {
          line: 252,
          column: 16
        },
        end: {
          line: 254,
          column: 17
        }
      },
      "97": {
        start: {
          line: 253,
          column: 20
        },
        end: {
          line: 253,
          column: 67
        }
      },
      "98": {
        start: {
          line: 257,
          column: 12
        },
        end: {
          line: 257,
          column: 70
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "_interop_require_default",
        decl: {
          start: {
            line: 14,
            column: 9
          },
          end: {
            line: 14,
            column: 33
          }
        },
        loc: {
          start: {
            line: 14,
            column: 39
          },
          end: {
            line: 18,
            column: 1
          }
        },
        line: 14
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 20,
            column: 4
          },
          end: {
            line: 20,
            column: 5
          }
        },
        loc: {
          start: {
            line: 20,
            column: 17
          },
          end: {
            line: 24,
            column: 5
          }
        },
        line: 20
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 25,
            column: 4
          },
          end: {
            line: 25,
            column: 5
          }
        },
        loc: {
          start: {
            line: 25,
            column: 60
          },
          end: {
            line: 91,
            column: 5
          }
        },
        line: 25
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 92,
            column: 4
          },
          end: {
            line: 92,
            column: 5
          }
        },
        loc: {
          start: {
            line: 92,
            column: 42
          },
          end: {
            line: 108,
            column: 5
          }
        },
        line: 92
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 109,
            column: 4
          },
          end: {
            line: 109,
            column: 5
          }
        },
        loc: {
          start: {
            line: 109,
            column: 45
          },
          end: {
            line: 140,
            column: 5
          }
        },
        line: 109
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 141,
            column: 4
          },
          end: {
            line: 141,
            column: 5
          }
        },
        loc: {
          start: {
            line: 141,
            column: 45
          },
          end: {
            line: 178,
            column: 5
          }
        },
        line: 141
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 163,
            column: 39
          },
          end: {
            line: 163,
            column: 40
          }
        },
        loc: {
          start: {
            line: 163,
            column: 48
          },
          end: {
            line: 173,
            column: 13
          }
        },
        line: 163
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 179,
            column: 4
          },
          end: {
            line: 179,
            column: 5
          }
        },
        loc: {
          start: {
            line: 179,
            column: 75
          },
          end: {
            line: 203,
            column: 5
          }
        },
        line: 179
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 204,
            column: 4
          },
          end: {
            line: 204,
            column: 5
          }
        },
        loc: {
          start: {
            line: 204,
            column: 40
          },
          end: {
            line: 218,
            column: 5
          }
        },
        line: 204
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 219,
            column: 4
          },
          end: {
            line: 219,
            column: 5
          }
        },
        loc: {
          start: {
            line: 219,
            column: 26
          },
          end: {
            line: 221,
            column: 5
          }
        },
        line: 219
      },
      "11": {
        name: "(anonymous_11)",
        decl: {
          start: {
            line: 222,
            column: 4
          },
          end: {
            line: 222,
            column: 5
          }
        },
        loc: {
          start: {
            line: 222,
            column: 41
          },
          end: {
            line: 244,
            column: 5
          }
        },
        line: 222
      },
      "12": {
        name: "(anonymous_12)",
        decl: {
          start: {
            line: 245,
            column: 4
          },
          end: {
            line: 245,
            column: 5
          }
        },
        loc: {
          start: {
            line: 245,
            column: 47
          },
          end: {
            line: 259,
            column: 5
          }
        },
        line: 245
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 15,
            column: 11
          },
          end: {
            line: 17,
            column: 5
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 15,
            column: 35
          },
          end: {
            line: 15,
            column: 38
          }
        }, {
          start: {
            line: 15,
            column: 41
          },
          end: {
            line: 17,
            column: 5
          }
        }],
        line: 15
      },
      "1": {
        loc: {
          start: {
            line: 15,
            column: 11
          },
          end: {
            line: 15,
            column: 32
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 15,
            column: 11
          },
          end: {
            line: 15,
            column: 14
          }
        }, {
          start: {
            line: 15,
            column: 18
          },
          end: {
            line: 15,
            column: 32
          }
        }],
        line: 15
      },
      "2": {
        loc: {
          start: {
            line: 27,
            column: 8
          },
          end: {
            line: 29,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 27,
            column: 8
          },
          end: {
            line: 29,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 27
      },
      "3": {
        loc: {
          start: {
            line: 27,
            column: 12
          },
          end: {
            line: 27,
            column: 60
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 27,
            column: 12
          },
          end: {
            line: 27,
            column: 27
          }
        }, {
          start: {
            line: 27,
            column: 31
          },
          end: {
            line: 27,
            column: 60
          }
        }],
        line: 27
      },
      "4": {
        loc: {
          start: {
            line: 31,
            column: 8
          },
          end: {
            line: 33,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 31,
            column: 8
          },
          end: {
            line: 33,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 31
      },
      "5": {
        loc: {
          start: {
            line: 31,
            column: 12
          },
          end: {
            line: 31,
            column: 76
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 31,
            column: 12
          },
          end: {
            line: 31,
            column: 32
          }
        }, {
          start: {
            line: 31,
            column: 36
          },
          end: {
            line: 31,
            column: 76
          }
        }],
        line: 31
      },
      "6": {
        loc: {
          start: {
            line: 43,
            column: 12
          },
          end: {
            line: 45,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 43,
            column: 12
          },
          end: {
            line: 45,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 43
      },
      "7": {
        loc: {
          start: {
            line: 51,
            column: 12
          },
          end: {
            line: 54,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 51,
            column: 12
          },
          end: {
            line: 54,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 51
      },
      "8": {
        loc: {
          start: {
            line: 51,
            column: 16
          },
          end: {
            line: 51,
            column: 71
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 51,
            column: 16
          },
          end: {
            line: 51,
            column: 41
          }
        }, {
          start: {
            line: 51,
            column: 45
          },
          end: {
            line: 51,
            column: 71
          }
        }],
        line: 51
      },
      "9": {
        loc: {
          start: {
            line: 79,
            column: 12
          },
          end: {
            line: 85,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 79,
            column: 12
          },
          end: {
            line: 85,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 79
      },
      "10": {
        loc: {
          start: {
            line: 94,
            column: 8
          },
          end: {
            line: 96,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 94,
            column: 8
          },
          end: {
            line: 96,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 94
      },
      "11": {
        loc: {
          start: {
            line: 94,
            column: 12
          },
          end: {
            line: 94,
            column: 26
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 94,
            column: 12
          },
          end: {
            line: 94,
            column: 17
          }
        }, {
          start: {
            line: 94,
            column: 21
          },
          end: {
            line: 94,
            column: 26
          }
        }],
        line: 94
      },
      "12": {
        loc: {
          start: {
            line: 111,
            column: 8
          },
          end: {
            line: 113,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 111,
            column: 8
          },
          end: {
            line: 113,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 111
      },
      "13": {
        loc: {
          start: {
            line: 121,
            column: 12
          },
          end: {
            line: 123,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 121,
            column: 12
          },
          end: {
            line: 123,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 121
      },
      "14": {
        loc: {
          start: {
            line: 125,
            column: 12
          },
          end: {
            line: 130,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 125,
            column: 12
          },
          end: {
            line: 130,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 125
      },
      "15": {
        loc: {
          start: {
            line: 133,
            column: 12
          },
          end: {
            line: 135,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 133,
            column: 12
          },
          end: {
            line: 135,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 133
      },
      "16": {
        loc: {
          start: {
            line: 145,
            column: 8
          },
          end: {
            line: 147,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 145,
            column: 8
          },
          end: {
            line: 147,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 145
      },
      "17": {
        loc: {
          start: {
            line: 148,
            column: 8
          },
          end: {
            line: 150,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 148,
            column: 8
          },
          end: {
            line: 150,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 148
      },
      "18": {
        loc: {
          start: {
            line: 151,
            column: 8
          },
          end: {
            line: 153,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 151,
            column: 8
          },
          end: {
            line: 153,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 151
      },
      "19": {
        loc: {
          start: {
            line: 154,
            column: 8
          },
          end: {
            line: 156,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 154,
            column: 8
          },
          end: {
            line: 156,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 154
      },
      "20": {
        loc: {
          start: {
            line: 155,
            column: 66
          },
          end: {
            line: 155,
            column: 85
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 155,
            column: 66
          },
          end: {
            line: 155,
            column: 79
          }
        }, {
          start: {
            line: 155,
            column: 83
          },
          end: {
            line: 155,
            column: 85
          }
        }],
        line: 155
      },
      "21": {
        loc: {
          start: {
            line: 160,
            column: 8
          },
          end: {
            line: 162,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 160,
            column: 8
          },
          end: {
            line: 162,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 160
      },
      "22": {
        loc: {
          start: {
            line: 163,
            column: 23
          },
          end: {
            line: 163,
            column: 33
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 163,
            column: 23
          },
          end: {
            line: 163,
            column: 27
          }
        }, {
          start: {
            line: 163,
            column: 31
          },
          end: {
            line: 163,
            column: 33
          }
        }],
        line: 163
      },
      "23": {
        loc: {
          start: {
            line: 176,
            column: 19
          },
          end: {
            line: 176,
            column: 29
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 176,
            column: 19
          },
          end: {
            line: 176,
            column: 24
          }
        }, {
          start: {
            line: 176,
            column: 28
          },
          end: {
            line: 176,
            column: 29
          }
        }],
        line: 176
      },
      "24": {
        loc: {
          start: {
            line: 193,
            column: 12
          },
          end: {
            line: 196,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 193,
            column: 12
          },
          end: {
            line: 196,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 193
      },
      "25": {
        loc: {
          start: {
            line: 225,
            column: 8
          },
          end: {
            line: 227,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 225,
            column: 8
          },
          end: {
            line: 227,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 225
      },
      "26": {
        loc: {
          start: {
            line: 225,
            column: 12
          },
          end: {
            line: 225,
            column: 62
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 225,
            column: 12
          },
          end: {
            line: 225,
            column: 29
          }
        }, {
          start: {
            line: 225,
            column: 33
          },
          end: {
            line: 225,
            column: 62
          }
        }],
        line: 225
      },
      "27": {
        loc: {
          start: {
            line: 243,
            column: 15
          },
          end: {
            line: 243,
            column: 49
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 243,
            column: 15
          },
          end: {
            line: 243,
            column: 43
          }
        }, {
          start: {
            line: 243,
            column: 47
          },
          end: {
            line: 243,
            column: 49
          }
        }],
        line: 243
      },
      "28": {
        loc: {
          start: {
            line: 251,
            column: 12
          },
          end: {
            line: 255,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 251,
            column: 12
          },
          end: {
            line: 255,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 251
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0,
      "65": 0,
      "66": 0,
      "67": 0,
      "68": 0,
      "69": 0,
      "70": 0,
      "71": 0,
      "72": 0,
      "73": 0,
      "74": 0,
      "75": 0,
      "76": 0,
      "77": 0,
      "78": 0,
      "79": 0,
      "80": 0,
      "81": 0,
      "82": 0,
      "83": 0,
      "84": 0,
      "85": 0,
      "86": 0,
      "87": 0,
      "88": 0,
      "89": 0,
      "90": 0,
      "91": 0,
      "92": 0,
      "93": 0,
      "94": 0,
      "95": 0,
      "96": 0,
      "97": 0,
      "98": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0, 0],
      "15": [0, 0],
      "16": [0, 0],
      "17": [0, 0],
      "18": [0, 0],
      "19": [0, 0],
      "20": [0, 0],
      "21": [0, 0],
      "22": [0, 0],
      "23": [0, 0],
      "24": [0, 0],
      "25": [0, 0],
      "26": [0, 0],
      "27": [0, 0],
      "28": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["C:\\Ai Projecten\\ADSapp\\src\\lib\\media\\storage.ts"],
      sourcesContent: ["import { createClient } from '@/lib/supabase/server'\nimport { v4 as uuidv4 } from 'uuid'\nimport sharp from 'sharp'\n\nexport interface MediaFile {\n  id: string\n  originalName: string\n  mimeType: string\n  size: number\n  url: string\n  thumbnailUrl?: string\n  organizationId: string\n  uploadedBy: string\n  metadata?: {\n    width?: number\n    height?: number\n    duration?: number\n    [key: string]: any\n  }\n}\n\nexport interface UploadOptions {\n  organizationId: string\n  uploadedBy: string\n  generateThumbnail?: boolean\n  maxSize?: number // in bytes\n  allowedTypes?: string[]\n}\n\nexport class MediaStorageService {\n  private supabase = createClient()\n  private bucketName = 'media'\n\n  constructor() {\n    this.supabase = createClient()\n  }\n\n  async uploadFile(\n    file: Buffer,\n    originalName: string,\n    mimeType: string,\n    options: UploadOptions\n  ): Promise<MediaFile> {\n    // Validate file size\n    if (options.maxSize && file.length > options.maxSize) {\n      throw new Error(`File size exceeds maximum allowed size of ${options.maxSize} bytes`)\n    }\n\n    // Validate file type\n    if (options.allowedTypes && !options.allowedTypes.includes(mimeType)) {\n      throw new Error(`File type ${mimeType} is not allowed`)\n    }\n\n    const fileId = uuidv4()\n    const fileExtension = this.getFileExtension(originalName, mimeType)\n    const fileName = `${options.organizationId}/${fileId}${fileExtension}`\n\n    try {\n      // Upload original file\n      const { data: uploadData, error: uploadError } = await (await this.supabase).storage\n        .from(this.bucketName)\n        .upload(fileName, file, {\n          contentType: mimeType,\n          cacheControl: '3600'\n        })\n\n      if (uploadError) {\n        throw new Error(`Failed to upload file: ${uploadError.message}`)\n      }\n\n      // Get public URL\n      const { data: urlData } = await (await this.supabase).storage\n        .from(this.bucketName)\n        .getPublicUrl(fileName)\n\n      let thumbnailUrl: string | undefined\n      let metadata: any = {}\n\n      // Generate thumbnail for images\n      if (options.generateThumbnail && this.isImageType(mimeType)) {\n        thumbnailUrl = await this.generateThumbnail(file, fileName, options.organizationId)\n        metadata = await this.getImageMetadata(file)\n      }\n\n      // Store file record in database\n      const mediaFile: MediaFile = {\n        id: fileId,\n        originalName,\n        mimeType,\n        size: file.length,\n        url: urlData.publicUrl,\n        thumbnailUrl,\n        organizationId: options.organizationId,\n        uploadedBy: options.uploadedBy,\n        metadata\n      }\n\n      const { error: dbError } = await (await this.supabase)\n        .from('media_files')\n        .insert({\n          id: fileId,\n          original_name: originalName,\n          mime_type: mimeType,\n          file_size: file.length,\n          storage_path: fileName,\n          url: urlData.publicUrl,\n          thumbnail_url: thumbnailUrl,\n          organization_id: options.organizationId,\n          uploaded_by: options.uploadedBy,\n          metadata\n        })\n\n      if (dbError) {\n        // Clean up uploaded file if database insert fails\n        await (await this.supabase).storage.from(this.bucketName).remove([fileName])\n        throw new Error(`Failed to store file record: ${dbError.message}`)\n      }\n\n      return mediaFile\n    } catch (error) {\n      console.error('Error uploading file:', error)\n      throw error\n    }\n  }\n\n  async getFile(fileId: string, organizationId: string): Promise<MediaFile | null> {\n    const { data, error } = await (await this.supabase)\n      .from('media_files')\n      .select('*')\n      .eq('id', fileId)\n      .eq('organization_id', organizationId)\n      .single()\n\n    if (error || !data) {\n      return null\n    }\n\n    return {\n      id: data.id,\n      originalName: data.original_name,\n      mimeType: data.mime_type,\n      size: data.file_size,\n      url: data.url,\n      thumbnailUrl: data.thumbnail_url,\n      organizationId: data.organization_id,\n      uploadedBy: data.uploaded_by,\n      metadata: data.metadata\n    }\n  }\n\n  async deleteFile(fileId: string, organizationId: string): Promise<void> {\n    const file = await this.getFile(fileId, organizationId)\n    if (!file) {\n      throw new Error('File not found')\n    }\n\n    try {\n      // Extract storage path from URL or construct it\n      const storagePath = `${organizationId}/${fileId}${this.getFileExtension(file.originalName, file.mimeType)}`\n\n      // Delete from storage\n      const { error: storageError } = await (await this.supabase).storage\n        .from(this.bucketName)\n        .remove([storagePath])\n\n      if (storageError) {\n        console.error('Error deleting file from storage:', storageError)\n      }\n\n      // Delete thumbnail if exists\n      if (file.thumbnailUrl) {\n        const thumbnailPath = `${organizationId}/thumbnails/${fileId}.jpg`\n        await (await this.supabase).storage\n          .from(this.bucketName)\n          .remove([thumbnailPath])\n      }\n\n      // Delete from database\n      const { error: dbError } = await (await this.supabase)\n        .from('media_files')\n        .delete()\n        .eq('id', fileId)\n        .eq('organization_id', organizationId)\n\n      if (dbError) {\n        throw new Error(`Failed to delete file record: ${dbError.message}`)\n      }\n    } catch (error) {\n      console.error('Error deleting file:', error)\n      throw error\n    }\n  }\n\n  async listFiles(\n    organizationId: string,\n    options?: {\n      limit?: number\n      offset?: number\n      mimeType?: string\n      uploadedBy?: string\n    }\n  ): Promise<{ files: MediaFile[]; total: number }> {\n    let query = (await this.supabase)\n      .from('media_files')\n      .select('*', { count: 'exact' })\n      .eq('organization_id', organizationId)\n\n    if (options?.mimeType) {\n      query = query.ilike('mime_type', `${options.mimeType}%`)\n    }\n\n    if (options?.uploadedBy) {\n      query = query.eq('uploaded_by', options.uploadedBy)\n    }\n\n    if (options?.limit) {\n      query = query.limit(options.limit)\n    }\n\n    if (options?.offset) {\n      query = query.range(options.offset, (options.offset + (options.limit || 20)) - 1)\n    }\n\n    const { data, error, count } = await query.order('created_at', { ascending: false })\n\n    if (error) {\n      throw new Error(`Failed to list files: ${error.message}`)\n    }\n\n    const files = (data || []).map(item => ({\n      id: item.id,\n      originalName: item.original_name,\n      mimeType: item.mime_type,\n      size: item.file_size,\n      url: item.url,\n      thumbnailUrl: item.thumbnail_url,\n      organizationId: item.organization_id,\n      uploadedBy: item.uploaded_by,\n      metadata: item.metadata\n    }))\n\n    return {\n      files,\n      total: count || 0\n    }\n  }\n\n  private async generateThumbnail(\n    imageBuffer: Buffer,\n    originalFileName: string,\n    organizationId: string\n  ): Promise<string> {\n    try {\n      const thumbnailBuffer = await sharp(imageBuffer)\n        .resize(300, 300, {\n          fit: 'inside',\n          withoutEnlargement: true\n        })\n        .jpeg({ quality: 80 })\n        .toBuffer()\n\n      const fileId = originalFileName.split('/')[1].split('.')[0]\n      const thumbnailPath = `${organizationId}/thumbnails/${fileId}.jpg`\n\n      const { error } = await (await this.supabase).storage\n        .from(this.bucketName)\n        .upload(thumbnailPath, thumbnailBuffer, {\n          contentType: 'image/jpeg',\n          cacheControl: '3600'\n        })\n\n      if (error) {\n        console.error('Error uploading thumbnail:', error)\n        return ''\n      }\n\n      const { data: urlData } = await (await this.supabase).storage\n        .from(this.bucketName)\n        .getPublicUrl(thumbnailPath)\n\n      return urlData.publicUrl\n    } catch (error) {\n      console.error('Error generating thumbnail:', error)\n      return ''\n    }\n  }\n\n  private async getImageMetadata(imageBuffer: Buffer): Promise<any> {\n    try {\n      const metadata = await sharp(imageBuffer).metadata()\n      return {\n        width: metadata.width,\n        height: metadata.height,\n        format: metadata.format,\n        hasAlpha: metadata.hasAlpha,\n        channels: metadata.channels\n      }\n    } catch (error) {\n      console.error('Error getting image metadata:', error)\n      return {}\n    }\n  }\n\n  private isImageType(mimeType: string): boolean {\n    return mimeType.startsWith('image/')\n  }\n\n  private getFileExtension(fileName: string, mimeType: string): string {\n    // Try to get extension from filename\n    const extensionFromName = fileName.split('.').pop()?.toLowerCase()\n    if (extensionFromName && extensionFromName.length <= 4) {\n      return `.${extensionFromName}`\n    }\n\n    // Fallback to mime type mapping\n    const mimeTypeExtensions: { [key: string]: string } = {\n      'image/jpeg': '.jpg',\n      'image/png': '.png',\n      'image/gif': '.gif',\n      'image/webp': '.webp',\n      'video/mp4': '.mp4',\n      'video/quicktime': '.mov',\n      'audio/mpeg': '.mp3',\n      'audio/ogg': '.ogg',\n      'audio/wav': '.wav',\n      'application/pdf': '.pdf',\n      'text/plain': '.txt',\n      'application/json': '.json'\n    }\n\n    return mimeTypeExtensions[mimeType] || ''\n  }\n\n  async cleanupOrphanedFiles(organizationId: string): Promise<void> {\n    // This method can be called periodically to clean up files that are no longer referenced\n    try {\n      // Find files that haven't been accessed in 30 days and aren't referenced in messages\n      const thirtyDaysAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString()\n\n      const { data: orphanedFiles } = await (await this.supabase)\n        .from('media_files')\n        .select('id')\n        .eq('organization_id', organizationId)\n        .lt('created_at', thirtyDaysAgo)\n        .not('id', 'in', `(SELECT DISTINCT media_file_id FROM messages WHERE media_file_id IS NOT NULL)`)\n\n      if (orphanedFiles) {\n        for (const file of orphanedFiles) {\n          await this.deleteFile(file.id, organizationId)\n        }\n      }\n    } catch (error) {\n      console.error('Error cleaning up orphaned files:', error)\n    }\n  }\n}"],
      names: ["MediaStorageService", "supabase", "createClient", "bucketName", "uploadFile", "file", "originalName", "mimeType", "options", "maxSize", "length", "Error", "allowedTypes", "includes", "fileId", "uuidv4", "fileExtension", "getFileExtension", "fileName", "organizationId", "data", "uploadData", "error", "uploadError", "storage", "from", "upload", "contentType", "cacheControl", "message", "urlData", "getPublicUrl", "thumbnailUrl", "metadata", "generateThumbnail", "isImageType", "getImageMetadata", "mediaFile", "id", "size", "url", "publicUrl", "uploadedBy", "dbError", "insert", "original_name", "mime_type", "file_size", "storage_path", "thumbnail_url", "organization_id", "uploaded_by", "remove", "console", "getFile", "select", "eq", "single", "deleteFile", "storagePath", "storageError", "thumbnailPath", "delete", "listFiles", "query", "count", "ilike", "limit", "offset", "range", "order", "ascending", "files", "map", "item", "total", "imageBuffer", "originalFileName", "thumbnailBuffer", "sharp", "resize", "fit", "withoutEnlargement", "jpeg", "quality", "toBuffer", "split", "width", "height", "format", "hasAlpha", "channels", "startsWith", "extensionFromName", "pop", "toLowerCase", "mimeTypeExtensions", "cleanupOrphanedFiles", "thirtyDaysAgo", "Date", "now", "toISOString", "orphanedFiles", "lt", "not"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "66c2bcb3cfacad8c2cc00b42af520f8d59548033"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_21dhq4bt12 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_21dhq4bt12();
cov_21dhq4bt12().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_21dhq4bt12().s[1]++;
Object.defineProperty(exports, "MediaStorageService", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[0]++;
    cov_21dhq4bt12().s[2]++;
    return MediaStorageService;
  }
});
const _server =
/* istanbul ignore next */
(cov_21dhq4bt12().s[3]++, require("../supabase/server"));
const _uuid =
/* istanbul ignore next */
(cov_21dhq4bt12().s[4]++, require("uuid"));
const _sharp =
/* istanbul ignore next */
(/*#__PURE__*/cov_21dhq4bt12().s[5]++, _interop_require_default(require("sharp")));
function _interop_require_default(obj) {
  /* istanbul ignore next */
  cov_21dhq4bt12().f[1]++;
  cov_21dhq4bt12().s[6]++;
  return /* istanbul ignore next */(cov_21dhq4bt12().b[1][0]++, obj) &&
  /* istanbul ignore next */
  (cov_21dhq4bt12().b[1][1]++, obj.__esModule) ?
  /* istanbul ignore next */
  (cov_21dhq4bt12().b[0][0]++, obj) :
  /* istanbul ignore next */
  (cov_21dhq4bt12().b[0][1]++, {
    default: obj
  });
}
class MediaStorageService {
  constructor() {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[2]++;
    cov_21dhq4bt12().s[7]++;
    this.supabase = (0, _server.createClient)();
    /* istanbul ignore next */
    cov_21dhq4bt12().s[8]++;
    this.bucketName = 'media';
    /* istanbul ignore next */
    cov_21dhq4bt12().s[9]++;
    this.supabase = (0, _server.createClient)();
  }
  async uploadFile(file, originalName, mimeType, options) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[3]++;
    cov_21dhq4bt12().s[10]++;
    // Validate file size
    if (
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[3][0]++, options.maxSize) &&
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[3][1]++, file.length > options.maxSize)) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[2][0]++;
      cov_21dhq4bt12().s[11]++;
      throw new Error(`File size exceeds maximum allowed size of ${options.maxSize} bytes`);
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[2][1]++;
    }
    // Validate file type
    cov_21dhq4bt12().s[12]++;
    if (
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[5][0]++, options.allowedTypes) &&
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[5][1]++, !options.allowedTypes.includes(mimeType))) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[4][0]++;
      cov_21dhq4bt12().s[13]++;
      throw new Error(`File type ${mimeType} is not allowed`);
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[4][1]++;
    }
    const fileId =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[14]++, (0, _uuid.v4)());
    const fileExtension =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[15]++, this.getFileExtension(originalName, mimeType));
    const fileName =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[16]++, `${options.organizationId}/${fileId}${fileExtension}`);
    /* istanbul ignore next */
    cov_21dhq4bt12().s[17]++;
    try {
      // Upload original file
      const {
        data: uploadData,
        error: uploadError
      } =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[18]++, await (await this.supabase).storage.from(this.bucketName).upload(fileName, file, {
        contentType: mimeType,
        cacheControl: '3600'
      }));
      /* istanbul ignore next */
      cov_21dhq4bt12().s[19]++;
      if (uploadError) {
        /* istanbul ignore next */
        cov_21dhq4bt12().b[6][0]++;
        cov_21dhq4bt12().s[20]++;
        throw new Error(`Failed to upload file: ${uploadError.message}`);
      } else
      /* istanbul ignore next */
      {
        cov_21dhq4bt12().b[6][1]++;
      }
      // Get public URL
      const {
        data: urlData
      } =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[21]++, await (await this.supabase).storage.from(this.bucketName).getPublicUrl(fileName));
      let thumbnailUrl;
      let metadata =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[22]++, {});
      // Generate thumbnail for images
      /* istanbul ignore next */
      cov_21dhq4bt12().s[23]++;
      if (
      /* istanbul ignore next */
      (cov_21dhq4bt12().b[8][0]++, options.generateThumbnail) &&
      /* istanbul ignore next */
      (cov_21dhq4bt12().b[8][1]++, this.isImageType(mimeType))) {
        /* istanbul ignore next */
        cov_21dhq4bt12().b[7][0]++;
        cov_21dhq4bt12().s[24]++;
        thumbnailUrl = await this.generateThumbnail(file, fileName, options.organizationId);
        /* istanbul ignore next */
        cov_21dhq4bt12().s[25]++;
        metadata = await this.getImageMetadata(file);
      } else
      /* istanbul ignore next */
      {
        cov_21dhq4bt12().b[7][1]++;
      }
      // Store file record in database
      const mediaFile =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[26]++, {
        id: fileId,
        originalName,
        mimeType,
        size: file.length,
        url: urlData.publicUrl,
        thumbnailUrl,
        organizationId: options.organizationId,
        uploadedBy: options.uploadedBy,
        metadata
      });
      const {
        error: dbError
      } =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[27]++, await (await this.supabase).from('media_files').insert({
        id: fileId,
        original_name: originalName,
        mime_type: mimeType,
        file_size: file.length,
        storage_path: fileName,
        url: urlData.publicUrl,
        thumbnail_url: thumbnailUrl,
        organization_id: options.organizationId,
        uploaded_by: options.uploadedBy,
        metadata
      }));
      /* istanbul ignore next */
      cov_21dhq4bt12().s[28]++;
      if (dbError) {
        /* istanbul ignore next */
        cov_21dhq4bt12().b[9][0]++;
        cov_21dhq4bt12().s[29]++;
        // Clean up uploaded file if database insert fails
        await (await this.supabase).storage.from(this.bucketName).remove([fileName]);
        /* istanbul ignore next */
        cov_21dhq4bt12().s[30]++;
        throw new Error(`Failed to store file record: ${dbError.message}`);
      } else
      /* istanbul ignore next */
      {
        cov_21dhq4bt12().b[9][1]++;
      }
      cov_21dhq4bt12().s[31]++;
      return mediaFile;
    } catch (error) {
      /* istanbul ignore next */
      cov_21dhq4bt12().s[32]++;
      console.error('Error uploading file:', error);
      /* istanbul ignore next */
      cov_21dhq4bt12().s[33]++;
      throw error;
    }
  }
  async getFile(fileId, organizationId) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[4]++;
    const {
      data,
      error
    } =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[34]++, await (await this.supabase).from('media_files').select('*').eq('id', fileId).eq('organization_id', organizationId).single());
    /* istanbul ignore next */
    cov_21dhq4bt12().s[35]++;
    if (
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[11][0]++, error) ||
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[11][1]++, !data)) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[10][0]++;
      cov_21dhq4bt12().s[36]++;
      return null;
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[10][1]++;
    }
    cov_21dhq4bt12().s[37]++;
    return {
      id: data.id,
      originalName: data.original_name,
      mimeType: data.mime_type,
      size: data.file_size,
      url: data.url,
      thumbnailUrl: data.thumbnail_url,
      organizationId: data.organization_id,
      uploadedBy: data.uploaded_by,
      metadata: data.metadata
    };
  }
  async deleteFile(fileId, organizationId) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[5]++;
    const file =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[38]++, await this.getFile(fileId, organizationId));
    /* istanbul ignore next */
    cov_21dhq4bt12().s[39]++;
    if (!file) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[12][0]++;
      cov_21dhq4bt12().s[40]++;
      throw new Error('File not found');
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[12][1]++;
    }
    cov_21dhq4bt12().s[41]++;
    try {
      // Extract storage path from URL or construct it
      const storagePath =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[42]++, `${organizationId}/${fileId}${this.getFileExtension(file.originalName, file.mimeType)}`);
      // Delete from storage
      const {
        error: storageError
      } =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[43]++, await (await this.supabase).storage.from(this.bucketName).remove([storagePath]));
      /* istanbul ignore next */
      cov_21dhq4bt12().s[44]++;
      if (storageError) {
        /* istanbul ignore next */
        cov_21dhq4bt12().b[13][0]++;
        cov_21dhq4bt12().s[45]++;
        console.error('Error deleting file from storage:', storageError);
      } else
      /* istanbul ignore next */
      {
        cov_21dhq4bt12().b[13][1]++;
      }
      // Delete thumbnail if exists
      cov_21dhq4bt12().s[46]++;
      if (file.thumbnailUrl) {
        /* istanbul ignore next */
        cov_21dhq4bt12().b[14][0]++;
        const thumbnailPath =
        /* istanbul ignore next */
        (cov_21dhq4bt12().s[47]++, `${organizationId}/thumbnails/${fileId}.jpg`);
        /* istanbul ignore next */
        cov_21dhq4bt12().s[48]++;
        await (await this.supabase).storage.from(this.bucketName).remove([thumbnailPath]);
      } else
      /* istanbul ignore next */
      {
        cov_21dhq4bt12().b[14][1]++;
      }
      // Delete from database
      const {
        error: dbError
      } =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[49]++, await (await this.supabase).from('media_files').delete().eq('id', fileId).eq('organization_id', organizationId));
      /* istanbul ignore next */
      cov_21dhq4bt12().s[50]++;
      if (dbError) {
        /* istanbul ignore next */
        cov_21dhq4bt12().b[15][0]++;
        cov_21dhq4bt12().s[51]++;
        throw new Error(`Failed to delete file record: ${dbError.message}`);
      } else
      /* istanbul ignore next */
      {
        cov_21dhq4bt12().b[15][1]++;
      }
    } catch (error) {
      /* istanbul ignore next */
      cov_21dhq4bt12().s[52]++;
      console.error('Error deleting file:', error);
      /* istanbul ignore next */
      cov_21dhq4bt12().s[53]++;
      throw error;
    }
  }
  async listFiles(organizationId, options) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[6]++;
    let query =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[54]++, (await this.supabase).from('media_files').select('*', {
      count: 'exact'
    }).eq('organization_id', organizationId));
    /* istanbul ignore next */
    cov_21dhq4bt12().s[55]++;
    if (options?.mimeType) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[16][0]++;
      cov_21dhq4bt12().s[56]++;
      query = query.ilike('mime_type', `${options.mimeType}%`);
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[16][1]++;
    }
    cov_21dhq4bt12().s[57]++;
    if (options?.uploadedBy) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[17][0]++;
      cov_21dhq4bt12().s[58]++;
      query = query.eq('uploaded_by', options.uploadedBy);
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[17][1]++;
    }
    cov_21dhq4bt12().s[59]++;
    if (options?.limit) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[18][0]++;
      cov_21dhq4bt12().s[60]++;
      query = query.limit(options.limit);
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[18][1]++;
    }
    cov_21dhq4bt12().s[61]++;
    if (options?.offset) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[19][0]++;
      cov_21dhq4bt12().s[62]++;
      query = query.range(options.offset, options.offset + (
      /* istanbul ignore next */
      (cov_21dhq4bt12().b[20][0]++, options.limit) ||
      /* istanbul ignore next */
      (cov_21dhq4bt12().b[20][1]++, 20)) - 1);
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[19][1]++;
    }
    const {
      data,
      error,
      count
    } =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[63]++, await query.order('created_at', {
      ascending: false
    }));
    /* istanbul ignore next */
    cov_21dhq4bt12().s[64]++;
    if (error) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[21][0]++;
      cov_21dhq4bt12().s[65]++;
      throw new Error(`Failed to list files: ${error.message}`);
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[21][1]++;
    }
    const files =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[66]++, (
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[22][0]++, data) ||
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[22][1]++, [])).map(item => {
      /* istanbul ignore next */
      cov_21dhq4bt12().f[7]++;
      cov_21dhq4bt12().s[67]++;
      return {
        id: item.id,
        originalName: item.original_name,
        mimeType: item.mime_type,
        size: item.file_size,
        url: item.url,
        thumbnailUrl: item.thumbnail_url,
        organizationId: item.organization_id,
        uploadedBy: item.uploaded_by,
        metadata: item.metadata
      };
    }));
    /* istanbul ignore next */
    cov_21dhq4bt12().s[68]++;
    return {
      files,
      total:
      /* istanbul ignore next */
      (cov_21dhq4bt12().b[23][0]++, count) ||
      /* istanbul ignore next */
      (cov_21dhq4bt12().b[23][1]++, 0)
    };
  }
  async generateThumbnail(imageBuffer, originalFileName, organizationId) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[8]++;
    cov_21dhq4bt12().s[69]++;
    try {
      const thumbnailBuffer =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[70]++, await (0, _sharp.default)(imageBuffer).resize(300, 300, {
        fit: 'inside',
        withoutEnlargement: true
      }).jpeg({
        quality: 80
      }).toBuffer());
      const fileId =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[71]++, originalFileName.split('/')[1].split('.')[0]);
      const thumbnailPath =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[72]++, `${organizationId}/thumbnails/${fileId}.jpg`);
      const {
        error
      } =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[73]++, await (await this.supabase).storage.from(this.bucketName).upload(thumbnailPath, thumbnailBuffer, {
        contentType: 'image/jpeg',
        cacheControl: '3600'
      }));
      /* istanbul ignore next */
      cov_21dhq4bt12().s[74]++;
      if (error) {
        /* istanbul ignore next */
        cov_21dhq4bt12().b[24][0]++;
        cov_21dhq4bt12().s[75]++;
        console.error('Error uploading thumbnail:', error);
        /* istanbul ignore next */
        cov_21dhq4bt12().s[76]++;
        return '';
      } else
      /* istanbul ignore next */
      {
        cov_21dhq4bt12().b[24][1]++;
      }
      const {
        data: urlData
      } =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[77]++, await (await this.supabase).storage.from(this.bucketName).getPublicUrl(thumbnailPath));
      /* istanbul ignore next */
      cov_21dhq4bt12().s[78]++;
      return urlData.publicUrl;
    } catch (error) {
      /* istanbul ignore next */
      cov_21dhq4bt12().s[79]++;
      console.error('Error generating thumbnail:', error);
      /* istanbul ignore next */
      cov_21dhq4bt12().s[80]++;
      return '';
    }
  }
  async getImageMetadata(imageBuffer) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[9]++;
    cov_21dhq4bt12().s[81]++;
    try {
      const metadata =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[82]++, await (0, _sharp.default)(imageBuffer).metadata());
      /* istanbul ignore next */
      cov_21dhq4bt12().s[83]++;
      return {
        width: metadata.width,
        height: metadata.height,
        format: metadata.format,
        hasAlpha: metadata.hasAlpha,
        channels: metadata.channels
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_21dhq4bt12().s[84]++;
      console.error('Error getting image metadata:', error);
      /* istanbul ignore next */
      cov_21dhq4bt12().s[85]++;
      return {};
    }
  }
  isImageType(mimeType) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[10]++;
    cov_21dhq4bt12().s[86]++;
    return mimeType.startsWith('image/');
  }
  getFileExtension(fileName, mimeType) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[11]++;
    // Try to get extension from filename
    const extensionFromName =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[87]++, fileName.split('.').pop()?.toLowerCase());
    /* istanbul ignore next */
    cov_21dhq4bt12().s[88]++;
    if (
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[26][0]++, extensionFromName) &&
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[26][1]++, extensionFromName.length <= 4)) {
      /* istanbul ignore next */
      cov_21dhq4bt12().b[25][0]++;
      cov_21dhq4bt12().s[89]++;
      return `.${extensionFromName}`;
    } else
    /* istanbul ignore next */
    {
      cov_21dhq4bt12().b[25][1]++;
    }
    // Fallback to mime type mapping
    const mimeTypeExtensions =
    /* istanbul ignore next */
    (cov_21dhq4bt12().s[90]++, {
      'image/jpeg': '.jpg',
      'image/png': '.png',
      'image/gif': '.gif',
      'image/webp': '.webp',
      'video/mp4': '.mp4',
      'video/quicktime': '.mov',
      'audio/mpeg': '.mp3',
      'audio/ogg': '.ogg',
      'audio/wav': '.wav',
      'application/pdf': '.pdf',
      'text/plain': '.txt',
      'application/json': '.json'
    });
    /* istanbul ignore next */
    cov_21dhq4bt12().s[91]++;
    return /* istanbul ignore next */(cov_21dhq4bt12().b[27][0]++, mimeTypeExtensions[mimeType]) ||
    /* istanbul ignore next */
    (cov_21dhq4bt12().b[27][1]++, '');
  }
  async cleanupOrphanedFiles(organizationId) {
    /* istanbul ignore next */
    cov_21dhq4bt12().f[12]++;
    cov_21dhq4bt12().s[92]++;
    // This method can be called periodically to clean up files that are no longer referenced
    try {
      // Find files that haven't been accessed in 30 days and aren't referenced in messages
      const thirtyDaysAgo =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[93]++, new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString());
      const {
        data: orphanedFiles
      } =
      /* istanbul ignore next */
      (cov_21dhq4bt12().s[94]++, await (await this.supabase).from('media_files').select('id').eq('organization_id', organizationId).lt('created_at', thirtyDaysAgo).not('id', 'in', `(SELECT DISTINCT media_file_id FROM messages WHERE media_file_id IS NOT NULL)`));
      /* istanbul ignore next */
      cov_21dhq4bt12().s[95]++;
      if (orphanedFiles) {
        /* istanbul ignore next */
        cov_21dhq4bt12().b[28][0]++;
        cov_21dhq4bt12().s[96]++;
        for (const file of orphanedFiles) {
          /* istanbul ignore next */
          cov_21dhq4bt12().s[97]++;
          await this.deleteFile(file.id, organizationId);
        }
      } else
      /* istanbul ignore next */
      {
        cov_21dhq4bt12().b[28][1]++;
      }
    } catch (error) {
      /* istanbul ignore next */
      cov_21dhq4bt12().s[98]++;
      console.error('Error cleaning up orphaned files:', error);
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNZWRpYVN0b3JhZ2VTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJjb3ZfMjFkaHE0YnQxMiIsImYiLCJzIiwic3VwYWJhc2UiLCJfc2VydmVyIiwiY3JlYXRlQ2xpZW50IiwiYnVja2V0TmFtZSIsInVwbG9hZEZpbGUiLCJmaWxlIiwib3JpZ2luYWxOYW1lIiwibWltZVR5cGUiLCJvcHRpb25zIiwiYiIsIm1heFNpemUiLCJsZW5ndGgiLCJFcnJvciIsImFsbG93ZWRUeXBlcyIsImluY2x1ZGVzIiwiZmlsZUlkIiwiX3V1aWQiLCJ2NCIsImZpbGVFeHRlbnNpb24iLCJnZXRGaWxlRXh0ZW5zaW9uIiwiZmlsZU5hbWUiLCJvcmdhbml6YXRpb25JZCIsImRhdGEiLCJ1cGxvYWREYXRhIiwiZXJyb3IiLCJ1cGxvYWRFcnJvciIsInN0b3JhZ2UiLCJmcm9tIiwidXBsb2FkIiwiY29udGVudFR5cGUiLCJjYWNoZUNvbnRyb2wiLCJtZXNzYWdlIiwidXJsRGF0YSIsImdldFB1YmxpY1VybCIsInRodW1ibmFpbFVybCIsIm1ldGFkYXRhIiwiZ2VuZXJhdGVUaHVtYm5haWwiLCJpc0ltYWdlVHlwZSIsImdldEltYWdlTWV0YWRhdGEiLCJtZWRpYUZpbGUiLCJpZCIsInNpemUiLCJ1cmwiLCJwdWJsaWNVcmwiLCJ1cGxvYWRlZEJ5IiwiZGJFcnJvciIsImluc2VydCIsIm9yaWdpbmFsX25hbWUiLCJtaW1lX3R5cGUiLCJmaWxlX3NpemUiLCJzdG9yYWdlX3BhdGgiLCJ0aHVtYm5haWxfdXJsIiwib3JnYW5pemF0aW9uX2lkIiwidXBsb2FkZWRfYnkiLCJyZW1vdmUiLCJjb25zb2xlIiwiZ2V0RmlsZSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiZGVsZXRlRmlsZSIsInN0b3JhZ2VQYXRoIiwic3RvcmFnZUVycm9yIiwidGh1bWJuYWlsUGF0aCIsImRlbGV0ZSIsImxpc3RGaWxlcyIsInF1ZXJ5IiwiY291bnQiLCJpbGlrZSIsImxpbWl0Iiwib2Zmc2V0IiwicmFuZ2UiLCJvcmRlciIsImFzY2VuZGluZyIsImZpbGVzIiwibWFwIiwiaXRlbSIsInRvdGFsIiwiaW1hZ2VCdWZmZXIiLCJvcmlnaW5hbEZpbGVOYW1lIiwidGh1bWJuYWlsQnVmZmVyIiwiX3NoYXJwIiwiZGVmYXVsdCIsInJlc2l6ZSIsImZpdCIsIndpdGhvdXRFbmxhcmdlbWVudCIsImpwZWciLCJxdWFsaXR5IiwidG9CdWZmZXIiLCJzcGxpdCIsIndpZHRoIiwiaGVpZ2h0IiwiZm9ybWF0IiwiaGFzQWxwaGEiLCJjaGFubmVscyIsInN0YXJ0c1dpdGgiLCJleHRlbnNpb25Gcm9tTmFtZSIsInBvcCIsInRvTG93ZXJDYXNlIiwibWltZVR5cGVFeHRlbnNpb25zIiwiY2xlYW51cE9ycGhhbmVkRmlsZXMiLCJ0aGlydHlEYXlzQWdvIiwiRGF0ZSIsIm5vdyIsInRvSVNPU3RyaW5nIiwib3JwaGFuZWRGaWxlcyIsImx0Iiwibm90Il0sInNvdXJjZXMiOlsiQzpcXEFpIFByb2plY3RlblxcQURTYXBwXFxzcmNcXGxpYlxcbWVkaWFcXHN0b3JhZ2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmVyJ1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCdcbmltcG9ydCBzaGFycCBmcm9tICdzaGFycCdcblxuZXhwb3J0IGludGVyZmFjZSBNZWRpYUZpbGUge1xuICBpZDogc3RyaW5nXG4gIG9yaWdpbmFsTmFtZTogc3RyaW5nXG4gIG1pbWVUeXBlOiBzdHJpbmdcbiAgc2l6ZTogbnVtYmVyXG4gIHVybDogc3RyaW5nXG4gIHRodW1ibmFpbFVybD86IHN0cmluZ1xuICBvcmdhbml6YXRpb25JZDogc3RyaW5nXG4gIHVwbG9hZGVkQnk6IHN0cmluZ1xuICBtZXRhZGF0YT86IHtcbiAgICB3aWR0aD86IG51bWJlclxuICAgIGhlaWdodD86IG51bWJlclxuICAgIGR1cmF0aW9uPzogbnVtYmVyXG4gICAgW2tleTogc3RyaW5nXTogYW55XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBVcGxvYWRPcHRpb25zIHtcbiAgb3JnYW5pemF0aW9uSWQ6IHN0cmluZ1xuICB1cGxvYWRlZEJ5OiBzdHJpbmdcbiAgZ2VuZXJhdGVUaHVtYm5haWw/OiBib29sZWFuXG4gIG1heFNpemU/OiBudW1iZXIgLy8gaW4gYnl0ZXNcbiAgYWxsb3dlZFR5cGVzPzogc3RyaW5nW11cbn1cblxuZXhwb3J0IGNsYXNzIE1lZGlhU3RvcmFnZVNlcnZpY2Uge1xuICBwcml2YXRlIHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KClcbiAgcHJpdmF0ZSBidWNrZXROYW1lID0gJ21lZGlhJ1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoKVxuICB9XG5cbiAgYXN5bmMgdXBsb2FkRmlsZShcbiAgICBmaWxlOiBCdWZmZXIsXG4gICAgb3JpZ2luYWxOYW1lOiBzdHJpbmcsXG4gICAgbWltZVR5cGU6IHN0cmluZyxcbiAgICBvcHRpb25zOiBVcGxvYWRPcHRpb25zXG4gICk6IFByb21pc2U8TWVkaWFGaWxlPiB7XG4gICAgLy8gVmFsaWRhdGUgZmlsZSBzaXplXG4gICAgaWYgKG9wdGlvbnMubWF4U2l6ZSAmJiBmaWxlLmxlbmd0aCA+IG9wdGlvbnMubWF4U2l6ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlIHNpemUgZXhjZWVkcyBtYXhpbXVtIGFsbG93ZWQgc2l6ZSBvZiAke29wdGlvbnMubWF4U2l6ZX0gYnl0ZXNgKVxuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGZpbGUgdHlwZVxuICAgIGlmIChvcHRpb25zLmFsbG93ZWRUeXBlcyAmJiAhb3B0aW9ucy5hbGxvd2VkVHlwZXMuaW5jbHVkZXMobWltZVR5cGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGUgdHlwZSAke21pbWVUeXBlfSBpcyBub3QgYWxsb3dlZGApXG4gICAgfVxuXG4gICAgY29uc3QgZmlsZUlkID0gdXVpZHY0KClcbiAgICBjb25zdCBmaWxlRXh0ZW5zaW9uID0gdGhpcy5nZXRGaWxlRXh0ZW5zaW9uKG9yaWdpbmFsTmFtZSwgbWltZVR5cGUpXG4gICAgY29uc3QgZmlsZU5hbWUgPSBgJHtvcHRpb25zLm9yZ2FuaXphdGlvbklkfS8ke2ZpbGVJZH0ke2ZpbGVFeHRlbnNpb259YFxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFVwbG9hZCBvcmlnaW5hbCBmaWxlXG4gICAgICBjb25zdCB7IGRhdGE6IHVwbG9hZERhdGEsIGVycm9yOiB1cGxvYWRFcnJvciB9ID0gYXdhaXQgKGF3YWl0IHRoaXMuc3VwYWJhc2UpLnN0b3JhZ2VcbiAgICAgICAgLmZyb20odGhpcy5idWNrZXROYW1lKVxuICAgICAgICAudXBsb2FkKGZpbGVOYW1lLCBmaWxlLCB7XG4gICAgICAgICAgY29udGVudFR5cGU6IG1pbWVUeXBlLFxuICAgICAgICAgIGNhY2hlQ29udHJvbDogJzM2MDAnXG4gICAgICAgIH0pXG5cbiAgICAgIGlmICh1cGxvYWRFcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byB1cGxvYWQgZmlsZTogJHt1cGxvYWRFcnJvci5tZXNzYWdlfWApXG4gICAgICB9XG5cbiAgICAgIC8vIEdldCBwdWJsaWMgVVJMXG4gICAgICBjb25zdCB7IGRhdGE6IHVybERhdGEgfSA9IGF3YWl0IChhd2FpdCB0aGlzLnN1cGFiYXNlKS5zdG9yYWdlXG4gICAgICAgIC5mcm9tKHRoaXMuYnVja2V0TmFtZSlcbiAgICAgICAgLmdldFB1YmxpY1VybChmaWxlTmFtZSlcblxuICAgICAgbGV0IHRodW1ibmFpbFVybDogc3RyaW5nIHwgdW5kZWZpbmVkXG4gICAgICBsZXQgbWV0YWRhdGE6IGFueSA9IHt9XG5cbiAgICAgIC8vIEdlbmVyYXRlIHRodW1ibmFpbCBmb3IgaW1hZ2VzXG4gICAgICBpZiAob3B0aW9ucy5nZW5lcmF0ZVRodW1ibmFpbCAmJiB0aGlzLmlzSW1hZ2VUeXBlKG1pbWVUeXBlKSkge1xuICAgICAgICB0aHVtYm5haWxVcmwgPSBhd2FpdCB0aGlzLmdlbmVyYXRlVGh1bWJuYWlsKGZpbGUsIGZpbGVOYW1lLCBvcHRpb25zLm9yZ2FuaXphdGlvbklkKVxuICAgICAgICBtZXRhZGF0YSA9IGF3YWl0IHRoaXMuZ2V0SW1hZ2VNZXRhZGF0YShmaWxlKVxuICAgICAgfVxuXG4gICAgICAvLyBTdG9yZSBmaWxlIHJlY29yZCBpbiBkYXRhYmFzZVxuICAgICAgY29uc3QgbWVkaWFGaWxlOiBNZWRpYUZpbGUgPSB7XG4gICAgICAgIGlkOiBmaWxlSWQsXG4gICAgICAgIG9yaWdpbmFsTmFtZSxcbiAgICAgICAgbWltZVR5cGUsXG4gICAgICAgIHNpemU6IGZpbGUubGVuZ3RoLFxuICAgICAgICB1cmw6IHVybERhdGEucHVibGljVXJsLFxuICAgICAgICB0aHVtYm5haWxVcmwsXG4gICAgICAgIG9yZ2FuaXphdGlvbklkOiBvcHRpb25zLm9yZ2FuaXphdGlvbklkLFxuICAgICAgICB1cGxvYWRlZEJ5OiBvcHRpb25zLnVwbG9hZGVkQnksXG4gICAgICAgIG1ldGFkYXRhXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgZXJyb3I6IGRiRXJyb3IgfSA9IGF3YWl0IChhd2FpdCB0aGlzLnN1cGFiYXNlKVxuICAgICAgICAuZnJvbSgnbWVkaWFfZmlsZXMnKVxuICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICBpZDogZmlsZUlkLFxuICAgICAgICAgIG9yaWdpbmFsX25hbWU6IG9yaWdpbmFsTmFtZSxcbiAgICAgICAgICBtaW1lX3R5cGU6IG1pbWVUeXBlLFxuICAgICAgICAgIGZpbGVfc2l6ZTogZmlsZS5sZW5ndGgsXG4gICAgICAgICAgc3RvcmFnZV9wYXRoOiBmaWxlTmFtZSxcbiAgICAgICAgICB1cmw6IHVybERhdGEucHVibGljVXJsLFxuICAgICAgICAgIHRodW1ibmFpbF91cmw6IHRodW1ibmFpbFVybCxcbiAgICAgICAgICBvcmdhbml6YXRpb25faWQ6IG9wdGlvbnMub3JnYW5pemF0aW9uSWQsXG4gICAgICAgICAgdXBsb2FkZWRfYnk6IG9wdGlvbnMudXBsb2FkZWRCeSxcbiAgICAgICAgICBtZXRhZGF0YVxuICAgICAgICB9KVxuXG4gICAgICBpZiAoZGJFcnJvcikge1xuICAgICAgICAvLyBDbGVhbiB1cCB1cGxvYWRlZCBmaWxlIGlmIGRhdGFiYXNlIGluc2VydCBmYWlsc1xuICAgICAgICBhd2FpdCAoYXdhaXQgdGhpcy5zdXBhYmFzZSkuc3RvcmFnZS5mcm9tKHRoaXMuYnVja2V0TmFtZSkucmVtb3ZlKFtmaWxlTmFtZV0pXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHN0b3JlIGZpbGUgcmVjb3JkOiAke2RiRXJyb3IubWVzc2FnZX1gKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbWVkaWFGaWxlXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwbG9hZGluZyBmaWxlOicsIGVycm9yKVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRGaWxlKGZpbGVJZDogc3RyaW5nLCBvcmdhbml6YXRpb25JZDogc3RyaW5nKTogUHJvbWlzZTxNZWRpYUZpbGUgfCBudWxsPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgKGF3YWl0IHRoaXMuc3VwYWJhc2UpXG4gICAgICAuZnJvbSgnbWVkaWFfZmlsZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgZmlsZUlkKVxuICAgICAgLmVxKCdvcmdhbml6YXRpb25faWQnLCBvcmdhbml6YXRpb25JZClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yIHx8ICFkYXRhKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBpZDogZGF0YS5pZCxcbiAgICAgIG9yaWdpbmFsTmFtZTogZGF0YS5vcmlnaW5hbF9uYW1lLFxuICAgICAgbWltZVR5cGU6IGRhdGEubWltZV90eXBlLFxuICAgICAgc2l6ZTogZGF0YS5maWxlX3NpemUsXG4gICAgICB1cmw6IGRhdGEudXJsLFxuICAgICAgdGh1bWJuYWlsVXJsOiBkYXRhLnRodW1ibmFpbF91cmwsXG4gICAgICBvcmdhbml6YXRpb25JZDogZGF0YS5vcmdhbml6YXRpb25faWQsXG4gICAgICB1cGxvYWRlZEJ5OiBkYXRhLnVwbG9hZGVkX2J5LFxuICAgICAgbWV0YWRhdGE6IGRhdGEubWV0YWRhdGFcbiAgICB9XG4gIH1cblxuICBhc3luYyBkZWxldGVGaWxlKGZpbGVJZDogc3RyaW5nLCBvcmdhbml6YXRpb25JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuZ2V0RmlsZShmaWxlSWQsIG9yZ2FuaXphdGlvbklkKVxuICAgIGlmICghZmlsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIG5vdCBmb3VuZCcpXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEV4dHJhY3Qgc3RvcmFnZSBwYXRoIGZyb20gVVJMIG9yIGNvbnN0cnVjdCBpdFxuICAgICAgY29uc3Qgc3RvcmFnZVBhdGggPSBgJHtvcmdhbml6YXRpb25JZH0vJHtmaWxlSWR9JHt0aGlzLmdldEZpbGVFeHRlbnNpb24oZmlsZS5vcmlnaW5hbE5hbWUsIGZpbGUubWltZVR5cGUpfWBcblxuICAgICAgLy8gRGVsZXRlIGZyb20gc3RvcmFnZVxuICAgICAgY29uc3QgeyBlcnJvcjogc3RvcmFnZUVycm9yIH0gPSBhd2FpdCAoYXdhaXQgdGhpcy5zdXBhYmFzZSkuc3RvcmFnZVxuICAgICAgICAuZnJvbSh0aGlzLmJ1Y2tldE5hbWUpXG4gICAgICAgIC5yZW1vdmUoW3N0b3JhZ2VQYXRoXSlcblxuICAgICAgaWYgKHN0b3JhZ2VFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBmaWxlIGZyb20gc3RvcmFnZTonLCBzdG9yYWdlRXJyb3IpXG4gICAgICB9XG5cbiAgICAgIC8vIERlbGV0ZSB0aHVtYm5haWwgaWYgZXhpc3RzXG4gICAgICBpZiAoZmlsZS50aHVtYm5haWxVcmwpIHtcbiAgICAgICAgY29uc3QgdGh1bWJuYWlsUGF0aCA9IGAke29yZ2FuaXphdGlvbklkfS90aHVtYm5haWxzLyR7ZmlsZUlkfS5qcGdgXG4gICAgICAgIGF3YWl0IChhd2FpdCB0aGlzLnN1cGFiYXNlKS5zdG9yYWdlXG4gICAgICAgICAgLmZyb20odGhpcy5idWNrZXROYW1lKVxuICAgICAgICAgIC5yZW1vdmUoW3RodW1ibmFpbFBhdGhdKVxuICAgICAgfVxuXG4gICAgICAvLyBEZWxldGUgZnJvbSBkYXRhYmFzZVxuICAgICAgY29uc3QgeyBlcnJvcjogZGJFcnJvciB9ID0gYXdhaXQgKGF3YWl0IHRoaXMuc3VwYWJhc2UpXG4gICAgICAgIC5mcm9tKCdtZWRpYV9maWxlcycpXG4gICAgICAgIC5kZWxldGUoKVxuICAgICAgICAuZXEoJ2lkJywgZmlsZUlkKVxuICAgICAgICAuZXEoJ29yZ2FuaXphdGlvbl9pZCcsIG9yZ2FuaXphdGlvbklkKVxuXG4gICAgICBpZiAoZGJFcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBkZWxldGUgZmlsZSByZWNvcmQ6ICR7ZGJFcnJvci5tZXNzYWdlfWApXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGZpbGU6JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGxpc3RGaWxlcyhcbiAgICBvcmdhbml6YXRpb25JZDogc3RyaW5nLFxuICAgIG9wdGlvbnM/OiB7XG4gICAgICBsaW1pdD86IG51bWJlclxuICAgICAgb2Zmc2V0PzogbnVtYmVyXG4gICAgICBtaW1lVHlwZT86IHN0cmluZ1xuICAgICAgdXBsb2FkZWRCeT86IHN0cmluZ1xuICAgIH1cbiAgKTogUHJvbWlzZTx7IGZpbGVzOiBNZWRpYUZpbGVbXTsgdG90YWw6IG51bWJlciB9PiB7XG4gICAgbGV0IHF1ZXJ5ID0gKGF3YWl0IHRoaXMuc3VwYWJhc2UpXG4gICAgICAuZnJvbSgnbWVkaWFfZmlsZXMnKVxuICAgICAgLnNlbGVjdCgnKicsIHsgY291bnQ6ICdleGFjdCcgfSlcbiAgICAgIC5lcSgnb3JnYW5pemF0aW9uX2lkJywgb3JnYW5pemF0aW9uSWQpXG5cbiAgICBpZiAob3B0aW9ucz8ubWltZVR5cGUpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuaWxpa2UoJ21pbWVfdHlwZScsIGAke29wdGlvbnMubWltZVR5cGV9JWApXG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnM/LnVwbG9hZGVkQnkpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3VwbG9hZGVkX2J5Jywgb3B0aW9ucy51cGxvYWRlZEJ5KVxuICAgIH1cblxuICAgIGlmIChvcHRpb25zPy5saW1pdCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5saW1pdChvcHRpb25zLmxpbWl0KVxuICAgIH1cblxuICAgIGlmIChvcHRpb25zPy5vZmZzZXQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2Uob3B0aW9ucy5vZmZzZXQsIChvcHRpb25zLm9mZnNldCArIChvcHRpb25zLmxpbWl0IHx8IDIwKSkgLSAxKVxuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IsIGNvdW50IH0gPSBhd2FpdCBxdWVyeS5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBsaXN0IGZpbGVzOiAke2Vycm9yLm1lc3NhZ2V9YClcbiAgICB9XG5cbiAgICBjb25zdCBmaWxlcyA9IChkYXRhIHx8IFtdKS5tYXAoaXRlbSA9PiAoe1xuICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICBvcmlnaW5hbE5hbWU6IGl0ZW0ub3JpZ2luYWxfbmFtZSxcbiAgICAgIG1pbWVUeXBlOiBpdGVtLm1pbWVfdHlwZSxcbiAgICAgIHNpemU6IGl0ZW0uZmlsZV9zaXplLFxuICAgICAgdXJsOiBpdGVtLnVybCxcbiAgICAgIHRodW1ibmFpbFVybDogaXRlbS50aHVtYm5haWxfdXJsLFxuICAgICAgb3JnYW5pemF0aW9uSWQ6IGl0ZW0ub3JnYW5pemF0aW9uX2lkLFxuICAgICAgdXBsb2FkZWRCeTogaXRlbS51cGxvYWRlZF9ieSxcbiAgICAgIG1ldGFkYXRhOiBpdGVtLm1ldGFkYXRhXG4gICAgfSkpXG5cbiAgICByZXR1cm4ge1xuICAgICAgZmlsZXMsXG4gICAgICB0b3RhbDogY291bnQgfHwgMFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVUaHVtYm5haWwoXG4gICAgaW1hZ2VCdWZmZXI6IEJ1ZmZlcixcbiAgICBvcmlnaW5hbEZpbGVOYW1lOiBzdHJpbmcsXG4gICAgb3JnYW5pemF0aW9uSWQ6IHN0cmluZ1xuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0aHVtYm5haWxCdWZmZXIgPSBhd2FpdCBzaGFycChpbWFnZUJ1ZmZlcilcbiAgICAgICAgLnJlc2l6ZSgzMDAsIDMwMCwge1xuICAgICAgICAgIGZpdDogJ2luc2lkZScsXG4gICAgICAgICAgd2l0aG91dEVubGFyZ2VtZW50OiB0cnVlXG4gICAgICAgIH0pXG4gICAgICAgIC5qcGVnKHsgcXVhbGl0eTogODAgfSlcbiAgICAgICAgLnRvQnVmZmVyKClcblxuICAgICAgY29uc3QgZmlsZUlkID0gb3JpZ2luYWxGaWxlTmFtZS5zcGxpdCgnLycpWzFdLnNwbGl0KCcuJylbMF1cbiAgICAgIGNvbnN0IHRodW1ibmFpbFBhdGggPSBgJHtvcmdhbml6YXRpb25JZH0vdGh1bWJuYWlscy8ke2ZpbGVJZH0uanBnYFxuXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCAoYXdhaXQgdGhpcy5zdXBhYmFzZSkuc3RvcmFnZVxuICAgICAgICAuZnJvbSh0aGlzLmJ1Y2tldE5hbWUpXG4gICAgICAgIC51cGxvYWQodGh1bWJuYWlsUGF0aCwgdGh1bWJuYWlsQnVmZmVyLCB7XG4gICAgICAgICAgY29udGVudFR5cGU6ICdpbWFnZS9qcGVnJyxcbiAgICAgICAgICBjYWNoZUNvbnRyb2w6ICczNjAwJ1xuICAgICAgICB9KVxuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBsb2FkaW5nIHRodW1ibmFpbDonLCBlcnJvcilcbiAgICAgICAgcmV0dXJuICcnXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgZGF0YTogdXJsRGF0YSB9ID0gYXdhaXQgKGF3YWl0IHRoaXMuc3VwYWJhc2UpLnN0b3JhZ2VcbiAgICAgICAgLmZyb20odGhpcy5idWNrZXROYW1lKVxuICAgICAgICAuZ2V0UHVibGljVXJsKHRodW1ibmFpbFBhdGgpXG5cbiAgICAgIHJldHVybiB1cmxEYXRhLnB1YmxpY1VybFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIHRodW1ibmFpbDonLCBlcnJvcilcbiAgICAgIHJldHVybiAnJ1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0SW1hZ2VNZXRhZGF0YShpbWFnZUJ1ZmZlcjogQnVmZmVyKTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCBzaGFycChpbWFnZUJ1ZmZlcikubWV0YWRhdGEoKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2lkdGg6IG1ldGFkYXRhLndpZHRoLFxuICAgICAgICBoZWlnaHQ6IG1ldGFkYXRhLmhlaWdodCxcbiAgICAgICAgZm9ybWF0OiBtZXRhZGF0YS5mb3JtYXQsXG4gICAgICAgIGhhc0FscGhhOiBtZXRhZGF0YS5oYXNBbHBoYSxcbiAgICAgICAgY2hhbm5lbHM6IG1ldGFkYXRhLmNoYW5uZWxzXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgaW1hZ2UgbWV0YWRhdGE6JywgZXJyb3IpXG4gICAgICByZXR1cm4ge31cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGlzSW1hZ2VUeXBlKG1pbWVUeXBlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gbWltZVR5cGUuc3RhcnRzV2l0aCgnaW1hZ2UvJylcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RmlsZUV4dGVuc2lvbihmaWxlTmFtZTogc3RyaW5nLCBtaW1lVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBUcnkgdG8gZ2V0IGV4dGVuc2lvbiBmcm9tIGZpbGVuYW1lXG4gICAgY29uc3QgZXh0ZW5zaW9uRnJvbU5hbWUgPSBmaWxlTmFtZS5zcGxpdCgnLicpLnBvcCgpPy50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKGV4dGVuc2lvbkZyb21OYW1lICYmIGV4dGVuc2lvbkZyb21OYW1lLmxlbmd0aCA8PSA0KSB7XG4gICAgICByZXR1cm4gYC4ke2V4dGVuc2lvbkZyb21OYW1lfWBcbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjayB0byBtaW1lIHR5cGUgbWFwcGluZ1xuICAgIGNvbnN0IG1pbWVUeXBlRXh0ZW5zaW9uczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgICAgICdpbWFnZS9qcGVnJzogJy5qcGcnLFxuICAgICAgJ2ltYWdlL3BuZyc6ICcucG5nJyxcbiAgICAgICdpbWFnZS9naWYnOiAnLmdpZicsXG4gICAgICAnaW1hZ2Uvd2VicCc6ICcud2VicCcsXG4gICAgICAndmlkZW8vbXA0JzogJy5tcDQnLFxuICAgICAgJ3ZpZGVvL3F1aWNrdGltZSc6ICcubW92JyxcbiAgICAgICdhdWRpby9tcGVnJzogJy5tcDMnLFxuICAgICAgJ2F1ZGlvL29nZyc6ICcub2dnJyxcbiAgICAgICdhdWRpby93YXYnOiAnLndhdicsXG4gICAgICAnYXBwbGljYXRpb24vcGRmJzogJy5wZGYnLFxuICAgICAgJ3RleHQvcGxhaW4nOiAnLnR4dCcsXG4gICAgICAnYXBwbGljYXRpb24vanNvbic6ICcuanNvbidcbiAgICB9XG5cbiAgICByZXR1cm4gbWltZVR5cGVFeHRlbnNpb25zW21pbWVUeXBlXSB8fCAnJ1xuICB9XG5cbiAgYXN5bmMgY2xlYW51cE9ycGhhbmVkRmlsZXMob3JnYW5pemF0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIFRoaXMgbWV0aG9kIGNhbiBiZSBjYWxsZWQgcGVyaW9kaWNhbGx5IHRvIGNsZWFuIHVwIGZpbGVzIHRoYXQgYXJlIG5vIGxvbmdlciByZWZlcmVuY2VkXG4gICAgdHJ5IHtcbiAgICAgIC8vIEZpbmQgZmlsZXMgdGhhdCBoYXZlbid0IGJlZW4gYWNjZXNzZWQgaW4gMzAgZGF5cyBhbmQgYXJlbid0IHJlZmVyZW5jZWQgaW4gbWVzc2FnZXNcbiAgICAgIGNvbnN0IHRoaXJ0eURheXNBZ28gPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpXG5cbiAgICAgIGNvbnN0IHsgZGF0YTogb3JwaGFuZWRGaWxlcyB9ID0gYXdhaXQgKGF3YWl0IHRoaXMuc3VwYWJhc2UpXG4gICAgICAgIC5mcm9tKCdtZWRpYV9maWxlcycpXG4gICAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgICAgLmVxKCdvcmdhbml6YXRpb25faWQnLCBvcmdhbml6YXRpb25JZClcbiAgICAgICAgLmx0KCdjcmVhdGVkX2F0JywgdGhpcnR5RGF5c0FnbylcbiAgICAgICAgLm5vdCgnaWQnLCAnaW4nLCBgKFNFTEVDVCBESVNUSU5DVCBtZWRpYV9maWxlX2lkIEZST00gbWVzc2FnZXMgV0hFUkUgbWVkaWFfZmlsZV9pZCBJUyBOT1QgTlVMTClgKVxuXG4gICAgICBpZiAob3JwaGFuZWRGaWxlcykge1xuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2Ygb3JwaGFuZWRGaWxlcykge1xuICAgICAgICAgIGF3YWl0IHRoaXMuZGVsZXRlRmlsZShmaWxlLmlkLCBvcmdhbml6YXRpb25JZClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjbGVhbmluZyB1cCBvcnBoYW5lZCBmaWxlczonLCBlcnJvcilcbiAgICB9XG4gIH1cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7K0JBNkJhOzs7Ozs7V0FBQUEsbUJBQUE7Ozs7O2tDQTdCZ0I7OztrQ0FDQTs7O3dFQUNYOzs7Ozs7Ozs7Ozs7Ozs7QUEyQlgsTUFBTUEsbUJB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