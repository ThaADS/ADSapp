{"version":3,"names":["cov_17c1b8yras","actualCoverage","s","POST","request","f","_user","_auth","requireAuth","body","json","format","dateRange","metrics","organizationId","b","_server","NextResponse","error","status","includes","exporter","_analyticsexport","AnalyticsExporter","exportResult","exportData","content","headers","mimeType","filename","console"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\analytics\\export\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { requireAuth } from '@/lib/auth'\nimport { AnalyticsExporter } from '@/lib/export/analytics-export'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const _user = await requireAuth() // TODO: Use user for authorization checks\n    const body = await request.json()\n    \n    const { format, dateRange, metrics, organizationId } = body\n\n    // Validate required fields\n    if (!format || !dateRange || !metrics || !organizationId) {\n      return NextResponse.json(\n        { error: 'Missing required fields' },\n        { status: 400 }\n      )\n    }\n\n    // Validate format\n    if (!['csv', 'excel', 'pdf'].includes(format)) {\n      return NextResponse.json(\n        { error: 'Invalid export format' },\n        { status: 400 }\n      )\n    }\n\n    // Create exporter and export data\n    const exporter = new AnalyticsExporter()\n    const exportResult = await exporter.exportData({\n      format,\n      dateRange,\n      metrics,\n      organizationId\n    })\n\n    // Return file download response\n    return new NextResponse(exportResult.content, {\n      status: 200,\n      headers: {\n        'Content-Type': exportResult.mimeType,\n        'Content-Disposition': `attachment; filename=\"${exportResult.filename}\"`,\n        'Cache-Control': 'no-cache'\n      }\n    })\n\n  } catch (error) {\n    console.error('Export error:', error)\n    return NextResponse.json(\n      { error: 'Export failed' },\n      { status: 500 }\n    )\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMI;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;+BAFkB;;;;;;WAAAC,IAAA;;;;;kCAJoB;;;kCACd;;;kCACM;AAE3B,eAAeA,KAAKC,OAAoB;EAAA;EAAAJ,cAAA,GAAAK,CAAA;EAAAL,cAAA,GAAAE,CAAA;EAC7C,IAAI;IACF,MAAMI,KAAA;IAAA;IAAA,CAAAN,cAAA,GAAAE,CAAA,OAAQ,MAAM,IAAAK,KAAA,CAAAC,WAAW,KAAG;IAAA;IAClC,MAAMC,IAAA;IAAA;IAAA,CAAAT,cAAA,GAAAE,CAAA,OAAO,MAAME,OAAA,CAAQM,IAAI;IAE/B,MAAM;MAAEC,MAAM;MAAEC,SAAS;MAAEC,OAAO;MAAEC;IAAc,CAAE;IAAA;IAAA,CAAAd,cAAA,GAAAE,CAAA,OAAGO,IAAA;IAEvD;IAAA;IAAAT,cAAA,GAAAE,CAAA;IACA;IAAI;IAAA,CAAAF,cAAA,GAAAe,CAAA,WAACJ,MAAA;IAAA;IAAA,CAAAX,cAAA,GAAAe,CAAA,UAAU,CAACH,SAAA;IAAA;IAAA,CAAAZ,cAAA,GAAAe,CAAA,UAAa,CAACF,OAAA;IAAA;IAAA,CAAAb,cAAA,GAAAe,CAAA,UAAW,CAACD,cAAA,GAAgB;MAAA;MAAAd,cAAA,GAAAe,CAAA;MAAAf,cAAA,GAAAE,CAAA;MACxD,OAAOc,OAAA,CAAAC,YAAY,CAACP,IAAI,CACtB;QAAEQ,KAAA,EAAO;MAA0B,GACnC;QAAEC,MAAA,EAAQ;MAAI;IAElB;IAAA;IAAA;MAAAnB,cAAA,GAAAe,CAAA;IAAA;IAEA;IAAAf,cAAA,GAAAE,CAAA;IACA,IAAI,CAAC,CAAC,OAAO,SAAS,MAAM,CAACkB,QAAQ,CAACT,MAAA,GAAS;MAAA;MAAAX,cAAA,GAAAe,CAAA;MAAAf,cAAA,GAAAE,CAAA;MAC7C,OAAOc,OAAA,CAAAC,YAAY,CAACP,IAAI,CACtB;QAAEQ,KAAA,EAAO;MAAwB,GACjC;QAAEC,MAAA,EAAQ;MAAI;IAElB;IAAA;IAAA;MAAAnB,cAAA,GAAAe,CAAA;IAAA;IAEA;IACA,MAAMM,QAAA;IAAA;IAAA,CAAArB,cAAA,GAAAE,CAAA,QAAW,IAAIoB,gBAAA,CAAAC,iBAAiB;IACtC,MAAMC,YAAA;IAAA;IAAA,CAAAxB,cAAA,GAAAE,CAAA,QAAe,MAAMmB,QAAA,CAASI,UAAU,CAAC;MAC7Cd,MAAA;MACAC,SAAA;MACAC,OAAA;MACAC;IACF;IAEA;IAAA;IAAAd,cAAA,GAAAE,CAAA;IACA,OAAO,IAAIc,OAAA,CAAAC,YAAY,CAACO,YAAA,CAAaE,OAAO,EAAE;MAC5CP,MAAA,EAAQ;MACRQ,OAAA,EAAS;QACP,gBAAgBH,YAAA,CAAaI,QAAQ;QACrC,uBAAuB,yBAAyBJ,YAAA,CAAaK,QAAQ,GAAG;QACxE,iBAAiB;MACnB;IACF;EAEF,EAAE,OAAOX,KAAA,EAAO;IAAA;IAAAlB,cAAA,GAAAE,CAAA;IACd4B,OAAA,CAAQZ,KAAK,CAAC,iBAAiBA,KAAA;IAAA;IAAAlB,cAAA,GAAAE,CAAA;IAC/B,OAAOc,OAAA,CAAAC,YAAY,CAACP,IAAI,CACtB;MAAEQ,KAAA,EAAO;IAAgB,GACzB;MAAEC,MAAA,EAAQ;IAAI;EAElB;AACF","ignoreList":[]}