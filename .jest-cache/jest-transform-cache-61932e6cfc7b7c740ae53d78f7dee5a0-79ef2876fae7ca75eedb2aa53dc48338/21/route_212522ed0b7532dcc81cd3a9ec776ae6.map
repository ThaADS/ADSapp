{"version":3,"names":["cov_2aiwt8fpzm","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","undefined","s","f","b","inputSourceMap","version","sources","sourcesContent","names","mappings","_coverageSchema","coverage","actualCoverage","POST","request","supabase","_server1","createClient","data","user","error","authError","auth","getUser","_server","NextResponse","json","status","profile","profileError","from","select","eq","id","single","body","paymentIntentId","paymentMethodId","returnUrl","paymentIntent","piError","organization_id","paymentIntentManager","_paymentintentmanager","PaymentIntentManager","result","confirmPaymentIntent","process","env","NEXT_PUBLIC_APP_URL","success","authenticationRequired","nextAction","errorCode","err","console","message"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\billing\\payment-intent\\confirm\\route.ts"],"sourcesContent":["/**\n * Payment Intent Confirm API (S-002)\n * ====================================\n * Confirm payment intent after 3D Secure authentication completion.\n *\n * POST /api/billing/payment-intent/confirm - Confirm payment intent\n *\n * Security: Authenticated users only\n * Compliance: PCI DSS, PSD2 SCA requirements\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { createClient } from '@/lib/supabase/server';\nimport { PaymentIntentManager } from '@/lib/billing/payment-intent-manager';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const supabase = await createClient();\n\n    // 1. Authenticate user\n    const { data: { user }, error: authError } = await supabase.auth.getUser();\n    if (authError || !user) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      );\n    }\n\n    // 2. Get user's organization\n    const { data: profile, error: profileError } = await supabase\n      .from('profiles')\n      .select('organization_id')\n      .eq('id', user.id)\n      .single();\n\n    if (profileError || !profile) {\n      return NextResponse.json(\n        { error: 'User profile not found' },\n        { status: 404 }\n      );\n    }\n\n    // 3. Parse and validate request body\n    const body = await request.json();\n\n    const {\n      paymentIntentId,\n      paymentMethodId,\n      returnUrl,\n    } = body;\n\n    // Validate required fields\n    if (!paymentIntentId) {\n      return NextResponse.json(\n        { error: 'paymentIntentId is required' },\n        { status: 400 }\n      );\n    }\n\n    // 4. Verify payment intent belongs to user's organization\n    const { data: paymentIntent, error: piError } = await supabase\n      .from('payment_intents')\n      .select('organization_id')\n      .eq('id', paymentIntentId)\n      .single();\n\n    if (piError || !paymentIntent) {\n      return NextResponse.json(\n        { error: 'Payment intent not found' },\n        { status: 404 }\n      );\n    }\n\n    if (paymentIntent.organization_id !== profile.organization_id) {\n      return NextResponse.json(\n        { error: 'Forbidden: Payment intent belongs to different organization' },\n        { status: 403 }\n      );\n    }\n\n    // 5. Confirm payment intent\n    const paymentIntentManager = new PaymentIntentManager();\n\n    const result = await paymentIntentManager.confirmPaymentIntent({\n      paymentIntentId,\n      paymentMethodId,\n      returnUrl: returnUrl || `${process.env.NEXT_PUBLIC_APP_URL}/dashboard/settings/billing`,\n    });\n\n    // 6. Return result\n    if (result.status === 'succeeded' || result.status === 'requires_action') {\n      return NextResponse.json({\n        success: true,\n        paymentIntent: {\n          id: result.paymentIntentId,\n          status: result.status,\n          authenticationRequired: result.authenticationRequired,\n          nextAction: result.nextAction,\n        },\n      });\n    } else {\n      return NextResponse.json({\n        success: false,\n        error: result.error,\n        errorCode: result.errorCode,\n      }, { status: 400 });\n    }\n  } catch (error) {\n    const err = error as Error;\n    console.error('Payment intent confirmation API error:', err);\n\n    return NextResponse.json(\n      {\n        error: 'Internal server error',\n        message: err.message,\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"mappings":"AAAA;;;;;;;;;GASC;;AAAA;AAAA,SAAAA,eAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,MAAA,OAAAC,QAAA;EAAA,IAAAC,GAAA;EAAA,IAAAC,YAAA;IAAAL,IAAA;IAAAM,YAAA;MAAA;QAAAC,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,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","ignoreList":[]}