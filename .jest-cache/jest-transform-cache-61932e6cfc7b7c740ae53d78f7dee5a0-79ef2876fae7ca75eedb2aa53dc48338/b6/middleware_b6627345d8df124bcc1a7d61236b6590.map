{"version":3,"names":["SecurityMiddleware","cov_2nwnrol9ci","f","s","apiSecurityMiddleware","defaultSecurityMiddleware","generateCsrfToken","generateSecureToken","strictSecurityMiddleware","validateCsrfToken","withSecurity","defaultOptions","enableDdosProtection","enableInputValidation","enableRequestLogging","enableIpWhitelisting","allowedIps","blockedIps","maxRequestSize","constructor","options","b","handle","request","sizeCheck","checkRequestSize","ipCheck","checkIpSecurity","ddosCheck","_ratelimit","ddosProtection","inputCheck","checkInputSecurity","logRequest","error","console","_server","NextResponse","json","status","contentLength","headers","get","size","parseInt","ip","getClientIp","includes","length","hasMaliciousUrl","url","logSecurityEvent","maliciousHeader","checkMaliciousHeaders","header","method","bodyCheck","checkRequestBody","maliciousPatterns","some","pattern","test","dangerousHeaders","value","_validation","hasSqlInjection","hasXss","contentType","clonedRequest","clone","text","sample","substring","suspiciousPatterns","warn","forwarded","realIp","cfConnectingIp","split","logData","timestamp","Date","toISOString","userAgent","referer","process","env","NODE_ENV","sendToLoggingService","log","eventType","additionalData","securityEvent","type","sendToSecurityService","data","LOGGING_ENDPOINT","fetch","LOGGING_API_KEY","body","JSON","stringify","event","SECURITY_ENDPOINT","SECURITY_API_KEY","window","Sentry","Promise","resolve","then","_interop_require_wildcard","require","addBreadcrumb","message","level","middleware","crypto","randomUUID","token","expectedToken","chars","result","randomArray","Uint8Array","getRandomValues","i","charAt"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\lib\\security\\middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createRateLimit, ddosProtection } from './rate-limit'\nimport { hasSqlInjection, hasXss } from './validation'\n\nexport interface SecurityOptions {\n  enableDdosProtection?: boolean\n  enableInputValidation?: boolean\n  enableRequestLogging?: boolean\n  enableIpWhitelisting?: boolean\n  allowedIps?: string[]\n  blockedIps?: string[]\n  maxRequestSize?: number\n}\n\nconst defaultOptions: SecurityOptions = {\n  enableDdosProtection: true,\n  enableInputValidation: true,\n  enableRequestLogging: true,\n  enableIpWhitelisting: false,\n  allowedIps: [],\n  blockedIps: [],\n  maxRequestSize: 10 * 1024 * 1024, // 10MB\n}\n\nexport class SecurityMiddleware {\n  private options: SecurityOptions\n\n  constructor(options: Partial<SecurityOptions> = {}) {\n    this.options = { ...defaultOptions, ...options }\n  }\n\n  async handle(request: NextRequest): Promise<NextResponse | null> {\n    try {\n      // 1. Check request size\n      const sizeCheck = this.checkRequestSize(request)\n      if (sizeCheck) return sizeCheck\n\n      // 2. IP-based security checks\n      const ipCheck = this.checkIpSecurity(request)\n      if (ipCheck) return ipCheck\n\n      // 3. DDoS protection\n      if (this.options.enableDdosProtection) {\n        const ddosCheck = await ddosProtection(request)\n        if (ddosCheck) return ddosCheck\n      }\n\n      // 4. Input validation\n      if (this.options.enableInputValidation) {\n        const inputCheck = await this.checkInputSecurity(request)\n        if (inputCheck) return inputCheck\n      }\n\n      // 5. Request logging\n      if (this.options.enableRequestLogging) {\n        this.logRequest(request)\n      }\n\n      return null // Continue to next middleware\n    } catch (error) {\n      console.error('Security middleware error:', error)\n      return NextResponse.json(\n        { error: 'Security check failed' },\n        { status: 500 }\n      )\n    }\n  }\n\n  private checkRequestSize(request: NextRequest): NextResponse | null {\n    const contentLength = request.headers.get('content-length')\n    if (contentLength) {\n      const size = parseInt(contentLength, 10)\n      if (size > (this.options.maxRequestSize || defaultOptions.maxRequestSize!)) {\n        return NextResponse.json(\n          { error: 'Request too large' },\n          { status: 413 }\n        )\n      }\n    }\n    return null\n  }\n\n  private checkIpSecurity(request: NextRequest): NextResponse | null {\n    const ip = this.getClientIp(request)\n\n    // Check blocked IPs\n    if (this.options.blockedIps?.includes(ip)) {\n      return NextResponse.json(\n        { error: 'Access denied' },\n        { status: 403 }\n      )\n    }\n\n    // Check whitelist if enabled\n    if (this.options.enableIpWhitelisting && this.options.allowedIps?.length) {\n      if (!this.options.allowedIps.includes(ip)) {\n        return NextResponse.json(\n          { error: 'Access denied' },\n          { status: 403 }\n        )\n      }\n    }\n\n    return null\n  }\n\n  private async checkInputSecurity(request: NextRequest): Promise<NextResponse | null> {\n    try {\n      // Check URL for malicious patterns\n      if (this.hasMaliciousUrl(request.url)) {\n        this.logSecurityEvent('malicious_url', request, { url: request.url })\n        return NextResponse.json(\n          { error: 'Invalid request' },\n          { status: 400 }\n        )\n      }\n\n      // Check headers for malicious content\n      const maliciousHeader = this.checkMaliciousHeaders(request)\n      if (maliciousHeader) {\n        this.logSecurityEvent('malicious_header', request, { header: maliciousHeader })\n        return NextResponse.json(\n          { error: 'Invalid request headers' },\n          { status: 400 }\n        )\n      }\n\n      // Check request body for malicious content\n      if (request.method === 'POST' || request.method === 'PUT' || request.method === 'PATCH') {\n        const bodyCheck = await this.checkRequestBody(request)\n        if (bodyCheck) return bodyCheck\n      }\n\n      return null\n    } catch (error) {\n      console.error('Input validation error:', error)\n      return null // Allow request to proceed on validation errors\n    }\n  }\n\n  private hasMaliciousUrl(url: string): boolean {\n    const maliciousPatterns = [\n      // Path traversal\n      /\\.\\.\\//g,\n      /\\.\\.\\\\\\\\/g,\n      /%2e%2e%2f/gi,\n      /%2e%2e%5c/gi,\n\n      // SQL injection in URL\n      /union.*select/gi,\n      /select.*from/gi,\n      /insert.*into/gi,\n      /delete.*from/gi,\n      /drop.*table/gi,\n\n      // XSS in URL\n      /<script/gi,\n      /javascript:/gi,\n      /on\\w+=/gi,\n\n      // Command injection\n      /;.*cat/gi,\n      /;.*ls/gi,\n      /;.*curl/gi,\n      /;.*wget/gi,\n    ]\n\n    return maliciousPatterns.some(pattern => pattern.test(url))\n  }\n\n  private checkMaliciousHeaders(request: NextRequest): string | null {\n    const dangerousHeaders = [\n      'x-forwarded-host',\n      'x-original-url',\n      'x-rewrite-url',\n    ]\n\n    for (const header of dangerousHeaders) {\n      const value = request.headers.get(header)\n      if (value && (hasSqlInjection(value) || hasXss(value))) {\n        return header\n      }\n    }\n\n    return null\n  }\n\n  private async checkRequestBody(request: NextRequest): Promise<NextResponse | null> {\n    try {\n      const contentType = request.headers.get('content-type')\n\n      if (contentType?.includes('application/json')) {\n        // Clone request to avoid consuming the body\n        const clonedRequest = request.clone()\n        const text = await clonedRequest.text()\n\n        if (text.length > 0) {\n          // Check for malicious JSON content\n          if (hasSqlInjection(text) || hasXss(text)) {\n            this.logSecurityEvent('malicious_json_body', request, {\n              contentLength: text.length,\n              sample: text.substring(0, 100)\n            })\n            return NextResponse.json(\n              { error: 'Invalid request content' },\n              { status: 400 }\n            )\n          }\n\n          // Check for suspicious patterns in JSON\n          const suspiciousPatterns = [\n            /__proto__/g,\n            /constructor/g,\n            /prototype/g,\n            /eval\\(/g,\n            /function\\(/g,\n          ]\n\n          if (suspiciousPatterns.some(pattern => pattern.test(text))) {\n            this.logSecurityEvent('suspicious_json_content', request)\n            return NextResponse.json(\n              { error: 'Invalid request content' },\n              { status: 400 }\n            )\n          }\n        }\n      }\n\n      return null\n    } catch (error) {\n      // If we can't parse the body, log but don't block\n      console.warn('Failed to check request body:', error)\n      return null\n    }\n  }\n\n  private getClientIp(request: NextRequest): string {\n    const forwarded = request.headers.get('x-forwarded-for')\n    const realIp = request.headers.get('x-real-ip')\n    const cfConnectingIp = request.headers.get('cf-connecting-ip')\n\n    return cfConnectingIp || forwarded?.split(',')[0] || realIp || 'unknown'\n  }\n\n  private logRequest(request: NextRequest): void {\n    const logData = {\n      timestamp: new Date().toISOString(),\n      method: request.method,\n      url: request.url,\n      ip: this.getClientIp(request),\n      userAgent: request.headers.get('user-agent'),\n      referer: request.headers.get('referer'),\n      contentLength: request.headers.get('content-length'),\n    }\n\n    // In production, send to logging service\n    if (process.env.NODE_ENV === 'production') {\n      // Send to your logging service (Datadog, CloudWatch, etc.)\n      this.sendToLoggingService('request', logData)\n    } else {\n      console.log('Request:', logData)\n    }\n  }\n\n  private logSecurityEvent(\n    eventType: string,\n    request: NextRequest,\n    additionalData?: any\n  ): void {\n    const securityEvent = {\n      timestamp: new Date().toISOString(),\n      type: eventType,\n      ip: this.getClientIp(request),\n      method: request.method,\n      url: request.url,\n      userAgent: request.headers.get('user-agent'),\n      referer: request.headers.get('referer'),\n      ...additionalData,\n    }\n\n    // Always log security events\n    console.warn('Security Event:', securityEvent)\n\n    // Send to security monitoring service\n    this.sendToSecurityService(securityEvent)\n  }\n\n  private async sendToLoggingService(type: string, data: any): Promise<void> {\n    try {\n      // Send to external logging service\n      if (process.env.LOGGING_ENDPOINT) {\n        await fetch(process.env.LOGGING_ENDPOINT, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${process.env.LOGGING_API_KEY}`,\n          },\n          body: JSON.stringify({ type, data }),\n        })\n      }\n    } catch (error) {\n      console.error('Failed to send log:', error)\n    }\n  }\n\n  private async sendToSecurityService(event: any): Promise<void> {\n    try {\n      // Send to security monitoring service\n      if (process.env.SECURITY_ENDPOINT) {\n        await fetch(process.env.SECURITY_ENDPOINT, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${process.env.SECURITY_API_KEY}`,\n          },\n          body: JSON.stringify(event),\n        })\n      }\n\n      // Also send to Sentry for critical events\n      if (typeof window === 'undefined') {\n        const Sentry = await import('@sentry/nextjs')\n        Sentry.addBreadcrumb({\n          message: `Security event: ${event.type}`,\n          level: 'warning',\n          data: event,\n        })\n      }\n    } catch (error) {\n      console.error('Failed to send security event:', error)\n    }\n  }\n}\n\n// Pre-configured security middleware instances\nexport const defaultSecurityMiddleware = new SecurityMiddleware()\n\nexport const strictSecurityMiddleware = new SecurityMiddleware({\n  enableDdosProtection: true,\n  enableInputValidation: true,\n  enableRequestLogging: true,\n  maxRequestSize: 1 * 1024 * 1024, // 1MB\n})\n\nexport const apiSecurityMiddleware = new SecurityMiddleware({\n  enableDdosProtection: true,\n  enableInputValidation: true,\n  enableRequestLogging: true,\n  maxRequestSize: 5 * 1024 * 1024, // 5MB\n})\n\n// Helper function to apply security middleware\nexport async function withSecurity(\n  request: NextRequest,\n  options?: Partial<SecurityOptions>\n): Promise<NextResponse | null> {\n  const middleware = new SecurityMiddleware(options)\n  return middleware.handle(request)\n}\n\n// CSRF Protection\nexport function generateCsrfToken(): string {\n  return crypto.randomUUID()\n}\n\nexport function validateCsrfToken(token: string, expectedToken: string): boolean {\n  return token === expectedToken\n}\n\n// Secure random string generation\nexport function generateSecureToken(length: number = 32): string {\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\n  let result = ''\n  const randomArray = new Uint8Array(length)\n  crypto.getRandomValues(randomArray)\n\n  for (let i = 0; i < length; i++) {\n    result += chars.charAt(randomArray[i] % chars.length)\n  }\n\n  return result\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}