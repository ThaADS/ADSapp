{"version":3,"names":["GET","cov_2mi2jml5s3","f","s","POST","request","user","_apiutils","requireAuthenticatedUser","profile","getUserOrganization","id","searchParams","URL","url","reportType","b","get","startDate","endDate","format","_server","NextResponse","json","error","status","supabase","_server1","createClient","reportData","generateConversationsReport","organization_id","generateMessagesReport","generateAgentsReport","generateContactsReport","generatePerformanceReport","csv","convertToCSV","Array","isArray","headers","createSuccessResponse","dateRange","generatedAt","Date","toISOString","data","console","createErrorResponse","body","filters","scheduling","message","note","organizationId","conversations","from","select","eq","gte","lte","order","ascending","map","conv","messages","firstResponse","find","m","sender_type","responseTime","created_at","getTime","contactName","contacts","name","contactPhone","phone_number","assignedAgent","profiles","full_name","priority","messageCount","length","responseTimeMinutes","Math","round","createdAt","lastMessageAt","last_message_at","msg","content","substring","type","message_type","senderType","senderName","agents","agent","Set","filter","Boolean","email","role","messagesSent","conversationsHandled","size","avgMessagesPerConversation","contact","totalMessages","reduce","sum","phoneNumber","tags","conversationsCount","lastContactAt","messagesData","conversationsData","agentsData","Promise","all","activeAgents","inboundMessages","outboundMessages","resolvedConversations","c","resolutionRate","summary","totalConversations","dailyBreakdown","generateDailyBreakdown","start","end","breakdown","d","setDate","getDate","dayStr","split","dayMessages","startsWith","dayConversations","push","date","inbound","outbound","resolved","dataArray","Object","keys","csvRows","join","row","header","value","includes","replace","queueReportGeneration","_reportId"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\analytics\\reports\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { requireAuthenticatedUser, getUserOrganization, createErrorResponse, createSuccessResponse } from '@/lib/api-utils'\nimport { createClient } from '@/lib/supabase/server'\nimport { SupabaseClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database'\n\ntype TypedSupabaseClient = SupabaseClient<Database>\n\nexport async function GET(request: NextRequest) {\n  try {\n    // Authenticate user\n    const user = await requireAuthenticatedUser()\n    const profile = await getUserOrganization(user.id)\n\n    const { searchParams } = new URL(request.url)\n    const reportType = searchParams.get('type') || 'conversations'\n    const startDate = searchParams.get('startDate')\n    const endDate = searchParams.get('endDate')\n    const format = searchParams.get('format') || 'json'\n\n    if (!startDate || !endDate) {\n      return NextResponse.json(\n        { error: 'Start date and end date are required' },\n        { status: 400 }\n      )\n    }\n\n    const supabase = await createClient()\n    let reportData: Record<string, unknown> | unknown[]\n\n    switch (reportType) {\n      case 'conversations':\n        reportData = await generateConversationsReport(supabase, profile.organization_id!, startDate, endDate)\n        break\n      case 'messages':\n        reportData = await generateMessagesReport(supabase, profile.organization_id!, startDate, endDate)\n        break\n      case 'agents':\n        reportData = await generateAgentsReport(supabase, profile.organization_id!, startDate, endDate)\n        break\n      case 'contacts':\n        reportData = await generateContactsReport(supabase, profile.organization_id!, startDate, endDate)\n        break\n      case 'performance':\n        reportData = await generatePerformanceReport(supabase, profile.organization_id!, startDate, endDate)\n        break\n      default:\n        return NextResponse.json(\n          { error: 'Invalid report type' },\n          { status: 400 }\n        )\n    }\n\n    if (format === 'csv') {\n      const csv = convertToCSV(Array.isArray(reportData) ? reportData : [reportData])\n      return new NextResponse(csv, {\n        headers: {\n          'Content-Type': 'text/csv',\n          'Content-Disposition': `attachment; filename=\"${reportType}-report-${startDate}-to-${endDate}.csv\"`\n        }\n      })\n    }\n\n    return createSuccessResponse({\n      reportType,\n      dateRange: { startDate, endDate },\n      generatedAt: new Date().toISOString(),\n      data: reportData\n    })\n\n  } catch (error) {\n    console.error('Analytics reports error:', error)\n    return createErrorResponse(error)\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    // Authenticate user\n    const user = await requireAuthenticatedUser()\n    const profile = await getUserOrganization(user.id)\n\n    const body = await request.json()\n    const { reportType, startDate, endDate, filters, scheduling } = body\n\n    if (!reportType || !startDate || !endDate) {\n      return NextResponse.json(\n        { error: 'Report type, start date, and end date are required' },\n        { status: 400 }\n      )\n    }\n\n    const supabase = await createClient()\n\n    // TODO WEEK 5+: Create scheduled_reports table for recurring reports\n    // For now, generate reports immediately\n    return createSuccessResponse({\n      message: 'Report scheduling feature not yet implemented - generating report immediately',\n      reportType,\n      startDate,\n      endDate,\n      note: 'Scheduled reports table not yet created. Use GET endpoint to generate reports on-demand.'\n    }, 201)\n\n    // Create scheduled report - COMMENTED OUT until scheduled_reports table is created\n    // const { data: scheduledReport, error } = await supabase\n    //   .from('scheduled_reports')\n    //   .insert({\n    //     organization_id: profile.organization_id!,\n    //     created_by: user.id,\n    //     report_type: reportType,\n    //     start_date: startDate,\n    //     end_date: endDate,\n    //     filters: filters || {},\n    //     scheduling: scheduling || { frequency: 'once' },\n    //     status: 'pending',\n    //     created_at: new Date().toISOString()\n    //   })\n    //   .select()\n    //   .single()\n\n    // if (error) {\n    //   throw error\n    // }\n\n    // // If it's a one-time report, generate it immediately\n    // if (!scheduling || scheduling.frequency === 'once') {\n    //   // Queue for immediate processing\n    //   await queueReportGeneration(scheduledReport.id)\n    // }\n\n    // return createSuccessResponse({\n    //   report: scheduledReport,\n    //   message: scheduling?.frequency === 'once'\n    //     ? 'Report queued for generation'\n    //     : 'Report scheduled successfully'\n    // }, 201)\n\n  } catch (error) {\n    console.error('Schedule report error:', error)\n    return createErrorResponse(error)\n  }\n}\n\nasync function generateConversationsReport(supabase: TypedSupabaseClient, organizationId: string, startDate: string, endDate: string): Promise<unknown[]> {\n  const { data: conversations } = await supabase\n    .from('conversations')\n    .select(`\n      id,\n      status,\n      priority,\n      created_at,\n      last_message_at,\n      contacts (\n        name,\n        phone_number\n      ),\n      profiles (\n        full_name\n      ),\n      messages (\n        id,\n        sender_type,\n        created_at\n      )\n    `)\n    .eq('organization_id', organizationId)\n    .gte('created_at', startDate)\n    .lte('created_at', endDate)\n    .order('created_at', { ascending: false })\n\n  return (conversations || []).map(conv => {\n    const messages = conv.messages || []\n    const firstResponse = messages.find(m => m.sender_type === 'agent')\n    const responseTime = firstResponse\n      ? new Date(firstResponse.created_at).getTime() - new Date(conv.created_at).getTime()\n      : null\n\n    return {\n      id: conv.id,\n      contactName: (conv.contacts as { name?: string } | null)?.name || 'Unknown',\n      contactPhone: (conv.contacts as { phone_number?: string } | null)?.phone_number,\n      assignedAgent: (conv.profiles as { full_name?: string } | null)?.full_name || 'Unassigned',\n      status: conv.status,\n      priority: conv.priority,\n      messageCount: messages.length,\n      responseTimeMinutes: responseTime ? Math.round(responseTime / (1000 * 60)) : null,\n      createdAt: conv.created_at,\n      lastMessageAt: conv.last_message_at\n    }\n  })\n}\n\nasync function generateMessagesReport(supabase: TypedSupabaseClient, organizationId: string, startDate: string, endDate: string): Promise<unknown[]> {\n  const { data: messages } = await supabase\n    .from('messages')\n    .select(`\n      id,\n      content,\n      message_type,\n      sender_type,\n      created_at,\n      conversations (\n        contacts (\n          name,\n          phone_number\n        )\n      ),\n      profiles (\n        full_name\n      )\n    `)\n    .eq('organization_id', organizationId)\n    .gte('created_at', startDate)\n    .lte('created_at', endDate)\n    .order('created_at', { ascending: false })\n\n  return (messages || []).map(msg => ({\n    id: msg.id,\n    content: msg.content.substring(0, 100) + (msg.content.length > 100 ? '...' : ''),\n    type: msg.message_type,\n    senderType: msg.sender_type,\n    senderName: (msg.profiles as { full_name?: string } | null)?.full_name || 'System',\n    contactName: (msg.conversations as { contacts?: { name?: string } } | null)?.contacts?.name || 'Unknown',\n    contactPhone: (msg.conversations as { contacts?: { phone_number?: string } } | null)?.contacts?.phone_number,\n    createdAt: msg.created_at\n  }))\n}\n\nasync function generateAgentsReport(supabase: TypedSupabaseClient, organizationId: string, startDate: string, endDate: string): Promise<unknown[]> {\n  const { data: agents } = await supabase\n    .from('profiles')\n    .select(`\n      id,\n      full_name,\n      email,\n      role,\n      messages!inner (\n        id,\n        created_at,\n        conversations (\n          id\n        )\n      )\n    `)\n    .eq('organization_id', organizationId)\n    .gte('messages.created_at', startDate)\n    .lte('messages.created_at', endDate)\n\n  return (agents || []).map(agent => {\n    const messages = agent.messages || []\n    const conversations = new Set(messages.map(m => (m.conversations as { id?: string } | null)?.id).filter(Boolean))\n\n    return {\n      id: agent.id,\n      name: agent.full_name,\n      email: agent.email,\n      role: agent.role,\n      messagesSent: messages.length,\n      conversationsHandled: conversations.size,\n      avgMessagesPerConversation: conversations.size > 0\n        ? Math.round(messages.length / conversations.size * 100) / 100\n        : 0\n    }\n  })\n}\n\nasync function generateContactsReport(supabase: TypedSupabaseClient, organizationId: string, startDate: string, endDate: string): Promise<unknown[]> {\n  const { data: contacts } = await supabase\n    .from('contacts')\n    .select(`\n      id,\n      name,\n      phone_number,\n      tags,\n      created_at,\n      last_message_at,\n      conversations (\n        id,\n        status,\n        messages (\n          id\n        )\n      )\n    `)\n    .eq('organization_id', organizationId)\n    .gte('created_at', startDate)\n    .lte('created_at', endDate)\n    .order('created_at', { ascending: false })\n\n  return (contacts || []).map(contact => {\n    const conversations = contact.conversations || []\n    const totalMessages = conversations.reduce((sum, conv) => sum + ((conv.messages as unknown[])?.length || 0), 0)\n\n    return {\n      id: contact.id,\n      name: contact.name || 'Unknown',\n      phoneNumber: contact.phone_number,\n      tags: contact.tags || [],\n      conversationsCount: conversations.length,\n      totalMessages,\n      lastContactAt: contact.last_message_at,\n      createdAt: contact.created_at\n    }\n  })\n}\n\nasync function generatePerformanceReport(supabase: TypedSupabaseClient, organizationId: string, startDate: string, endDate: string): Promise<{ summary: Record<string, unknown>; dailyBreakdown: unknown[] }> {\n  const [messagesData, conversationsData, agentsData] = await Promise.all([\n    supabase\n      .from('messages')\n      .select('sender_type, created_at')\n      .eq('organization_id', organizationId)\n      .gte('created_at', startDate)\n      .lte('created_at', endDate),\n\n    supabase\n      .from('conversations')\n      .select('status, created_at, last_message_at')\n      .eq('organization_id', organizationId)\n      .gte('created_at', startDate)\n      .lte('created_at', endDate),\n\n    supabase\n      .from('profiles')\n      .select('id, full_name, last_seen_at')\n      .eq('organization_id', organizationId)\n      .gte('last_seen_at', startDate)\n  ])\n\n  const messages = messagesData.data || []\n  const conversations = conversationsData.data || []\n  const activeAgents = agentsData.data || []\n\n  const totalMessages = messages.length\n  const inboundMessages = messages.filter(m => m.sender_type === 'contact').length\n  const outboundMessages = messages.filter(m => m.sender_type === 'agent').length\n\n  const resolvedConversations = conversations.filter(c => c.status === 'resolved').length\n  const resolutionRate = conversations.length > 0\n    ? Math.round((resolvedConversations / conversations.length) * 100)\n    : 0\n\n  return {\n    summary: {\n      totalMessages,\n      inboundMessages,\n      outboundMessages,\n      totalConversations: conversations.length,\n      resolvedConversations,\n      resolutionRate,\n      activeAgents: activeAgents.length\n    },\n    dailyBreakdown: generateDailyBreakdown(messages, conversations, startDate, endDate)\n  }\n}\n\ninterface MessageData { created_at: string; [key: string]: unknown; }\ninterface ConversationData { created_at: string; [key: string]: unknown; }\n\nfunction generateDailyBreakdown(messages: MessageData[], conversations: ConversationData[], startDate: string, endDate: string): unknown[] {\n  const start = new Date(startDate)\n  const end = new Date(endDate)\n  const breakdown = []\n\n  for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {\n    const dayStr = d.toISOString().split('T')[0]\n    const dayMessages = messages.filter(m => m.created_at.startsWith(dayStr))\n    const dayConversations = conversations.filter(c => c.created_at.startsWith(dayStr))\n\n    breakdown.push({\n      date: dayStr,\n      messages: dayMessages.length,\n      inbound: dayMessages.filter(m => (m as { sender_type?: string }).sender_type === 'contact').length,\n      outbound: dayMessages.filter(m => (m as { sender_type?: string }).sender_type === 'agent').length,\n      conversations: dayConversations.length,\n      resolved: dayConversations.filter(c => (c as { status?: string }).status === 'resolved').length\n    })\n  }\n\n  return breakdown\n}\n\nfunction convertToCSV(data: Record<string, unknown> | Record<string, unknown>[]): string {\n  const dataArray = Array.isArray(data) ? data : [data]\n  if (!dataArray || dataArray.length === 0) {\n    return ''\n  }\n\n  const headers = Object.keys(dataArray[0])\n  const csvRows = [\n    headers.join(','),\n    ...dataArray.map(row =>\n      headers.map(header => {\n        const value = row[header]\n        // Escape quotes and wrap in quotes if contains comma\n        if (typeof value === 'string' && (value.includes(',') || value.includes('\"'))) {\n          return `\"${value.replace(/\"/g, '\"\"')}\"`\n        }\n        return value\n      }).join(',')\n    )\n  ]\n\n  return csvRows.join('\\n')\n}\n\nasync function queueReportGeneration(_reportId: string) {\n  // TODO WEEK 5+: Implement background job queue for report generation\n  // In a real implementation, this would add the report to a job queue\n  // For now, this is commented out until scheduled_reports table is created\n\n  // const supabase = await createClient()\n  // await supabase\n  //   .from('scheduled_reports')\n  //   .update({\n  //     status: 'processing',\n  //     started_at: new Date().toISOString()\n  //   })\n  //   .eq('id', reportId)\n\n  // The actual report generation would happen in a background job\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}