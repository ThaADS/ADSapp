{"version":3,"sources":["C:\\Ai Projecten\\ADSapp\\tests\\integration\\api\\templates.test.ts"],"sourcesContent":["/**\n * Templates API Integration Tests - 6 tests total\n */\n\nimport { describe, it, expect, jest, beforeEach } from '@jest/globals'\nimport { NextRequest } from 'next/server'\nimport { createAuthenticatedRequest, parseResponse } from '../../utils/api-test-helpers'\nimport { createMockUser, createMockSupabaseClient } from '../../utils/test-helpers'\n\njest.mock('@/lib/supabase/server')\n\ndescribe('Templates API', () => {\n  let mockSupabase: any\n  let mockUser: any\n\n  beforeEach(() => {\n    mockSupabase = createMockSupabaseClient()\n    mockUser = createMockUser()\n  })\n\n  it('GET /api/templates - should list templates', async () => {\n    mockSupabase.from = jest.fn().mockReturnValue({\n      select: jest.fn().mockReturnThis(),\n      eq: jest.fn().mockReturnThis(),\n      order: jest.fn().mockReturnThis(),\n      range: jest.fn().mockResolvedValue({ data: [], error: null, count: 0 }),\n    })\n\n    const req = createAuthenticatedRequest('GET', '/api/templates', mockUser.id, mockUser.organization_id)\n    // API handler simulation would go here\n    expect(true).toBe(true) // Placeholder for actual API test\n  })\n\n  it('POST /api/templates - should create template', async () => {\n    const templateData = { name: 'Test Template', content: 'Hello {{name}}', variables: ['name'] }\n    mockSupabase.from = jest.fn().mockReturnValue({\n      insert: jest.fn().mockReturnThis(),\n      select: jest.fn().mockReturnThis(),\n      single: jest.fn().mockResolvedValue({ data: { ...templateData, id: 'new-id' }, error: null }),\n    })\n\n    const req = createAuthenticatedRequest('POST', '/api/templates', mockUser.id, mockUser.organization_id, templateData)\n    expect(true).toBe(true)\n  })\n\n  it('POST /api/templates - should validate required fields', async () => {\n    const req = createAuthenticatedRequest('POST', '/api/templates', mockUser.id, mockUser.organization_id, { content: 'Test' })\n    expect(true).toBe(true)\n  })\n\n  it('PUT /api/templates/[id] - should update template', async () => {\n    mockSupabase.from = jest.fn().mockReturnValue({\n      select: jest.fn().mockReturnThis(),\n      eq: jest.fn().mockReturnThis(),\n      single: jest.fn().mockResolvedValue({ data: { id: 'template-id' }, error: null }),\n      update: jest.fn().mockReturnThis(),\n    })\n\n    const req = createAuthenticatedRequest('PUT', '/api/templates/template-id', mockUser.id, mockUser.organization_id, { name: 'Updated' })\n    expect(true).toBe(true)\n  })\n\n  it('DELETE /api/templates/[id] - should delete template', async () => {\n    mockSupabase.from = jest.fn().mockReturnValue({\n      select: jest.fn().mockReturnThis(),\n      eq: jest.fn().mockReturnThis(),\n      single: jest.fn().mockResolvedValue({ data: { id: 'template-id' }, error: null }),\n      delete: jest.fn().mockReturnThis(),\n    })\n\n    const req = createAuthenticatedRequest('DELETE', '/api/templates/template-id', mockUser.id, mockUser.organization_id)\n    expect(true).toBe(true)\n  })\n\n  it('DELETE /api/templates/[id] - should prevent deletion if in use', async () => {\n    mockSupabase.from = jest.fn().mockReturnValue({\n      select: jest.fn().mockReturnThis(),\n      eq: jest.fn().mockReturnThis(),\n      single: jest.fn().mockResolvedValue({ data: { id: 'template-id', usage_count: 5 }, error: null }),\n    })\n\n    const req = createAuthenticatedRequest('DELETE', '/api/templates/template-id', mockUser.id, mockUser.organization_id)\n    expect(true).toBe(true)\n  })\n})\n"],"names":["jest","mock","describe","mockSupabase","mockUser","beforeEach","createMockSupabaseClient","createMockUser","it","from","fn","mockReturnValue","select","mockReturnThis","eq","order","range","mockResolvedValue","data","error","count","req","createAuthenticatedRequest","id","organization_id","expect","toBe","templateData","name","content","variables","insert","single","update","delete","usage_count"],"mappings":"AAAA;;CAEC;;;;yBAEsD;gCAEG;6BACD;AAEzDA,aAAI,CAACC,IAAI,CAAC;AAEVC,IAAAA,iBAAQ,EAAC,iBAAiB;IACxB,IAAIC;IACJ,IAAIC;IAEJC,IAAAA,mBAAU,EAAC;QACTF,eAAeG,IAAAA,qCAAwB;QACvCF,WAAWG,IAAAA,2BAAc;IAC3B;IAEAC,IAAAA,WAAE,EAAC,8CAA8C;QAC/CL,aAAaM,IAAI,GAAGT,aAAI,CAACU,EAAE,GAAGC,eAAe,CAAC;YAC5CC,QAAQZ,aAAI,CAACU,EAAE,GAAGG,cAAc;YAChCC,IAAId,aAAI,CAACU,EAAE,GAAGG,cAAc;YAC5BE,OAAOf,aAAI,CAACU,EAAE,GAAGG,cAAc;YAC/BG,OAAOhB,aAAI,CAACU,EAAE,GAAGO,iBAAiB,CAAC;gBAAEC,MAAM,EAAE;gBAAEC,OAAO;gBAAMC,OAAO;YAAE;QACvE;QAEA,MAAMC,MAAMC,IAAAA,0CAA0B,EAAC,OAAO,kBAAkBlB,SAASmB,EAAE,EAAEnB,SAASoB,eAAe;QACrG,uCAAuC;QACvCC,IAAAA,eAAM,EAAC,MAAMC,IAAI,CAAC,OAAM,kCAAkC;IAC5D;IAEAlB,IAAAA,WAAE,EAAC,gDAAgD;QACjD,MAAMmB,eAAe;YAAEC,MAAM;YAAiBC,SAAS;YAAkBC,WAAW;gBAAC;aAAO;QAAC;QAC7F3B,aAAaM,IAAI,GAAGT,aAAI,CAACU,EAAE,GAAGC,eAAe,CAAC;YAC5CoB,QAAQ/B,aAAI,CAACU,EAAE,GAAGG,cAAc;YAChCD,QAAQZ,aAAI,CAACU,EAAE,GAAGG,cAAc;YAChCmB,QAAQhC,aAAI,CAACU,EAAE,GAAGO,iBAAiB,CAAC;gBAAEC,MAAM;oBAAE,GAAGS,YAAY;oBAAEJ,IAAI;gBAAS;gBAAGJ,OAAO;YAAK;QAC7F;QAEA,MAAME,MAAMC,IAAAA,0CAA0B,EAAC,QAAQ,kBAAkBlB,SAASmB,EAAE,EAAEnB,SAASoB,eAAe,EAAEG;QACxGF,IAAAA,eAAM,EAAC,MAAMC,IAAI,CAAC;IACpB;IAEAlB,IAAAA,WAAE,EAAC,yDAAyD;QAC1D,MAAMa,MAAMC,IAAAA,0CAA0B,EAAC,QAAQ,kBAAkBlB,SAASmB,EAAE,EAAEnB,SAASoB,eAAe,EAAE;YAAEK,SAAS;QAAO;QAC1HJ,IAAAA,eAAM,EAAC,MAAMC,IAAI,CAAC;IACpB;IAEAlB,IAAAA,WAAE,EAAC,oDAAoD;QACrDL,aAAaM,IAAI,GAAGT,aAAI,CAACU,EAAE,GAAGC,eAAe,CAAC;YAC5CC,QAAQZ,aAAI,CAACU,EAAE,GAAGG,cAAc;YAChCC,IAAId,aAAI,CAACU,EAAE,GAAGG,cAAc;YAC5BmB,QAAQhC,aAAI,CAACU,EAAE,GAAGO,iBAAiB,CAAC;gBAAEC,MAAM;oBAAEK,IAAI;gBAAc;gBAAGJ,OAAO;YAAK;YAC/Ec,QAAQjC,aAAI,CAACU,EAAE,GAAGG,cAAc;QAClC;QAEA,MAAMQ,MAAMC,IAAAA,0CAA0B,EAAC,OAAO,8BAA8BlB,SAASmB,EAAE,EAAEnB,SAASoB,eAAe,EAAE;YAAEI,MAAM;QAAU;QACrIH,IAAAA,eAAM,EAAC,MAAMC,IAAI,CAAC;IACpB;IAEAlB,IAAAA,WAAE,EAAC,uDAAuD;QACxDL,aAAaM,IAAI,GAAGT,aAAI,CAACU,EAAE,GAAGC,eAAe,CAAC;YAC5CC,QAAQZ,aAAI,CAACU,EAAE,GAAGG,cAAc;YAChCC,IAAId,aAAI,CAACU,EAAE,GAAGG,cAAc;YAC5BmB,QAAQhC,aAAI,CAACU,EAAE,GAAGO,iBAAiB,CAAC;gBAAEC,MAAM;oBAAEK,IAAI;gBAAc;gBAAGJ,OAAO;YAAK;YAC/Ee,QAAQlC,aAAI,CAACU,EAAE,GAAGG,cAAc;QAClC;QAEA,MAAMQ,MAAMC,IAAAA,0CAA0B,EAAC,UAAU,8BAA8BlB,SAASmB,EAAE,EAAEnB,SAASoB,eAAe;QACpHC,IAAAA,eAAM,EAAC,MAAMC,IAAI,CAAC;IACpB;IAEAlB,IAAAA,WAAE,EAAC,kEAAkE;QACnEL,aAAaM,IAAI,GAAGT,aAAI,CAACU,EAAE,GAAGC,eAAe,CAAC;YAC5CC,QAAQZ,aAAI,CAACU,EAAE,GAAGG,cAAc;YAChCC,IAAId,aAAI,CAACU,EAAE,GAAGG,cAAc;YAC5BmB,QAAQhC,aAAI,CAACU,EAAE,GAAGO,iBAAiB,CAAC;gBAAEC,MAAM;oBAAEK,IAAI;oBAAeY,aAAa;gBAAE;gBAAGhB,OAAO;YAAK;QACjG;QAEA,MAAME,MAAMC,IAAAA,0CAA0B,EAAC,UAAU,8BAA8BlB,SAASmB,EAAE,EAAEnB,SAASoB,eAAe;QACpHC,IAAAA,eAAM,EAAC,MAAMC,IAAI,CAAC;IACpB;AACF"}