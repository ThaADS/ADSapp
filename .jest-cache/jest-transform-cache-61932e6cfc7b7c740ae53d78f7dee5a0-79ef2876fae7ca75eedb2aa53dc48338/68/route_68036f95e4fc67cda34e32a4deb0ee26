6be991f361eef938c0a88e38036ab6ab
"use strict";

/* istanbul ignore next */
function cov_27hm9d5xen() {
  var path = "C:\\Ai Projecten\\ADSapp\\src\\app\\api\\auth\\signup\\route.ts";
  var hash = "36e065b1a4ab0b9db71e5896fbae249956608d21";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Ai Projecten\\ADSapp\\src\\app\\api\\auth\\signup\\route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 20
        }
      },
      "3": {
        start: {
          line: 11,
          column: 16
        },
        end: {
          line: 11,
          column: 38
        }
      },
      "4": {
        start: {
          line: 12,
          column: 17
        },
        end: {
          line: 12,
          column: 59
        }
      },
      "5": {
        start: {
          line: 14,
          column: 4
        },
        end: {
          line: 83,
          column: 5
        }
      },
      "6": {
        start: {
          line: 15,
          column: 21
        },
        end: {
          line: 15,
          column: 41
        }
      },
      "7": {
        start: {
          line: 16,
          column: 8
        },
        end: {
          line: 16,
          column: 50
        }
      },
      "8": {
        start: {
          line: 17,
          column: 64
        },
        end: {
          line: 17,
          column: 68
        }
      },
      "9": {
        start: {
          line: 19,
          column: 8
        },
        end: {
          line: 26,
          column: 9
        }
      },
      "10": {
        start: {
          line: 20,
          column: 12
        },
        end: {
          line: 20,
          column: 72
        }
      },
      "11": {
        start: {
          line: 21,
          column: 12
        },
        end: {
          line: 25,
          column: 15
        }
      },
      "12": {
        start: {
          line: 28,
          column: 25
        },
        end: {
          line: 28,
          column: 59
        }
      },
      "13": {
        start: {
          line: 30,
          column: 30
        },
        end: {
          line: 39,
          column: 9
        }
      },
      "14": {
        start: {
          line: 40,
          column: 8
        },
        end: {
          line: 40,
          column: 73
        }
      },
      "15": {
        start: {
          line: 41,
          column: 53
        },
        end: {
          line: 41,
          column: 94
        }
      },
      "16": {
        start: {
          line: 42,
          column: 8
        },
        end: {
          line: 54,
          column: 9
        }
      },
      "17": {
        start: {
          line: 43,
          column: 12
        },
        end: {
          line: 43,
          column: 59
        }
      },
      "18": {
        start: {
          line: 44,
          column: 12
        },
        end: {
          line: 48,
          column: 15
        }
      },
      "19": {
        start: {
          line: 49,
          column: 12
        },
        end: {
          line: 53,
          column: 15
        }
      },
      "20": {
        start: {
          line: 55,
          column: 8
        },
        end: {
          line: 61,
          column: 9
        }
      },
      "21": {
        start: {
          line: 56,
          column: 12
        },
        end: {
          line: 60,
          column: 15
        }
      },
      "22": {
        start: {
          line: 63,
          column: 8
        },
        end: {
          line: 69,
          column: 9
        }
      },
      "23": {
        start: {
          line: 64,
          column: 12
        },
        end: {
          line: 68,
          column: 15
        }
      },
      "24": {
        start: {
          line: 71,
          column: 8
        },
        end: {
          line: 75,
          column: 11
        }
      },
      "25": {
        start: {
          line: 77,
          column: 8
        },
        end: {
          line: 77,
          column: 50
        }
      },
      "26": {
        start: {
          line: 78,
          column: 8
        },
        end: {
          line: 82,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "POST",
        decl: {
          start: {
            line: 13,
            column: 15
          },
          end: {
            line: 13,
            column: 19
          }
        },
        loc: {
          start: {
            line: 13,
            column: 29
          },
          end: {
            line: 84,
            column: 1
          }
        },
        line: 13
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 19,
            column: 8
          },
          end: {
            line: 26,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 19,
            column: 8
          },
          end: {
            line: 26,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 19
      },
      "1": {
        loc: {
          start: {
            line: 19,
            column: 12
          },
          end: {
            line: 19,
            column: 31
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 19,
            column: 12
          },
          end: {
            line: 19,
            column: 18
          }
        }, {
          start: {
            line: 19,
            column: 22
          },
          end: {
            line: 19,
            column: 31
          }
        }],
        line: 19
      },
      "2": {
        loc: {
          start: {
            line: 35,
            column: 31
          },
          end: {
            line: 35,
            column: 45
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 35,
            column: 31
          },
          end: {
            line: 35,
            column: 39
          }
        }, {
          start: {
            line: 35,
            column: 43
          },
          end: {
            line: 35,
            column: 45
          }
        }],
        line: 35
      },
      "3": {
        loc: {
          start: {
            line: 36,
            column: 39
          },
          end: {
            line: 36,
            column: 61
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 36,
            column: 39
          },
          end: {
            line: 36,
            column: 55
          }
        }, {
          start: {
            line: 36,
            column: 59
          },
          end: {
            line: 36,
            column: 61
          }
        }],
        line: 36
      },
      "4": {
        loc: {
          start: {
            line: 42,
            column: 8
          },
          end: {
            line: 54,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 42,
            column: 8
          },
          end: {
            line: 54,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 42
      },
      "5": {
        loc: {
          start: {
            line: 50,
            column: 23
          },
          end: {
            line: 50,
            column: 65
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 50,
            column: 23
          },
          end: {
            line: 50,
            column: 40
          }
        }, {
          start: {
            line: 50,
            column: 44
          },
          end: {
            line: 50,
            column: 65
          }
        }],
        line: 50
      },
      "6": {
        loc: {
          start: {
            line: 55,
            column: 8
          },
          end: {
            line: 61,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 55,
            column: 8
          },
          end: {
            line: 61,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 55
      },
      "7": {
        loc: {
          start: {
            line: 63,
            column: 8
          },
          end: {
            line: 69,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 63,
            column: 8
          },
          end: {
            line: 69,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 63
      },
      "8": {
        loc: {
          start: {
            line: 63,
            column: 12
          },
          end: {
            line: 63,
            column: 46
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 63,
            column: 12
          },
          end: {
            line: 63,
            column: 25
          }
        }, {
          start: {
            line: 63,
            column: 29
          },
          end: {
            line: 63,
            column: 46
          }
        }],
        line: 63
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0
    },
    f: {
      "0": 0,
      "1": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\auth\\signup\\route.ts"],
      sourcesContent: ["import { NextRequest, NextResponse } from 'next/server'\nimport { createClient } from '@/lib/supabase/server'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    console.log('Signup request body:', body)\n    \n    const { email, password, fullName, organizationName } = body\n\n    // Validate input\n    if (!email || !password) {\n      console.log('Validation failed: missing email or password')\n      return NextResponse.json(\n        { error: 'Email and password are required' },\n        { status: 400 }\n      )\n    }\n\n    // Create Supabase client\n    const supabase = await createClient()\n\n    // Sign up the user\n    const signUpOptions = {\n      email,\n      password,\n      options: {\n        data: {\n          full_name: fullName || '',\n          organization_name: organizationName || ''\n        }\n      }\n    }\n    \n    console.log('Calling supabase.auth.signUp with:', signUpOptions)\n    const { data: authData, error: authError } = await supabase.auth.signUp(signUpOptions)\n\n    if (authError) {\n      console.error('Auth signup error:', authError)\n      console.error('Error details:', {\n        message: authError.message,\n        status: authError.status,\n        code: 'AuthError'\n      })\n      return NextResponse.json(\n        { error: authError.message || 'Registration failed' },\n        { status: 400 }\n      )\n    }\n\n    if (!authData.user) {\n      return NextResponse.json(\n        { error: 'Failed to create user' },\n        { status: 400 }\n      )\n    }\n\n    // If we have a user but no session, it means email confirmation is required\n    if (authData.user && !authData.session) {\n      return NextResponse.json({\n        message: 'Please check your email to confirm your account',\n        user: authData.user,\n        confirmationRequired: true\n      })\n    }\n\n    // Success - user is created and logged in\n    return NextResponse.json({\n      message: 'Account created successfully',\n      user: authData.user,\n      session: authData.session\n    })\n\n  } catch (error) {\n    console.error('Signup API error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}\n"],
      names: ["POST", "request", "body", "json", "console", "log", "email", "password", "fullName", "organizationName", "NextResponse", "error", "status", "supabase", "createClient", "signUpOptions", "options", "data", "full_name", "organization_name", "authData", "authError", "auth", "signUp", "message", "code", "user", "session", "confirmationRequired"],
      mappings: ";;;;+BAGsBA;;;eAAAA;;;wBAHoB;yBACb;AAEtB,eAAeA,KAAKC,OAAoB;IAC7C,IAAI;QACF,MAAMC,OAAO,MAAMD,QAAQE,IAAI;QAC/BC,QAAQC,GAAG,CAAC,wBAAwBH;QAEpC,MAAM,EAAEI,KAAK,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,gBAAgB,EAAE,GAAGP;QAExD,iBAAiB;QACjB,IAAI,CAACI,SAAS,CAACC,UAAU;YACvBH,QAAQC,GAAG,CAAC;YACZ,OAAOK,oBAAY,CAACP,IAAI,CACtB;gBAAEQ,OAAO;YAAkC,GAC3C;gBAAEC,QAAQ;YAAI;QAElB;QAEA,yBAAyB;QACzB,MAAMC,WAAW,MAAMC,IAAAA,qBAAY;QAEnC,mBAAmB;QACnB,MAAMC,gBAAgB;YACpBT;YACAC;YACAS,SAAS;gBACPC,MAAM;oBACJC,WAAWV,YAAY;oBACvBW,mBAAmBV,oBAAoB;gBACzC;YACF;QACF;QAEAL,QAAQC,GAAG,CAAC,sCAAsCU;QAClD,MAAM,EAAEE,MAAMG,QAAQ,EAAET,OAAOU,SAAS,EAAE,GAAG,MAAMR,SAASS,IAAI,CAACC,MAAM,CAACR;QAExE,IAAIM,WAAW;YACbjB,QAAQO,KAAK,CAAC,sBAAsBU;YACpCjB,QAAQO,KAAK,CAAC,kBAAkB;gBAC9Ba,SAASH,UAAUG,OAAO;gBAC1BZ,QAAQS,UAAUT,MAAM;gBACxBa,MAAM;YACR;YACA,OAAOf,oBAAY,CAACP,IAAI,CACtB;gBAAEQ,OAAOU,UAAUG,OAAO,IAAI;YAAsB,GACpD;gBAAEZ,QAAQ;YAAI;QAElB;QAEA,IAAI,CAACQ,SAASM,IAAI,EAAE;YAClB,OAAOhB,oBAAY,CAACP,IAAI,CACtB;gBAAEQ,OAAO;YAAwB,GACjC;gBAAEC,QAAQ;YAAI;QAElB;QAEA,4EAA4E;QAC5E,IAAIQ,SAASM,IAAI,IAAI,CAACN,SAASO,OAAO,EAAE;YACtC,OAAOjB,oBAAY,CAACP,IAAI,CAAC;gBACvBqB,SAAS;gBACTE,MAAMN,SAASM,IAAI;gBACnBE,sBAAsB;YACxB;QACF;QAEA,0CAA0C;QAC1C,OAAOlB,oBAAY,CAACP,IAAI,CAAC;YACvBqB,SAAS;YACTE,MAAMN,SAASM,IAAI;YACnBC,SAASP,SAASO,OAAO;QAC3B;IAEF,EAAE,OAAOhB,OAAO;QACdP,QAAQO,KAAK,CAAC,qBAAqBA;QACnC,OAAOD,oBAAY,CAACP,IAAI,CACtB;YAAEQ,OAAO;QAAwB,GACjC;YAAEC,QAAQ;QAAI;IAElB;AACF"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "36e065b1a4ab0b9db71e5896fbae249956608d21"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_27hm9d5xen = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_27hm9d5xen();
cov_27hm9d5xen().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_27hm9d5xen().s[1]++;
Object.defineProperty(exports, "POST", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_27hm9d5xen().f[0]++;
    cov_27hm9d5xen().s[2]++;
    return POST;
  }
});
const _server =
/* istanbul ignore next */
(cov_27hm9d5xen().s[3]++, require("next/server"));
const _server1 =
/* istanbul ignore next */
(cov_27hm9d5xen().s[4]++, require("../../../../lib/supabase/server"));
async function POST(request) {
  /* istanbul ignore next */
  cov_27hm9d5xen().f[1]++;
  cov_27hm9d5xen().s[5]++;
  try {
    const body =
    /* istanbul ignore next */
    (cov_27hm9d5xen().s[6]++, await request.json());
    /* istanbul ignore next */
    cov_27hm9d5xen().s[7]++;
    console.log('Signup request body:', body);
    const {
      email,
      password,
      fullName,
      organizationName
    } =
    /* istanbul ignore next */
    (cov_27hm9d5xen().s[8]++, body);
    // Validate input
    /* istanbul ignore next */
    cov_27hm9d5xen().s[9]++;
    if (
    /* istanbul ignore next */
    (cov_27hm9d5xen().b[1][0]++, !email) ||
    /* istanbul ignore next */
    (cov_27hm9d5xen().b[1][1]++, !password)) {
      /* istanbul ignore next */
      cov_27hm9d5xen().b[0][0]++;
      cov_27hm9d5xen().s[10]++;
      console.log('Validation failed: missing email or password');
      /* istanbul ignore next */
      cov_27hm9d5xen().s[11]++;
      return _server.NextResponse.json({
        error: 'Email and password are required'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_27hm9d5xen().b[0][1]++;
    }
    // Create Supabase client
    const supabase =
    /* istanbul ignore next */
    (cov_27hm9d5xen().s[12]++, await (0, _server1.createClient)());
    // Sign up the user
    const signUpOptions =
    /* istanbul ignore next */
    (cov_27hm9d5xen().s[13]++, {
      email,
      password,
      options: {
        data: {
          full_name:
          /* istanbul ignore next */
          (cov_27hm9d5xen().b[2][0]++, fullName) ||
          /* istanbul ignore next */
          (cov_27hm9d5xen().b[2][1]++, ''),
          organization_name:
          /* istanbul ignore next */
          (cov_27hm9d5xen().b[3][0]++, organizationName) ||
          /* istanbul ignore next */
          (cov_27hm9d5xen().b[3][1]++, '')
        }
      }
    });
    /* istanbul ignore next */
    cov_27hm9d5xen().s[14]++;
    console.log('Calling supabase.auth.signUp with:', signUpOptions);
    const {
      data: authData,
      error: authError
    } =
    /* istanbul ignore next */
    (cov_27hm9d5xen().s[15]++, await supabase.auth.signUp(signUpOptions));
    /* istanbul ignore next */
    cov_27hm9d5xen().s[16]++;
    if (authError) {
      /* istanbul ignore next */
      cov_27hm9d5xen().b[4][0]++;
      cov_27hm9d5xen().s[17]++;
      console.error('Auth signup error:', authError);
      /* istanbul ignore next */
      cov_27hm9d5xen().s[18]++;
      console.error('Error details:', {
        message: authError.message,
        status: authError.status,
        code: 'AuthError'
      });
      /* istanbul ignore next */
      cov_27hm9d5xen().s[19]++;
      return _server.NextResponse.json({
        error:
        /* istanbul ignore next */
        (cov_27hm9d5xen().b[5][0]++, authError.message) ||
        /* istanbul ignore next */
        (cov_27hm9d5xen().b[5][1]++, 'Registration failed')
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_27hm9d5xen().b[4][1]++;
    }
    cov_27hm9d5xen().s[20]++;
    if (!authData.user) {
      /* istanbul ignore next */
      cov_27hm9d5xen().b[6][0]++;
      cov_27hm9d5xen().s[21]++;
      return _server.NextResponse.json({
        error: 'Failed to create user'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_27hm9d5xen().b[6][1]++;
    }
    // If we have a user but no session, it means email confirmation is required
    cov_27hm9d5xen().s[22]++;
    if (
    /* istanbul ignore next */
    (cov_27hm9d5xen().b[8][0]++, authData.user) &&
    /* istanbul ignore next */
    (cov_27hm9d5xen().b[8][1]++, !authData.session)) {
      /* istanbul ignore next */
      cov_27hm9d5xen().b[7][0]++;
      cov_27hm9d5xen().s[23]++;
      return _server.NextResponse.json({
        message: 'Please check your email to confirm your account',
        user: authData.user,
        confirmationRequired: true
      });
    } else
    /* istanbul ignore next */
    {
      cov_27hm9d5xen().b[7][1]++;
    }
    // Success - user is created and logged in
    cov_27hm9d5xen().s[24]++;
    return _server.NextResponse.json({
      message: 'Account created successfully',
      user: authData.user,
      session: authData.session
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_27hm9d5xen().s[25]++;
    console.error('Signup API error:', error);
    /* istanbul ignore next */
    cov_27hm9d5xen().s[26]++;
    return _server.NextResponse.json({
      error: 'Internal server error'
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMjdobTlkNXhlbiIsImFjdHVhbENvdmVyYWdlIiwicyIsIlBPU1QiLCJyZXF1ZXN0IiwiZiIsImJvZHkiLCJqc29uIiwiY29uc29sZSIsImxvZyIsImVtYWlsIiwicGFzc3dvcmQiLCJmdWxsTmFtZSIsIm9yZ2FuaXphdGlvbk5hbWUiLCJiIiwiX3NlcnZlciIsIk5leHRSZXNwb25zZSIsImVycm9yIiwic3RhdHVzIiwic3VwYWJhc2UiLCJfc2VydmVyMSIsImNyZWF0ZUNsaWVudCIsInNpZ25VcE9wdGlvbnMiLCJvcHRpb25zIiwiZGF0YSIsImZ1bGxfbmFtZSIsIm9yZ2FuaXphdGlvbl9uYW1lIiwiYXV0aERhdGEiLCJhdXRoRXJyb3IiLCJhdXRoIiwic2lnblVwIiwibWVzc2FnZSIsImNvZGUiLCJ1c2VyIiwic2Vzc2lvbiIsImNvbmZpcm1hdGlvblJlcXVpcmVkIl0sInNvdXJjZXMiOlsiQzpcXEFpIFByb2plY3RlblxcQURTYXBwXFxzcmNcXGFwcFxcYXBpXFxhdXRoXFxzaWdudXBcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlcidcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBjb25zb2xlLmxvZygnU2lnbnVwIHJlcXVlc3QgYm9keTonLCBib2R5KVxuICAgIFxuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkLCBmdWxsTmFtZSwgb3JnYW5pemF0aW9uTmFtZSB9ID0gYm9keVxuXG4gICAgLy8gVmFsaWRhdGUgaW5wdXRcbiAgICBpZiAoIWVtYWlsIHx8ICFwYXNzd29yZCkge1xuICAgICAgY29uc29sZS5sb2coJ1ZhbGlkYXRpb24gZmFpbGVkOiBtaXNzaW5nIGVtYWlsIG9yIHBhc3N3b3JkJylcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0VtYWlsIGFuZCBwYXNzd29yZCBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIENyZWF0ZSBTdXBhYmFzZSBjbGllbnRcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpXG5cbiAgICAvLyBTaWduIHVwIHRoZSB1c2VyXG4gICAgY29uc3Qgc2lnblVwT3B0aW9ucyA9IHtcbiAgICAgIGVtYWlsLFxuICAgICAgcGFzc3dvcmQsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBmdWxsX25hbWU6IGZ1bGxOYW1lIHx8ICcnLFxuICAgICAgICAgIG9yZ2FuaXphdGlvbl9uYW1lOiBvcmdhbml6YXRpb25OYW1lIHx8ICcnXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0NhbGxpbmcgc3VwYWJhc2UuYXV0aC5zaWduVXAgd2l0aDonLCBzaWduVXBPcHRpb25zKVxuICAgIGNvbnN0IHsgZGF0YTogYXV0aERhdGEsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnblVwKHNpZ25VcE9wdGlvbnMpXG5cbiAgICBpZiAoYXV0aEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdBdXRoIHNpZ251cCBlcnJvcjonLCBhdXRoRXJyb3IpXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZXRhaWxzOicsIHtcbiAgICAgICAgbWVzc2FnZTogYXV0aEVycm9yLm1lc3NhZ2UsXG4gICAgICAgIHN0YXR1czogYXV0aEVycm9yLnN0YXR1cyxcbiAgICAgICAgY29kZTogJ0F1dGhFcnJvcidcbiAgICAgIH0pXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IGF1dGhFcnJvci5tZXNzYWdlIHx8ICdSZWdpc3RyYXRpb24gZmFpbGVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBpZiAoIWF1dGhEYXRhLnVzZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBjcmVhdGUgdXNlcicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gSWYgd2UgaGF2ZSBhIHVzZXIgYnV0IG5vIHNlc3Npb24sIGl0IG1lYW5zIGVtYWlsIGNvbmZpcm1hdGlvbiBpcyByZXF1aXJlZFxuICAgIGlmIChhdXRoRGF0YS51c2VyICYmICFhdXRoRGF0YS5zZXNzaW9uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiAnUGxlYXNlIGNoZWNrIHlvdXIgZW1haWwgdG8gY29uZmlybSB5b3VyIGFjY291bnQnLFxuICAgICAgICB1c2VyOiBhdXRoRGF0YS51c2VyLFxuICAgICAgICBjb25maXJtYXRpb25SZXF1aXJlZDogdHJ1ZVxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBTdWNjZXNzIC0gdXNlciBpcyBjcmVhdGVkIGFuZCBsb2dnZWQgaW5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgbWVzc2FnZTogJ0FjY291bnQgY3JlYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgdXNlcjogYXV0aERhdGEudXNlcixcbiAgICAgIHNlc3Npb246IGF1dGhEYXRhLnNlc3Npb25cbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignU2lnbnVwIEFQSSBlcnJvcjonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFNSTtJQUFBQSxjQUFBLFlBQUFBLENBQUE7TUFBQSxPQUFBQyxjQUFBO0lBQUE7RUFBQTtFQUFBLE9BQUFBLGNBQUE7QUFBQTtBQUFBRCxjQUFBO0FBQUFBLGNBQUEsR0FBQUUsQ0FBQTs7Ozs7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QUFBO1FBQUEsQ0FBQS9CLGNBQUEsR0FBQWMsQ0FBQSxVQUFJO01BQXNCLEdBQ3BEO1FBQUVJLE1BQUEsRUFBUTtNQUFJO0lBRWxCO0lBQUE7SUFBQTtNQUFBbEIsY0FBQSxHQUFBYyxDQUFBO0lBQUE7SUFBQWQsY0FBQSxHQUFBRSxDQUFBO0lBRUEsSUFBSSxDQUFDeUIsUUFBQSxDQUFTTSxJQUFJLEVBQUU7TUFBQTtNQUFBakMsY0FBQSxHQUFBYyxDQUFBO01BQUFkLGNBQUEsR0FBQUUsQ0FBQTtNQUNsQixPQUFPYSxPQUFBLENBQUFDLFlBQVksQ0FBQ1QsSUFBSSxDQUN0QjtRQUFFVSxLQUFBLEVBQU87TUFBd0IsR0FDakM7UUFBRUMsTUFBQSxFQUFRO01BQUk7SUFFbEI7SUFBQTtJQUFBO01BQUFsQixjQUFBLEdBQUFjLENBQUE7SUFBQTtJQUVBO0lBQUFkLGNBQUEsR0FBQUUsQ0FBQTtJQUNBO0lBQUk7SUFBQSxDQUFBRixjQUFBLEdBQUFjLENBQUEsVUFBQWEsUUFBQSxDQUFTTSxJQUFJO0lBQUE7SUFBQSxDQUFBakMsY0FBQSxHQUFBYyxDQUFBLFVBQUksQ0FBQ2EsUUFBQSxDQUFTTyxPQUFPLEdBQUU7TUFBQTtNQUFBbEMsY0FBQSxHQUFBYyxDQUFBO01BQUFkLGNBQUEsR0FBQUUsQ0FBQTtNQUN0QyxPQUFPYSxPQUFBLENBQUFDLFlBQVksQ0FBQ1QsSUFBSSxDQUFDO1FBQ3ZCd0IsT0FBQSxFQUFTO1FBQ1RFLElBQUEsRUFBTU4sUUFBQSxDQUFTTSxJQUFJO1FBQ25CRSxvQkFBQSxFQUFzQjtNQUN4QjtJQUNGO0lBQUE7SUFBQTtNQUFBbkMsY0FBQSxHQUFBYyxDQUFBO0lBQUE7SUFFQTtJQUFBZCxjQUFBLEdBQUFFLENBQUE7SUFDQSxPQUFPYSxPQUFBLENBQUFDLFlBQVksQ0FBQ1QsSUFBSSxDQUFDO01BQ3ZCd0IsT0FBQSxFQUFTO01BQ1RFLElBQUEsRUFBTU4sUUFBQSxDQUFTTSxJQUFJO01BQ25CQyxPQUFBLEVBQVNQLFFBQUEsQ0FBU087SUFDcEI7RUFFRixFQUFFLE9BQU9qQixLQUFBLEVBQU87SUFBQTtJQUFBakIsY0FBQSxHQUFBRSxDQUFBO0lBQ2RNLE9BQUEsQ0FBUVMsS0FBSyxDQUFDLHFCQUFxQkEsS0FBQTtJQUFBO0lBQUFqQixjQUFBLEdBQUFFLENBQUE7SUFDbkMsT0FBT2EsT0FBQSxDQUFBQyxZQUFZLENBQUNULElBQUksQ0FDdEI7TUFBRVUsS0FBQSxFQUFPO0lBQXdCLEdBQ2pDO01BQUVDLE1BQUEsRUFBUTtJQUFJO0VBRWxCO0FBQ0YiLCJpZ25vcmVMaXN0IjpbXX0=