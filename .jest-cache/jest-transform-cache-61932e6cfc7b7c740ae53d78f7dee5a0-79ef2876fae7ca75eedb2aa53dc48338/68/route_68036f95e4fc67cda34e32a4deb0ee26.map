{"version":3,"names":["cov_27hm9d5xen","actualCoverage","s","POST","request","f","body","json","console","log","email","password","fullName","organizationName","b","_server","NextResponse","error","status","supabase","_server1","createClient","signUpOptions","options","data","full_name","organization_name","authData","authError","auth","signUp","message","code","user","session","confirmationRequired"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\auth\\signup\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createClient } from '@/lib/supabase/server'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    console.log('Signup request body:', body)\n    \n    const { email, password, fullName, organizationName } = body\n\n    // Validate input\n    if (!email || !password) {\n      console.log('Validation failed: missing email or password')\n      return NextResponse.json(\n        { error: 'Email and password are required' },\n        { status: 400 }\n      )\n    }\n\n    // Create Supabase client\n    const supabase = await createClient()\n\n    // Sign up the user\n    const signUpOptions = {\n      email,\n      password,\n      options: {\n        data: {\n          full_name: fullName || '',\n          organization_name: organizationName || ''\n        }\n      }\n    }\n    \n    console.log('Calling supabase.auth.signUp with:', signUpOptions)\n    const { data: authData, error: authError } = await supabase.auth.signUp(signUpOptions)\n\n    if (authError) {\n      console.error('Auth signup error:', authError)\n      console.error('Error details:', {\n        message: authError.message,\n        status: authError.status,\n        code: 'AuthError'\n      })\n      return NextResponse.json(\n        { error: authError.message || 'Registration failed' },\n        { status: 400 }\n      )\n    }\n\n    if (!authData.user) {\n      return NextResponse.json(\n        { error: 'Failed to create user' },\n        { status: 400 }\n      )\n    }\n\n    // If we have a user but no session, it means email confirmation is required\n    if (authData.user && !authData.session) {\n      return NextResponse.json({\n        message: 'Please check your email to confirm your account',\n        user: authData.user,\n        confirmationRequired: true\n      })\n    }\n\n    // Success - user is created and logged in\n    return NextResponse.json({\n      message: 'Account created successfully',\n      user: authData.user,\n      session: authData.session\n    })\n\n  } catch (error) {\n    console.error('Signup API error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMI;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;+BAHkB;;;;;;WAAAC,IAAA;;;;;kCAHoB;;;kCACb;AAEtB,eAAeA,KAAKC,OAAoB;EAAA;EAAAJ,cAAA,GAAAK,CAAA;EAAAL,cAAA,GAAAE,CAAA;EAC7C,IAAI;IACF,MAAMI,IAAA;IAAA;IAAA,CAAAN,cAAA,GAAAE,CAAA,OAAO,MAAME,OAAA,CAAQG,IAAI;IAAA;IAAAP,cAAA,GAAAE,CAAA;IAC/BM,OAAA,CAAQC,GAAG,CAAC,wBAAwBH,IAAA;IAEpC,MAAM;MAAEI,KAAK;MAAEC,QAAQ;MAAEC,QAAQ;MAAEC;IAAgB,CAAE;IAAA;IAAA,CAAAb,cAAA,GAAAE,CAAA,OAAGI,IAAA;IAExD;IAAA;IAAAN,cAAA,GAAAE,CAAA;IACA;IAAI;IAAA,CAAAF,cAAA,GAAAc,CAAA,WAACJ,KAAA;IAAA;IAAA,CAAAV,cAAA,GAAAc,CAAA,UAAS,CAACH,QAAA,GAAU;MAAA;MAAAX,cAAA,GAAAc,CAAA;MAAAd,cAAA,GAAAE,CAAA;MACvBM,OAAA,CAAQC,GAAG,CAAC;MAAA;MAAAT,cAAA,GAAAE,CAAA;MACZ,OAAOa,OAAA,CAAAC,YAAY,CAACT,IAAI,CACtB;QAAEU,KAAA,EAAO;MAAkC,GAC3C;QAAEC,MAAA,EAAQ;MAAI;IAElB;IAAA;IAAA;MAAAlB,cAAA,GAAAc,CAAA;IAAA;IAEA;IACA,MAAMK,QAAA;IAAA;IAAA,CAAAnB,cAAA,GAAAE,CAAA,QAAW,MAAM,IAAAkB,QAAA,CAAAC,YAAY;IAEnC;IACA,MAAMC,aAAA;IAAA;IAAA,CAAAtB,cAAA,GAAAE,CAAA,QAAgB;MACpBQ,KAAA;MACAC,QAAA;MACAY,OAAA,EAAS;QACPC,IAAA,EAAM;UACJC,SAAA;UAAW;UAAA,CAAAzB,cAAA,GAAAc,CAAA,UAAAF,QAAA;UAAA;UAAA,CAAAZ,cAAA,GAAAc,CAAA,UAAY;UACvBY,iBAAA;UAAmB;UAAA,CAAA1B,cAAA,GAAAc,CAAA,UAAAD,gBAAA;UAAA;UAAA,CAAAb,cAAA,GAAAc,CAAA,UAAoB;QACzC;MACF;IACF;IAAA;IAAAd,cAAA,GAAAE,CAAA;IAEAM,OAAA,CAAQC,GAAG,CAAC,sCAAsCa,aAAA;IAClD,MAAM;MAAEE,IAAA,EAAMG,QAAQ;MAAEV,KAAA,EAAOW;IAAS,CAAE;IAAA;IAAA,CAAA5B,cAAA,GAAAE,CAAA,QAAG,MAAMiB,QAAA,CAASU,IAAI,CAACC,MAAM,CAACR,aAAA;IAAA;IAAAtB,cAAA,GAAAE,CAAA;IAExE,IAAI0B,SAAA,EAAW;MAAA;MAAA5B,cAAA,GAAAc,CAAA;MAAAd,cAAA,GAAAE,CAAA;MACbM,OAAA,CAAQS,KAAK,CAAC,sBAAsBW,SAAA;MAAA;MAAA5B,cAAA,GAAAE,CAAA;MACpCM,OAAA,CAAQS,KAAK,CAAC,kBAAkB;QAC9Bc,OAAA,EAASH,SAAA,CAAUG,OAAO;QAC1Bb,MAAA,EAAQU,SAAA,CAAUV,MAAM;QACxBc,IAAA,EAAM;MACR;MAAA;MAAAhC,cAAA,GAAAE,CAAA;MACA,OAAOa,OAAA,CAAAC,YAAY,CAACT,IAAI,CACtB;QAAEU,KAAA;QAAO;QAAA,CAAAjB,cAAA,GAAAc,CAAA,UAAAc,SAAA,CAAUG,OAAO;QAAA;QAAA,CAAA/B,cAAA,GAAAc,CAAA,UAAI;MAAsB,GACpD;QAAEI,MAAA,EAAQ;MAAI;IAElB;IAAA;IAAA;MAAAlB,cAAA,GAAAc,CAAA;IAAA;IAAAd,cAAA,GAAAE,CAAA;IAEA,IAAI,CAACyB,QAAA,CAASM,IAAI,EAAE;MAAA;MAAAjC,cAAA,GAAAc,CAAA;MAAAd,cAAA,GAAAE,CAAA;MAClB,OAAOa,OAAA,CAAAC,YAAY,CAACT,IAAI,CACtB;QAAEU,KAAA,EAAO;MAAwB,GACjC;QAAEC,MAAA,EAAQ;MAAI;IAElB;IAAA;IAAA;MAAAlB,cAAA,GAAAc,CAAA;IAAA;IAEA;IAAAd,cAAA,GAAAE,CAAA;IACA;IAAI;IAAA,CAAAF,cAAA,GAAAc,CAAA,UAAAa,QAAA,CAASM,IAAI;IAAA;IAAA,CAAAjC,cAAA,GAAAc,CAAA,UAAI,CAACa,QAAA,CAASO,OAAO,GAAE;MAAA;MAAAlC,cAAA,GAAAc,CAAA;MAAAd,cAAA,GAAAE,CAAA;MACtC,OAAOa,OAAA,CAAAC,YAAY,CAACT,IAAI,CAAC;QACvBwB,OAAA,EAAS;QACTE,IAAA,EAAMN,QAAA,CAASM,IAAI;QACnBE,oBAAA,EAAsB;MACxB;IACF;IAAA;IAAA;MAAAnC,cAAA,GAAAc,CAAA;IAAA;IAEA;IAAAd,cAAA,GAAAE,CAAA;IACA,OAAOa,OAAA,CAAAC,YAAY,CAACT,IAAI,CAAC;MACvBwB,OAAA,EAAS;MACTE,IAAA,EAAMN,QAAA,CAASM,IAAI;MACnBC,OAAA,EAASP,QAAA,CAASO;IACpB;EAEF,EAAE,OAAOjB,KAAA,EAAO;IAAA;IAAAjB,cAAA,GAAAE,CAAA;IACdM,OAAA,CAAQS,KAAK,CAAC,qBAAqBA,KAAA;IAAA;IAAAjB,cAAA,GAAAE,CAAA;IACnC,OAAOa,OAAA,CAAAC,YAAY,CAACT,IAAI,CACtB;MAAEU,KAAA,EAAO;IAAwB,GACjC;MAAEC,MAAA,EAAQ;IAAI;EAElB;AACF","ignoreList":[]}