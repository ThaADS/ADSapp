af1ce1ebf6e4aa7e2a49c943d16f96af
"use strict";

/* istanbul ignore next */
function cov_2n9if98k8e() {
  var path = "C:\\Ai Projecten\\ADSapp\\src\\app\\api\\contacts\\import\\route.ts";
  var hash = "1123f10ecc69aa1da1626550c5a4ee0b88d51040";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Ai Projecten\\ADSapp\\src\\app\\api\\contacts\\import\\route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 6,
          column: 4
        },
        end: {
          line: 9,
          column: 7
        }
      },
      "2": {
        start: {
          line: 6,
          column: 24
        },
        end: {
          line: 9,
          column: 7
        }
      },
      "3": {
        start: {
          line: 11,
          column: 0
        },
        end: {
          line: 18,
          column: 3
        }
      },
      "4": {
        start: {
          line: 13,
          column: 8
        },
        end: {
          line: 13,
          column: 19
        }
      },
      "5": {
        start: {
          line: 16,
          column: 8
        },
        end: {
          line: 16,
          column: 20
        }
      },
      "6": {
        start: {
          line: 19,
          column: 16
        },
        end: {
          line: 19,
          column: 38
        }
      },
      "7": {
        start: {
          line: 20,
          column: 18
        },
        end: {
          line: 20,
          column: 54
        }
      },
      "8": {
        start: {
          line: 21,
          column: 15
        },
        end: {
          line: 21,
          column: 63
        }
      },
      "9": {
        start: {
          line: 22,
          column: 17
        },
        end: {
          line: 22,
          column: 57
        }
      },
      "10": {
        start: {
          line: 24,
          column: 4
        },
        end: {
          line: 126,
          column: 5
        }
      },
      "11": {
        start: {
          line: 25,
          column: 21
        },
        end: {
          line: 25,
          column: 68
        }
      },
      "12": {
        start: {
          line: 26,
          column: 24
        },
        end: {
          line: 26,
          column: 73
        }
      },
      "13": {
        start: {
          line: 27,
          column: 25
        },
        end: {
          line: 27,
          column: 49
        }
      },
      "14": {
        start: {
          line: 28,
          column: 21
        },
        end: {
          line: 28,
          column: 41
        }
      },
      "15": {
        start: {
          line: 29,
          column: 24
        },
        end: {
          line: 29,
          column: 67
        }
      },
      "16": {
        start: {
          line: 30,
          column: 24
        },
        end: {
          line: 30,
          column: 67
        }
      },
      "17": {
        start: {
          line: 31,
          column: 8
        },
        end: {
          line: 37,
          column: 9
        }
      },
      "18": {
        start: {
          line: 32,
          column: 12
        },
        end: {
          line: 36,
          column: 15
        }
      },
      "19": {
        start: {
          line: 39,
          column: 29
        },
        end: {
          line: 44,
          column: 9
        }
      },
      "20": {
        start: {
          line: 45,
          column: 8
        },
        end: {
          line: 51,
          column: 9
        }
      },
      "21": {
        start: {
          line: 46,
          column: 12
        },
        end: {
          line: 50,
          column: 15
        }
      },
      "22": {
        start: {
          line: 53,
          column: 24
        },
        end: {
          line: 53,
          column: 40
        }
      },
      "23": {
        start: {
          line: 55,
          column: 8
        },
        end: {
          line: 61,
          column: 9
        }
      },
      "24": {
        start: {
          line: 56,
          column: 12
        },
        end: {
          line: 60,
          column: 15
        }
      },
      "25": {
        start: {
          line: 63,
          column: 8
        },
        end: {
          line: 69,
          column: 9
        }
      },
      "26": {
        start: {
          line: 64,
          column: 12
        },
        end: {
          line: 68,
          column: 15
        }
      },
      "27": {
        start: {
          line: 71,
          column: 29
        },
        end: {
          line: 71,
          column: 63
        }
      },
      "28": {
        start: {
          line: 72,
          column: 23
        },
        end: {
          line: 72,
          column: 60
        }
      },
      "29": {
        start: {
          line: 73,
          column: 29
        },
        end: {
          line: 76,
          column: 10
        }
      },
      "30": {
        start: {
          line: 79,
          column: 8
        },
        end: {
          line: 85,
          column: 9
        }
      },
      "31": {
        start: {
          line: 80,
          column: 12
        },
        end: {
          line: 80,
          column: 27
        }
      },
      "32": {
        start: {
          line: 81,
          column: 15
        },
        end: {
          line: 85,
          column: 9
        }
      },
      "33": {
        start: {
          line: 82,
          column: 12
        },
        end: {
          line: 82,
          column: 28
        }
      },
      "34": {
        start: {
          line: 84,
          column: 12
        },
        end: {
          line: 84,
          column: 28
        }
      },
      "35": {
        start: {
          line: 87,
          column: 29
        },
        end: {
          line: 98,
          column: 9
        }
      },
      "36": {
        start: {
          line: 100,
          column: 34
        },
        end: {
          line: 100,
          column: 74
        }
      },
      "37": {
        start: {
          line: 102,
          column: 22
        },
        end: {
          line: 102,
          column: 53
        }
      },
      "38": {
        start: {
          line: 103,
          column: 26
        },
        end: {
          line: 110,
          column: 10
        }
      },
      "39": {
        start: {
          line: 111,
          column: 8
        },
        end: {
          line: 122,
          column: 16
        }
      },
      "40": {
        start: {
          line: 124,
          column: 8
        },
        end: {
          line: 124,
          column: 54
        }
      },
      "41": {
        start: {
          line: 125,
          column: 8
        },
        end: {
          line: 125,
          column: 57
        }
      },
      "42": {
        start: {
          line: 129,
          column: 4
        },
        end: {
          line: 153,
          column: 5
        }
      },
      "43": {
        start: {
          line: 130,
          column: 21
        },
        end: {
          line: 130,
          column: 68
        }
      },
      "44": {
        start: {
          line: 131,
          column: 24
        },
        end: {
          line: 131,
          column: 73
        }
      },
      "45": {
        start: {
          line: 132,
          column: 33
        },
        end: {
          line: 132,
          column: 53
        }
      },
      "46": {
        start: {
          line: 133,
          column: 22
        },
        end: {
          line: 133,
          column: 92
        }
      },
      "47": {
        start: {
          line: 134,
          column: 23
        },
        end: {
          line: 134,
          column: 79
        }
      },
      "48": {
        start: {
          line: 135,
          column: 22
        },
        end: {
          line: 135,
          column: 53
        }
      },
      "49": {
        start: {
          line: 136,
          column: 23
        },
        end: {
          line: 140,
          column: 10
        }
      },
      "50": {
        start: {
          line: 141,
          column: 8
        },
        end: {
          line: 149,
          column: 11
        }
      },
      "51": {
        start: {
          line: 151,
          column: 8
        },
        end: {
          line: 151,
          column: 60
        }
      },
      "52": {
        start: {
          line: 152,
          column: 8
        },
        end: {
          line: 152,
          column: 57
        }
      },
      "53": {
        start: {
          line: 156,
          column: 4
        },
        end: {
          line: 178,
          column: 5
        }
      },
      "54": {
        start: {
          line: 157,
          column: 21
        },
        end: {
          line: 157,
          column: 38
        }
      },
      "55": {
        start: {
          line: 158,
          column: 8
        },
        end: {
          line: 173,
          column: 9
        }
      },
      "56": {
        start: {
          line: 161,
          column: 30
        },
        end: {
          line: 161,
          column: 74
        }
      },
      "57": {
        start: {
          line: 161,
          column: 62
        },
        end: {
          line: 161,
          column: 73
        }
      },
      "58": {
        start: {
          line: 162,
          column: 16
        },
        end: {
          line: 162,
          column: 53
        }
      },
      "59": {
        start: {
          line: 164,
          column: 29
        },
        end: {
          line: 164,
          column: 45
        }
      },
      "60": {
        start: {
          line: 165,
          column: 16
        },
        end: {
          line: 165,
          column: 61
        }
      },
      "61": {
        start: {
          line: 169,
          column: 16
        },
        end: {
          line: 170,
          column: 17
        }
      },
      "62": {
        start: {
          line: 172,
          column: 16
        },
        end: {
          line: 172,
          column: 25
        }
      },
      "63": {
        start: {
          line: 175,
          column: 8
        },
        end: {
          line: 175,
          column: 64
        }
      },
      "64": {
        start: {
          line: 176,
          column: 8
        },
        end: {
          line: 177,
          column: 9
        }
      }
    },
    fnMap: {
      "0": {
        name: "_export",
        decl: {
          start: {
            line: 5,
            column: 9
          },
          end: {
            line: 5,
            column: 16
          }
        },
        loc: {
          start: {
            line: 5,
            column: 30
          },
          end: {
            line: 10,
            column: 1
          }
        },
        line: 5
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 12,
            column: 4
          },
          end: {
            line: 12,
            column: 5
          }
        },
        loc: {
          start: {
            line: 12,
            column: 15
          },
          end: {
            line: 14,
            column: 5
          }
        },
        line: 12
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 15,
            column: 4
          },
          end: {
            line: 15,
            column: 5
          }
        },
        loc: {
          start: {
            line: 15,
            column: 16
          },
          end: {
            line: 17,
            column: 5
          }
        },
        line: 15
      },
      "3": {
        name: "POST",
        decl: {
          start: {
            line: 23,
            column: 15
          },
          end: {
            line: 23,
            column: 19
          }
        },
        loc: {
          start: {
            line: 23,
            column: 29
          },
          end: {
            line: 127,
            column: 1
          }
        },
        line: 23
      },
      "4": {
        name: "GET",
        decl: {
          start: {
            line: 128,
            column: 15
          },
          end: {
            line: 128,
            column: 18
          }
        },
        loc: {
          start: {
            line: 128,
            column: 28
          },
          end: {
            line: 154,
            column: 1
          }
        },
        line: 128
      },
      "5": {
        name: "estimateContactCount",
        decl: {
          start: {
            line: 155,
            column: 15
          },
          end: {
            line: 155,
            column: 35
          }
        },
        loc: {
          start: {
            line: 155,
            column: 50
          },
          end: {
            line: 179,
            column: 1
          }
        },
        line: 155
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 161,
            column: 54
          },
          end: {
            line: 161,
            column: 55
          }
        },
        loc: {
          start: {
            line: 161,
            column: 62
          },
          end: {
            line: 161,
            column: 73
          }
        },
        line: 161
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 29,
            column: 35
          },
          end: {
            line: 29,
            column: 66
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 29,
            column: 35
          },
          end: {
            line: 29,
            column: 58
          }
        }, {
          start: {
            line: 29,
            column: 62
          },
          end: {
            line: 29,
            column: 66
          }
        }],
        line: 29
      },
      "1": {
        loc: {
          start: {
            line: 30,
            column: 35
          },
          end: {
            line: 30,
            column: 66
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 30,
            column: 35
          },
          end: {
            line: 30,
            column: 58
          }
        }, {
          start: {
            line: 30,
            column: 62
          },
          end: {
            line: 30,
            column: 66
          }
        }],
        line: 30
      },
      "2": {
        loc: {
          start: {
            line: 31,
            column: 8
          },
          end: {
            line: 37,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 31,
            column: 8
          },
          end: {
            line: 37,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 31
      },
      "3": {
        loc: {
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 51,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 51,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 45
      },
      "4": {
        loc: {
          start: {
            line: 55,
            column: 8
          },
          end: {
            line: 61,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 55,
            column: 8
          },
          end: {
            line: 61,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 55
      },
      "5": {
        loc: {
          start: {
            line: 63,
            column: 8
          },
          end: {
            line: 69,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 63,
            column: 8
          },
          end: {
            line: 69,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 63
      },
      "6": {
        loc: {
          start: {
            line: 79,
            column: 8
          },
          end: {
            line: 85,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 79,
            column: 8
          },
          end: {
            line: 85,
            column: 9
          }
        }, {
          start: {
            line: 81,
            column: 15
          },
          end: {
            line: 85,
            column: 9
          }
        }],
        line: 79
      },
      "7": {
        loc: {
          start: {
            line: 79,
            column: 12
          },
          end: {
            line: 79,
            column: 67
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 79,
            column: 12
          },
          end: {
            line: 79,
            column: 37
          }
        }, {
          start: {
            line: 79,
            column: 41
          },
          end: {
            line: 79,
            column: 67
          }
        }],
        line: 79
      },
      "8": {
        loc: {
          start: {
            line: 81,
            column: 15
          },
          end: {
            line: 85,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 81,
            column: 15
          },
          end: {
            line: 85,
            column: 9
          }
        }, {
          start: {
            line: 83,
            column: 15
          },
          end: {
            line: 85,
            column: 9
          }
        }],
        line: 81
      },
      "9": {
        loc: {
          start: {
            line: 81,
            column: 19
          },
          end: {
            line: 81,
            column: 76
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 81,
            column: 19
          },
          end: {
            line: 81,
            column: 45
          }
        }, {
          start: {
            line: 81,
            column: 49
          },
          end: {
            line: 81,
            column: 76
          }
        }],
        line: 81
      },
      "10": {
        loc: {
          start: {
            line: 96,
            column: 24
          },
          end: {
            line: 96,
            column: 44
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 96,
            column: 24
          },
          end: {
            line: 96,
            column: 38
          }
        }, {
          start: {
            line: 96,
            column: 42
          },
          end: {
            line: 96,
            column: 44
          }
        }],
        line: 96
      },
      "11": {
        loc: {
          start: {
            line: 133,
            column: 56
          },
          end: {
            line: 133,
            column: 89
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 133,
            column: 56
          },
          end: {
            line: 133,
            column: 81
          }
        }, {
          start: {
            line: 133,
            column: 85
          },
          end: {
            line: 133,
            column: 89
          }
        }],
        line: 133
      },
      "12": {
        loc: {
          start: {
            line: 134,
            column: 44
          },
          end: {
            line: 134,
            column: 77
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 134,
            column: 44
          },
          end: {
            line: 134,
            column: 70
          }
        }, {
          start: {
            line: 134,
            column: 74
          },
          end: {
            line: 134,
            column: 77
          }
        }],
        line: 134
      },
      "13": {
        loc: {
          start: {
            line: 158,
            column: 8
          },
          end: {
            line: 173,
            column: 9
          }
        },
        type: "switch",
        locations: [{
          start: {
            line: 159,
            column: 12
          },
          end: {
            line: 162,
            column: 53
          }
        }, {
          start: {
            line: 163,
            column: 12
          },
          end: {
            line: 165,
            column: 61
          }
        }, {
          start: {
            line: 166,
            column: 12
          },
          end: {
            line: 170,
            column: 17
          }
        }, {
          start: {
            line: 171,
            column: 12
          },
          end: {
            line: 172,
            column: 25
          }
        }],
        line: 158
      },
      "14": {
        loc: {
          start: {
            line: 165,
            column: 23
          },
          end: {
            line: 165,
            column: 60
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 165,
            column: 45
          },
          end: {
            line: 165,
            column: 56
          }
        }, {
          start: {
            line: 165,
            column: 59
          },
          end: {
            line: 165,
            column: 60
          }
        }],
        line: 165
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0, 0, 0],
      "14": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\contacts\\import\\route.ts"],
      sourcesContent: ["import { NextRequest, NextResponse } from 'next/server'\nimport { requireAuthenticatedUser, getUserOrganization, createErrorResponse, createSuccessResponse } from '@/lib/api-utils'\nimport { BulkOperationQueue, BulkContactImportConfig } from '@/lib/bulk-operations/queue'\nimport { MediaStorageService } from '@/lib/media/storage'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const user = await requireAuthenticatedUser()\n    const profile = await getUserOrganization(user.id)\n\n    const formData = await request.formData()\n    const file = formData.get('file') as File\n    const mapping = JSON.parse(formData.get('mapping') as string || '{}')\n    const options = JSON.parse(formData.get('options') as string || '{}')\n\n    if (!file) {\n      return NextResponse.json(\n        { error: 'File is required' },\n        { status: 400 }\n      )\n    }\n\n    // Validate file type\n    const allowedTypes = [\n      'text/csv',\n      'application/vnd.ms-excel',\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n      'application/json'\n    ]\n\n    if (!allowedTypes.includes(file.type)) {\n      return NextResponse.json(\n        { error: 'Unsupported file type. Please upload CSV, Excel, or JSON files.' },\n        { status: 400 }\n      )\n    }\n\n    // Validate file size (max 10MB)\n    const maxSize = 10 * 1024 * 1024 // 10MB\n    if (file.size > maxSize) {\n      return NextResponse.json(\n        { error: 'File size exceeds 10MB limit' },\n        { status: 400 }\n      )\n    }\n\n    // Validate mapping\n    if (!mapping.phone_number) {\n      return NextResponse.json(\n        { error: 'Phone number field mapping is required' },\n        { status: 400 }\n      )\n    }\n\n    // Upload file to storage\n    const mediaStorage = new MediaStorageService()\n    const buffer = Buffer.from(await file.arrayBuffer())\n\n    const uploadedFile = await mediaStorage.uploadFile(\n      buffer,\n      file.name,\n      file.type,\n      {\n        organizationId: profile.organization_id,\n        uploadedBy: user.id\n      }\n    )\n\n    // Determine file format\n    let format: 'csv' | 'json' | 'xlsx'\n    if (file.type.includes('csv') || file.name.endsWith('.csv')) {\n      format = 'csv'\n    } else if (file.type.includes('json') || file.name.endsWith('.json')) {\n      format = 'json'\n    } else {\n      format = 'xlsx'\n    }\n\n    // Create import configuration\n    const importConfig: BulkContactImportConfig = {\n      file: {\n        url: uploadedFile.url,\n        format\n      },\n      mapping,\n      options: {\n        skipDuplicates: options.skipDuplicates !== false,\n        updateExisting: options.updateExisting === true,\n        tagAll: options.tagAll || []\n      }\n    }\n\n    // Estimate number of contacts\n    const estimatedContacts = await estimateContactCount(file, format)\n\n    // Create bulk operation\n    const queue = new BulkOperationQueue()\n    const operation = await queue.createOperation({\n      organizationId: profile.organization_id,\n      userId: user.id,\n      type: 'bulk_contact_import',\n      status: 'queued',\n      totalItems: estimatedContacts,\n      configuration: importConfig\n    })\n\n    return createSuccessResponse({\n      operation,\n      uploadedFile: {\n        id: uploadedFile.id,\n        name: uploadedFile.originalName,\n        size: uploadedFile.size,\n        url: uploadedFile.url\n      },\n      estimatedContacts,\n      mapping,\n      options: importConfig.options\n    }, 201)\n\n  } catch (error) {\n    console.error('Contact import error:', error)\n    return createErrorResponse(error)\n  }\n}\n\nexport async function GET(request: NextRequest) {\n  try {\n    const user = await requireAuthenticatedUser()\n    const profile = await getUserOrganization(user.id)\n\n    const { searchParams } = new URL(request.url)\n    const limit = Math.min(50, Math.max(1, parseInt(searchParams.get('limit') || '20')))\n    const offset = Math.max(0, parseInt(searchParams.get('offset') || '0'))\n\n    const queue = new BulkOperationQueue()\n    const result = await queue.listOperations(profile.organization_id, {\n      type: 'bulk_contact_import',\n      limit,\n      offset\n    })\n\n    return createSuccessResponse({\n      imports: result.operations,\n      pagination: {\n        limit,\n        offset,\n        total: result.total,\n        hasMore: offset + limit < result.total\n      }\n    })\n\n  } catch (error) {\n    console.error('List contact imports error:', error)\n    return createErrorResponse(error)\n  }\n}\n\nasync function estimateContactCount(file: File, format: string): Promise<number> {\n  try {\n    const text = await file.text()\n\n    switch (format) {\n      case 'csv':\n        // Count lines minus header\n        const lines = text.split('\\n').filter(line => line.trim())\n        return Math.max(0, lines.length - 1)\n\n      case 'json':\n        const data = JSON.parse(text)\n        return Array.isArray(data) ? data.length : 1\n\n      case 'xlsx':\n        // For Excel files, we'll estimate based on file size\n        // This is rough but works for the queue setup\n        return Math.floor(file.size / 100) // ~100 bytes per row\n\n      default:\n        return 1\n    }\n  } catch (error) {\n    console.error('Error estimating contact count:', error)\n    return Math.floor(file.size / 100) // Fallback estimate\n  }\n}"],
      names: ["GET", "POST", "request", "user", "requireAuthenticatedUser", "profile", "getUserOrganization", "id", "formData", "file", "get", "mapping", "JSON", "parse", "options", "NextResponse", "json", "error", "status", "allowedTypes", "includes", "type", "maxSize", "size", "phone_number", "mediaStorage", "MediaStorageService", "buffer", "Buffer", "from", "arrayBuffer", "uploadedFile", "uploadFile", "name", "organizationId", "organization_id", "uploadedBy", "format", "endsWith", "importConfig", "url", "skipDuplicates", "updateExisting", "tagAll", "estimatedContacts", "estimateContactCount", "queue", "BulkOperationQueue", "operation", "createOperation", "userId", "totalItems", "configuration", "createSuccessResponse", "originalName", "console", "createErrorResponse", "searchParams", "URL", "limit", "Math", "min", "max", "parseInt", "offset", "result", "listOperations", "imports", "operations", "pagination", "total", "hasMore", "text", "lines", "split", "filter", "line", "trim", "length", "data", "Array", "isArray", "floor"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "1123f10ecc69aa1da1626550c5a4ee0b88d51040"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2n9if98k8e = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2n9if98k8e();
cov_2n9if98k8e().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
function _export(target, all) {
  /* istanbul ignore next */
  cov_2n9if98k8e().f[0]++;
  cov_2n9if98k8e().s[1]++;
  for (var name in all) {
    /* istanbul ignore next */
    cov_2n9if98k8e().s[2]++;
    Object.defineProperty(target, name, {
      enumerable: true,
      get: Object.getOwnPropertyDescriptor(all, name).get
    });
  }
}
/* istanbul ignore next */
cov_2n9if98k8e().s[3]++;
_export(exports, {
  get GET() {
    /* istanbul ignore next */
    cov_2n9if98k8e().f[1]++;
    cov_2n9if98k8e().s[4]++;
    return GET;
  },
  get POST() {
    /* istanbul ignore next */
    cov_2n9if98k8e().f[2]++;
    cov_2n9if98k8e().s[5]++;
    return POST;
  }
});
const _server =
/* istanbul ignore next */
(cov_2n9if98k8e().s[6]++, require("next/server"));
const _apiutils =
/* istanbul ignore next */
(cov_2n9if98k8e().s[7]++, require("../../../../lib/api-utils"));
const _queue =
/* istanbul ignore next */
(cov_2n9if98k8e().s[8]++, require("../../../../lib/bulk-operations/queue"));
const _storage =
/* istanbul ignore next */
(cov_2n9if98k8e().s[9]++, require("../../../../lib/media/storage"));
async function POST(request) {
  /* istanbul ignore next */
  cov_2n9if98k8e().f[3]++;
  cov_2n9if98k8e().s[10]++;
  try {
    const user =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[11]++, await (0, _apiutils.requireAuthenticatedUser)());
    const profile =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[12]++, await (0, _apiutils.getUserOrganization)(user.id));
    const formData =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[13]++, await request.formData());
    const file =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[14]++, formData.get('file'));
    const mapping =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[15]++, JSON.parse(
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[0][0]++, formData.get('mapping')) ||
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[0][1]++, '{}')));
    const options =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[16]++, JSON.parse(
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[1][0]++, formData.get('options')) ||
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[1][1]++, '{}')));
    /* istanbul ignore next */
    cov_2n9if98k8e().s[17]++;
    if (!file) {
      /* istanbul ignore next */
      cov_2n9if98k8e().b[2][0]++;
      cov_2n9if98k8e().s[18]++;
      return _server.NextResponse.json({
        error: 'File is required'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2n9if98k8e().b[2][1]++;
    }
    // Validate file type
    const allowedTypes =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[19]++, ['text/csv', 'application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/json']);
    /* istanbul ignore next */
    cov_2n9if98k8e().s[20]++;
    if (!allowedTypes.includes(file.type)) {
      /* istanbul ignore next */
      cov_2n9if98k8e().b[3][0]++;
      cov_2n9if98k8e().s[21]++;
      return _server.NextResponse.json({
        error: 'Unsupported file type. Please upload CSV, Excel, or JSON files.'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2n9if98k8e().b[3][1]++;
    }
    // Validate file size (max 10MB)
    const maxSize =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[22]++, 10 * 1024 * 1024) // 10MB
    ;
    /* istanbul ignore next */
    cov_2n9if98k8e().s[23]++;
    if (file.size > maxSize) {
      /* istanbul ignore next */
      cov_2n9if98k8e().b[4][0]++;
      cov_2n9if98k8e().s[24]++;
      return _server.NextResponse.json({
        error: 'File size exceeds 10MB limit'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2n9if98k8e().b[4][1]++;
    }
    // Validate mapping
    cov_2n9if98k8e().s[25]++;
    if (!mapping.phone_number) {
      /* istanbul ignore next */
      cov_2n9if98k8e().b[5][0]++;
      cov_2n9if98k8e().s[26]++;
      return _server.NextResponse.json({
        error: 'Phone number field mapping is required'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2n9if98k8e().b[5][1]++;
    }
    // Upload file to storage
    const mediaStorage =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[27]++, new _storage.MediaStorageService());
    const buffer =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[28]++, Buffer.from(await file.arrayBuffer()));
    const uploadedFile =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[29]++, await mediaStorage.uploadFile(buffer, file.name, file.type, {
      organizationId: profile.organization_id,
      uploadedBy: user.id
    }));
    // Determine file format
    let format;
    /* istanbul ignore next */
    cov_2n9if98k8e().s[30]++;
    if (
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[7][0]++, file.type.includes('csv')) ||
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[7][1]++, file.name.endsWith('.csv'))) {
      /* istanbul ignore next */
      cov_2n9if98k8e().b[6][0]++;
      cov_2n9if98k8e().s[31]++;
      format = 'csv';
    } else {
      /* istanbul ignore next */
      cov_2n9if98k8e().b[6][1]++;
      cov_2n9if98k8e().s[32]++;
      if (
      /* istanbul ignore next */
      (cov_2n9if98k8e().b[9][0]++, file.type.includes('json')) ||
      /* istanbul ignore next */
      (cov_2n9if98k8e().b[9][1]++, file.name.endsWith('.json'))) {
        /* istanbul ignore next */
        cov_2n9if98k8e().b[8][0]++;
        cov_2n9if98k8e().s[33]++;
        format = 'json';
      } else {
        /* istanbul ignore next */
        cov_2n9if98k8e().b[8][1]++;
        cov_2n9if98k8e().s[34]++;
        format = 'xlsx';
      }
    }
    // Create import configuration
    const importConfig =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[35]++, {
      file: {
        url: uploadedFile.url,
        format
      },
      mapping,
      options: {
        skipDuplicates: options.skipDuplicates !== false,
        updateExisting: options.updateExisting === true,
        tagAll:
        /* istanbul ignore next */
        (cov_2n9if98k8e().b[10][0]++, options.tagAll) ||
        /* istanbul ignore next */
        (cov_2n9if98k8e().b[10][1]++, [])
      }
    });
    // Estimate number of contacts
    const estimatedContacts =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[36]++, await estimateContactCount(file, format));
    // Create bulk operation
    const queue =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[37]++, new _queue.BulkOperationQueue());
    const operation =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[38]++, await queue.createOperation({
      organizationId: profile.organization_id,
      userId: user.id,
      type: 'bulk_contact_import',
      status: 'queued',
      totalItems: estimatedContacts,
      configuration: importConfig
    }));
    /* istanbul ignore next */
    cov_2n9if98k8e().s[39]++;
    return (0, _apiutils.createSuccessResponse)({
      operation,
      uploadedFile: {
        id: uploadedFile.id,
        name: uploadedFile.originalName,
        size: uploadedFile.size,
        url: uploadedFile.url
      },
      estimatedContacts,
      mapping,
      options: importConfig.options
    }, 201);
  } catch (error) {
    /* istanbul ignore next */
    cov_2n9if98k8e().s[40]++;
    console.error('Contact import error:', error);
    /* istanbul ignore next */
    cov_2n9if98k8e().s[41]++;
    return (0, _apiutils.createErrorResponse)(error);
  }
}
async function GET(request) {
  /* istanbul ignore next */
  cov_2n9if98k8e().f[4]++;
  cov_2n9if98k8e().s[42]++;
  try {
    const user =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[43]++, await (0, _apiutils.requireAuthenticatedUser)());
    const profile =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[44]++, await (0, _apiutils.getUserOrganization)(user.id));
    const {
      searchParams
    } =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[45]++, new URL(request.url));
    const limit =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[46]++, Math.min(50, Math.max(1, parseInt(
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[11][0]++, searchParams.get('limit')) ||
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[11][1]++, '20')))));
    const offset =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[47]++, Math.max(0, parseInt(
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[12][0]++, searchParams.get('offset')) ||
    /* istanbul ignore next */
    (cov_2n9if98k8e().b[12][1]++, '0'))));
    const queue =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[48]++, new _queue.BulkOperationQueue());
    const result =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[49]++, await queue.listOperations(profile.organization_id, {
      type: 'bulk_contact_import',
      limit,
      offset
    }));
    /* istanbul ignore next */
    cov_2n9if98k8e().s[50]++;
    return (0, _apiutils.createSuccessResponse)({
      imports: result.operations,
      pagination: {
        limit,
        offset,
        total: result.total,
        hasMore: offset + limit < result.total
      }
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_2n9if98k8e().s[51]++;
    console.error('List contact imports error:', error);
    /* istanbul ignore next */
    cov_2n9if98k8e().s[52]++;
    return (0, _apiutils.createErrorResponse)(error);
  }
}
async function estimateContactCount(file, format) {
  /* istanbul ignore next */
  cov_2n9if98k8e().f[5]++;
  cov_2n9if98k8e().s[53]++;
  try {
    const text =
    /* istanbul ignore next */
    (cov_2n9if98k8e().s[54]++, await file.text());
    /* istanbul ignore next */
    cov_2n9if98k8e().s[55]++;
    switch (format) {
      case 'csv':
        /* istanbul ignore next */
        cov_2n9if98k8e().b[13][0]++;
        // Count lines minus header
        const lines =
        /* istanbul ignore next */
        (cov_2n9if98k8e().s[56]++, text.split('\n').filter(line => {
          /* istanbul ignore next */
          cov_2n9if98k8e().f[6]++;
          cov_2n9if98k8e().s[57]++;
          return line.trim();
        }));
        /* istanbul ignore next */
        cov_2n9if98k8e().s[58]++;
        return Math.max(0, lines.length - 1);
      case 'json':
        /* istanbul ignore next */
        cov_2n9if98k8e().b[13][1]++;
        const data =
        /* istanbul ignore next */
        (cov_2n9if98k8e().s[59]++, JSON.parse(text));
        /* istanbul ignore next */
        cov_2n9if98k8e().s[60]++;
        return Array.isArray(data) ?
        /* istanbul ignore next */
        (cov_2n9if98k8e().b[14][0]++, data.length) :
        /* istanbul ignore next */
        (cov_2n9if98k8e().b[14][1]++, 1);
      case 'xlsx':
        /* istanbul ignore next */
        cov_2n9if98k8e().b[13][2]++;
        cov_2n9if98k8e().s[61]++;
        // For Excel files, we'll estimate based on file size
        // This is rough but works for the queue setup
        return Math.floor(file.size / 100) // ~100 bytes per row
        ;
      default:
        /* istanbul ignore next */
        cov_2n9if98k8e().b[13][3]++;
        cov_2n9if98k8e().s[62]++;
        return 1;
    }
  } catch (error) {
    /* istanbul ignore next */
    cov_2n9if98k8e().s[63]++;
    console.error('Error estimating contact count:', error);
    /* istanbul ignore next */
    cov_2n9if98k8e().s[64]++;
    return Math.floor(file.size / 100) // Fallback estimate
    ;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJHRVQiLCJjb3ZfMm45aWY5OGs4ZSIsImYiLCJzIiwiUE9TVCIsInJlcXVlc3QiLCJ1c2VyIiwiX2FwaXV0aWxzIiwicmVxdWlyZUF1dGhlbnRpY2F0ZWRVc2VyIiwicHJvZmlsZSIsImdldFVzZXJPcmdhbml6YXRpb24iLCJpZCIsImZvcm1EYXRhIiwiZmlsZSIsImdldCIsIm1hcHBpbmciLCJKU09OIiwicGFyc2UiLCJiIiwib3B0aW9ucyIsIl9zZXJ2ZXIiLCJOZXh0UmVzcG9uc2UiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJhbGxvd2VkVHlwZXMiLCJpbmNsdWRlcyIsInR5cGUiLCJtYXhTaXplIiwic2l6ZSIsInBob25lX251bWJlciIsIm1lZGlhU3RvcmFnZSIsIl9zdG9yYWdlIiwiTWVkaWFTdG9yYWdlU2VydmljZSIsImJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJhcnJheUJ1ZmZlciIsInVwbG9hZGVkRmlsZSIsInVwbG9hZEZpbGUiLCJuYW1lIiwib3JnYW5pemF0aW9uSWQiLCJvcmdhbml6YXRpb25faWQiLCJ1cGxvYWRlZEJ5IiwiZm9ybWF0IiwiZW5kc1dpdGgiLCJpbXBvcnRDb25maWciLCJ1cmwiLCJza2lwRHVwbGljYXRlcyIsInVwZGF0ZUV4aXN0aW5nIiwidGFnQWxsIiwiZXN0aW1hdGVkQ29udGFjdHMiLCJlc3RpbWF0ZUNvbnRhY3RDb3VudCIsInF1ZXVlIiwiX3F1ZXVlIiwiQnVsa09wZXJhdGlvblF1ZXVlIiwib3BlcmF0aW9uIiwiY3JlYXRlT3BlcmF0aW9uIiwidXNlcklkIiwidG90YWxJdGVtcyIsImNvbmZpZ3VyYXRpb24iLCJjcmVhdGVTdWNjZXNzUmVzcG9uc2UiLCJvcmlnaW5hbE5hbWUiLCJjb25zb2xlIiwiY3JlYXRlRXJyb3JSZXNwb25zZSIsInNlYXJjaFBhcmFtcyIsIlVSTCIsImxpbWl0IiwiTWF0aCIsIm1pbiIsIm1heCIsInBhcnNlSW50Iiwib2Zmc2V0IiwicmVzdWx0IiwibGlzdE9wZXJhdGlvbnMiLCJpbXBvcnRzIiwib3BlcmF0aW9ucyIsInBhZ2luYXRpb24iLCJ0b3RhbCIsImhhc01vcmUiLCJ0ZXh0IiwibGluZXMiLCJzcGxpdCIsImZpbHRlciIsImxpbmUiLCJ0cmltIiwibGVuZ3RoIiwiZGF0YSIsIkFycmF5IiwiaXNBcnJheSIsImZsb29yIl0sInNvdXJjZXMiOlsiQzpcXEFpIFByb2plY3RlblxcQURTYXBwXFxzcmNcXGFwcFxcYXBpXFxjb250YWN0c1xcaW1wb3J0XFxyb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyByZXF1aXJlQXV0aGVudGljYXRlZFVzZXIsIGdldFVzZXJPcmdhbml6YXRpb24sIGNyZWF0ZUVycm9yUmVzcG9uc2UsIGNyZWF0ZVN1Y2Nlc3NSZXNwb25zZSB9IGZyb20gJ0AvbGliL2FwaS11dGlscydcbmltcG9ydCB7IEJ1bGtPcGVyYXRpb25RdWV1ZSwgQnVsa0NvbnRhY3RJbXBvcnRDb25maWcgfSBmcm9tICdAL2xpYi9idWxrLW9wZXJhdGlvbnMvcXVldWUnXG5pbXBvcnQgeyBNZWRpYVN0b3JhZ2VTZXJ2aWNlIH0gZnJvbSAnQC9saWIvbWVkaWEvc3RvcmFnZSdcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcmVxdWlyZUF1dGhlbnRpY2F0ZWRVc2VyKClcbiAgICBjb25zdCBwcm9maWxlID0gYXdhaXQgZ2V0VXNlck9yZ2FuaXphdGlvbih1c2VyLmlkKVxuXG4gICAgY29uc3QgZm9ybURhdGEgPSBhd2FpdCByZXF1ZXN0LmZvcm1EYXRhKClcbiAgICBjb25zdCBmaWxlID0gZm9ybURhdGEuZ2V0KCdmaWxlJykgYXMgRmlsZVxuICAgIGNvbnN0IG1hcHBpbmcgPSBKU09OLnBhcnNlKGZvcm1EYXRhLmdldCgnbWFwcGluZycpIGFzIHN0cmluZyB8fCAne30nKVxuICAgIGNvbnN0IG9wdGlvbnMgPSBKU09OLnBhcnNlKGZvcm1EYXRhLmdldCgnb3B0aW9ucycpIGFzIHN0cmluZyB8fCAne30nKVxuXG4gICAgaWYgKCFmaWxlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdGaWxlIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBmaWxlIHR5cGVcbiAgICBjb25zdCBhbGxvd2VkVHlwZXMgPSBbXG4gICAgICAndGV4dC9jc3YnLFxuICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCcsXG4gICAgICAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQnLFxuICAgICAgJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgXVxuXG4gICAgaWYgKCFhbGxvd2VkVHlwZXMuaW5jbHVkZXMoZmlsZS50eXBlKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnVW5zdXBwb3J0ZWQgZmlsZSB0eXBlLiBQbGVhc2UgdXBsb2FkIENTViwgRXhjZWwsIG9yIEpTT04gZmlsZXMuJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBmaWxlIHNpemUgKG1heCAxME1CKVxuICAgIGNvbnN0IG1heFNpemUgPSAxMCAqIDEwMjQgKiAxMDI0IC8vIDEwTUJcbiAgICBpZiAoZmlsZS5zaXplID4gbWF4U2l6ZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnRmlsZSBzaXplIGV4Y2VlZHMgMTBNQiBsaW1pdCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgbWFwcGluZ1xuICAgIGlmICghbWFwcGluZy5waG9uZV9udW1iZXIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1Bob25lIG51bWJlciBmaWVsZCBtYXBwaW5nIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBVcGxvYWQgZmlsZSB0byBzdG9yYWdlXG4gICAgY29uc3QgbWVkaWFTdG9yYWdlID0gbmV3IE1lZGlhU3RvcmFnZVNlcnZpY2UoKVxuICAgIGNvbnN0IGJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKSlcblxuICAgIGNvbnN0IHVwbG9hZGVkRmlsZSA9IGF3YWl0IG1lZGlhU3RvcmFnZS51cGxvYWRGaWxlKFxuICAgICAgYnVmZmVyLFxuICAgICAgZmlsZS5uYW1lLFxuICAgICAgZmlsZS50eXBlLFxuICAgICAge1xuICAgICAgICBvcmdhbml6YXRpb25JZDogcHJvZmlsZS5vcmdhbml6YXRpb25faWQsXG4gICAgICAgIHVwbG9hZGVkQnk6IHVzZXIuaWRcbiAgICAgIH1cbiAgICApXG5cbiAgICAvLyBEZXRlcm1pbmUgZmlsZSBmb3JtYXRcbiAgICBsZXQgZm9ybWF0OiAnY3N2JyB8ICdqc29uJyB8ICd4bHN4J1xuICAgIGlmIChmaWxlLnR5cGUuaW5jbHVkZXMoJ2NzdicpIHx8IGZpbGUubmFtZS5lbmRzV2l0aCgnLmNzdicpKSB7XG4gICAgICBmb3JtYXQgPSAnY3N2J1xuICAgIH0gZWxzZSBpZiAoZmlsZS50eXBlLmluY2x1ZGVzKCdqc29uJykgfHwgZmlsZS5uYW1lLmVuZHNXaXRoKCcuanNvbicpKSB7XG4gICAgICBmb3JtYXQgPSAnanNvbidcbiAgICB9IGVsc2Uge1xuICAgICAgZm9ybWF0ID0gJ3hsc3gnXG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGltcG9ydCBjb25maWd1cmF0aW9uXG4gICAgY29uc3QgaW1wb3J0Q29uZmlnOiBCdWxrQ29udGFjdEltcG9ydENvbmZpZyA9IHtcbiAgICAgIGZpbGU6IHtcbiAgICAgICAgdXJsOiB1cGxvYWRlZEZpbGUudXJsLFxuICAgICAgICBmb3JtYXRcbiAgICAgIH0sXG4gICAgICBtYXBwaW5nLFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBza2lwRHVwbGljYXRlczogb3B0aW9ucy5za2lwRHVwbGljYXRlcyAhPT0gZmFsc2UsXG4gICAgICAgIHVwZGF0ZUV4aXN0aW5nOiBvcHRpb25zLnVwZGF0ZUV4aXN0aW5nID09PSB0cnVlLFxuICAgICAgICB0YWdBbGw6IG9wdGlvbnMudGFnQWxsIHx8IFtdXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRXN0aW1hdGUgbnVtYmVyIG9mIGNvbnRhY3RzXG4gICAgY29uc3QgZXN0aW1hdGVkQ29udGFjdHMgPSBhd2FpdCBlc3RpbWF0ZUNvbnRhY3RDb3VudChmaWxlLCBmb3JtYXQpXG5cbiAgICAvLyBDcmVhdGUgYnVsayBvcGVyYXRpb25cbiAgICBjb25zdCBxdWV1ZSA9IG5ldyBCdWxrT3BlcmF0aW9uUXVldWUoKVxuICAgIGNvbnN0IG9wZXJhdGlvbiA9IGF3YWl0IHF1ZXVlLmNyZWF0ZU9wZXJhdGlvbih7XG4gICAgICBvcmdhbml6YXRpb25JZDogcHJvZmlsZS5vcmdhbml6YXRpb25faWQsXG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICB0eXBlOiAnYnVsa19jb250YWN0X2ltcG9ydCcsXG4gICAgICBzdGF0dXM6ICdxdWV1ZWQnLFxuICAgICAgdG90YWxJdGVtczogZXN0aW1hdGVkQ29udGFjdHMsXG4gICAgICBjb25maWd1cmF0aW9uOiBpbXBvcnRDb25maWdcbiAgICB9KVxuXG4gICAgcmV0dXJuIGNyZWF0ZVN1Y2Nlc3NSZXNwb25zZSh7XG4gICAgICBvcGVyYXRpb24sXG4gICAgICB1cGxvYWRlZEZpbGU6IHtcbiAgICAgICAgaWQ6IHVwbG9hZGVkRmlsZS5pZCxcbiAgICAgICAgbmFtZTogdXBsb2FkZWRGaWxlLm9yaWdpbmFsTmFtZSxcbiAgICAgICAgc2l6ZTogdXBsb2FkZWRGaWxlLnNpemUsXG4gICAgICAgIHVybDogdXBsb2FkZWRGaWxlLnVybFxuICAgICAgfSxcbiAgICAgIGVzdGltYXRlZENvbnRhY3RzLFxuICAgICAgbWFwcGluZyxcbiAgICAgIG9wdGlvbnM6IGltcG9ydENvbmZpZy5vcHRpb25zXG4gICAgfSwgMjAxKVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQ29udGFjdCBpbXBvcnQgZXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoZXJyb3IpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCByZXF1aXJlQXV0aGVudGljYXRlZFVzZXIoKVxuICAgIGNvbnN0IHByb2ZpbGUgPSBhd2FpdCBnZXRVc2VyT3JnYW5pemF0aW9uKHVzZXIuaWQpXG5cbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgICBjb25zdCBsaW1pdCA9IE1hdGgubWluKDUwLCBNYXRoLm1heCgxLCBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICcyMCcpKSlcbiAgICBjb25zdCBvZmZzZXQgPSBNYXRoLm1heCgwLCBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdvZmZzZXQnKSB8fCAnMCcpKVxuXG4gICAgY29uc3QgcXVldWUgPSBuZXcgQnVsa09wZXJhdGlvblF1ZXVlKClcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWV1ZS5saXN0T3BlcmF0aW9ucyhwcm9maWxlLm9yZ2FuaXphdGlvbl9pZCwge1xuICAgICAgdHlwZTogJ2J1bGtfY29udGFjdF9pbXBvcnQnLFxuICAgICAgbGltaXQsXG4gICAgICBvZmZzZXRcbiAgICB9KVxuXG4gICAgcmV0dXJuIGNyZWF0ZVN1Y2Nlc3NSZXNwb25zZSh7XG4gICAgICBpbXBvcnRzOiByZXN1bHQub3BlcmF0aW9ucyxcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgbGltaXQsXG4gICAgICAgIG9mZnNldCxcbiAgICAgICAgdG90YWw6IHJlc3VsdC50b3RhbCxcbiAgICAgICAgaGFzTW9yZTogb2Zmc2V0ICsgbGltaXQgPCByZXN1bHQudG90YWxcbiAgICAgIH1cbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignTGlzdCBjb250YWN0IGltcG9ydHMgZXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoZXJyb3IpXG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gZXN0aW1hdGVDb250YWN0Q291bnQoZmlsZTogRmlsZSwgZm9ybWF0OiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHRleHQgPSBhd2FpdCBmaWxlLnRleHQoKVxuXG4gICAgc3dpdGNoIChmb3JtYXQpIHtcbiAgICAgIGNhc2UgJ2Nzdic6XG4gICAgICAgIC8vIENvdW50IGxpbmVzIG1pbnVzIGhlYWRlclxuICAgICAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgICAgICByZXR1cm4gTWF0aC5tYXgoMCwgbGluZXMubGVuZ3RoIC0gMSlcblxuICAgICAgY2FzZSAnanNvbic6XG4gICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHRleHQpXG4gICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KGRhdGEpID8gZGF0YS5sZW5ndGggOiAxXG5cbiAgICAgIGNhc2UgJ3hsc3gnOlxuICAgICAgICAvLyBGb3IgRXhjZWwgZmlsZXMsIHdlJ2xsIGVzdGltYXRlIGJhc2VkIG9uIGZpbGUgc2l6ZVxuICAgICAgICAvLyBUaGlzIGlzIHJvdWdoIGJ1dCB3b3JrcyBmb3IgdGhlIHF1ZXVlIHNldHVwXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKGZpbGUuc2l6ZSAvIDEwMCkgLy8gfjEwMCBieXRlcyBwZXIgcm93XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAxXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGVzdGltYXRpbmcgY29udGFjdCBjb3VudDonLCBlcnJvcilcbiAgICByZXR1cm4gTWF0aC5mbG9vcihmaWxlLnNpemUgLyAxMDApIC8vIEZhbGxiYWNrIGVzdGltYXRlXG4gIH1cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O01BNkhzQkEsSUFB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