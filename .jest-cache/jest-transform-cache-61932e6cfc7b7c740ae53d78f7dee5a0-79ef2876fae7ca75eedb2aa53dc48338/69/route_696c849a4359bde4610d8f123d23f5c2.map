{"version":3,"names":["GET","cov_t0679hq11","f","s","POST","request","data","json","b","_server","NextResponse","error","status","supabase","_server1","createClient","user","auth","getUser","analyticsData","user_id","id","session_id","headers","get","ip_address","user_agent","timestamp","Date","toISOString","Promise","allSettled","sendToGoogleAnalytics","sendToCustomAnalytics","success","console","process","env","GA_MEASUREMENT_ID","params","URLSearchParams","v","tid","cid","t","ec","ea","type","el","name","ev","String","Math","round","value","duration","fetch","method","body","CUSTOM_ANALYTICS_ENDPOINT","CUSTOM_ANALYTICS_API_KEY","JSON","stringify","searchParams","URL","url","timeframe","metric","now","startTime","getTime","web_vitals","cls","avg","p50","p75","p90","p95","count","fcp","fid","lcp","ttfb","api_calls","custom_timings","errors","user_interactions","navigation_timing","total_records","note","aggregateAnalytics","_timeframe","aggregated","forEach","record","push","Object","keys","key","values","length","reduce","a","percentile","arr","p","sorted","sort","index","ceil"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\analytics\\performance\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createClient } from '@/lib/supabase/server'\nimport { Database } from '@/types/database'\nimport { SupabaseClient } from '@supabase/supabase-js'\n\ntype TypedSupabaseClient = SupabaseClient<Database>\n\nexport async function POST(request: NextRequest) {\n  try {\n    const data = await request.json()\n\n    // Validate the data\n    if (!data || typeof data !== 'object') {\n      return NextResponse.json(\n        { error: 'Invalid data format' },\n        { status: 400 }\n      )\n    }\n\n    // Get user context if available\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    // Prepare the analytics data\n    const analyticsData = {\n      ...data,\n      user_id: user?.id || null,\n      session_id: request.headers.get('x-session-id'),\n      ip_address: request.headers.get('x-forwarded-for') ||\n                   request.headers.get('x-real-ip') ||\n                   'unknown',\n      user_agent: request.headers.get('user-agent'),\n      timestamp: new Date().toISOString(),\n    }\n\n    // TODO WEEK 5+: Create performance_analytics table for advanced analytics\n    // Store in database (you might want to use a separate analytics DB)\n    // const { error: dbError } = await supabase\n    //   .from('performance_analytics')\n    //   .insert(analyticsData)\n\n    // if (dbError) {\n    //   console.error('Failed to store performance analytics:', dbError)\n    //   // Don't fail the request for analytics errors\n    // }\n\n    // Send to external analytics services\n    await Promise.allSettled([\n      sendToGoogleAnalytics(analyticsData),\n      sendToCustomAnalytics(analyticsData),\n    ])\n\n    return NextResponse.json({ success: true })\n\n  } catch (error) {\n    console.error('Performance analytics error:', error)\n\n    // Return success even on error to not affect user experience\n    return NextResponse.json({ success: true })\n  }\n}\n\ninterface AnalyticsData {\n  user_id?: string | null;\n  session_id?: string | null;\n  ip_address?: string;\n  user_agent?: string | null;\n  timestamp: string;\n  [key: string]: unknown;\n}\n\nasync function sendToGoogleAnalytics(data: AnalyticsData) {\n  // Send to Google Analytics Measurement Protocol\n  if (process.env.GA_MEASUREMENT_ID) {\n    try {\n      const params = new URLSearchParams({\n        v: '1',\n        tid: process.env.GA_MEASUREMENT_ID,\n        cid: data.user_id || 'anonymous',\n        t: 'event',\n        ec: 'Performance',\n        ea: (data.type as string) || 'unknown',\n        el: (data.name as string) || '',\n        ev: String(Math.round((data.value as number) || (data.duration as number) || 0)),\n      })\n\n      await fetch('https://www.google-analytics.com/collect', {\n        method: 'POST',\n        body: params,\n      })\n    } catch (error) {\n      console.error('GA analytics error:', error)\n    }\n  }\n}\n\nasync function sendToCustomAnalytics(data: AnalyticsData) {\n  // Send to your custom analytics service\n  // This could be DataDog, New Relic, etc.\n\n  if (process.env.CUSTOM_ANALYTICS_ENDPOINT) {\n    try {\n      await fetch(process.env.CUSTOM_ANALYTICS_ENDPOINT, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${process.env.CUSTOM_ANALYTICS_API_KEY}`,\n        },\n        body: JSON.stringify(data),\n      })\n    } catch (error) {\n      console.error('Custom analytics error:', error)\n    }\n  }\n}\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const timeframe = searchParams.get('timeframe') || '24h'\n    const metric = searchParams.get('metric')\n\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    if (!user) {\n      return NextResponse.json(\n        { error: 'Unauthorized' },\n        { status: 401 }\n      )\n    }\n\n    // Calculate time range\n    const now = new Date()\n    let startTime: Date\n\n    switch (timeframe) {\n      case '1h':\n        startTime = new Date(now.getTime() - 60 * 60 * 1000)\n        break\n      case '24h':\n        startTime = new Date(now.getTime() - 24 * 60 * 60 * 1000)\n        break\n      case '7d':\n        startTime = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000)\n        break\n      case '30d':\n        startTime = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000)\n        break\n      default:\n        startTime = new Date(now.getTime() - 24 * 60 * 60 * 1000)\n    }\n\n    // TODO WEEK 5+: Implement performance_analytics table for GET endpoint\n    // For now, return mock data structure until table is created\n    return NextResponse.json({\n      data: {\n        web_vitals: {\n          cls: { avg: 0, p50: 0, p75: 0, p90: 0, p95: 0, count: 0 },\n          fcp: { avg: 0, p50: 0, p75: 0, p90: 0, p95: 0, count: 0 },\n          fid: { avg: 0, p50: 0, p75: 0, p90: 0, p95: 0, count: 0 },\n          lcp: { avg: 0, p50: 0, p75: 0, p90: 0, p95: 0, count: 0 },\n          ttfb: { avg: 0, p50: 0, p75: 0, p90: 0, p95: 0, count: 0 },\n        },\n        api_calls: [],\n        custom_timings: [],\n        errors: [],\n        user_interactions: [],\n        navigation_timing: [],\n      },\n      timeframe,\n      metric,\n      total_records: 0,\n      note: 'Performance analytics table not yet created - returning placeholder data'\n    })\n\n    // Build query - COMMENTED OUT until performance_analytics table is created\n    // let query = supabase\n    //   .from('performance_analytics')\n    //   .select('*')\n    //   .gte('timestamp', startTime.toISOString())\n    //   .lte('timestamp', now.toISOString())\n\n    // if (metric) {\n    //   query = query.eq('type', metric)\n    // }\n\n    // const { data: analytics, error } = await query\n    //   .order('timestamp', { ascending: false })\n    //   .limit(1000)\n\n    // if (error) {\n    //   throw error\n    // }\n\n    // // Aggregate the data\n    // const aggregatedData = aggregateAnalytics(analytics || [], timeframe)\n\n    // return NextResponse.json({\n    //   data: aggregatedData,\n    //   timeframe,\n    //   metric,\n    //   total_records: analytics?.length || 0,\n    // })\n\n  } catch (error) {\n    console.error('Analytics fetch error:', error)\n    return NextResponse.json(\n      { error: 'Failed to fetch analytics data' },\n      { status: 500 }\n    )\n  }\n}\n\ninterface AggregatedData {\n  web_vitals: {\n    cls: number[];\n    fcp: number[];\n    fid: number[];\n    lcp: number[];\n    ttfb: number[];\n  };\n  api_calls: unknown[];\n  custom_timings: unknown[];\n  errors: unknown[];\n  user_interactions: unknown[];\n  navigation_timing: unknown[];\n  [key: string]: unknown;\n}\n\nfunction aggregateAnalytics(data: AnalyticsData[], _timeframe: string): AggregatedData {\n  const aggregated: AggregatedData = {\n    web_vitals: {\n      cls: [],\n      fcp: [],\n      fid: [],\n      lcp: [],\n      ttfb: [],\n    },\n    api_calls: [],\n    custom_timings: [],\n    errors: [],\n    user_interactions: [],\n    navigation_timing: [],\n  }\n\n  data.forEach(record => {\n    switch (record.type) {\n      case 'CLS':\n        aggregated.web_vitals.cls.push(record.value as number)\n        break\n      case 'FCP':\n        aggregated.web_vitals.fcp.push(record.value as number)\n        break\n      case 'FID':\n        aggregated.web_vitals.fid.push(record.value as number)\n        break\n      case 'LCP':\n        aggregated.web_vitals.lcp.push(record.value as number)\n        break\n      case 'TTFB':\n        aggregated.web_vitals.ttfb.push(record.value as number)\n        break\n      case 'api-call':\n        (aggregated.api_calls as AnalyticsData[]).push(record)\n        break\n      case 'custom-timing':\n        (aggregated.custom_timings as AnalyticsData[]).push(record)\n        break\n      case 'error':\n        (aggregated.errors as AnalyticsData[]).push(record)\n        break\n      case 'user-interaction':\n        (aggregated.user_interactions as AnalyticsData[]).push(record)\n        break\n      case 'navigation-timing':\n        (aggregated.navigation_timing as AnalyticsData[]).push(record)\n        break\n    }\n  })\n\n  // Calculate statistics\n  Object.keys(aggregated.web_vitals).forEach(key => {\n    const values = aggregated.web_vitals[key as keyof typeof aggregated.web_vitals] as number[]\n    if (values.length > 0) {\n      (aggregated.web_vitals as Record<string, unknown>)[key] = {\n        avg: values.reduce((a: number, b: number) => a + b, 0) / values.length,\n        p50: percentile(values, 0.5),\n        p75: percentile(values, 0.75),\n        p90: percentile(values, 0.9),\n        p95: percentile(values, 0.95),\n        count: values.length,\n      }\n    }\n  })\n\n  return aggregated\n}\n\nfunction percentile(arr: number[], p: number): number {\n  if (arr.length === 0) return 0\n\n  const sorted = [...arr].sort((a, b) => a - b)\n  const index = Math.ceil(sorted.length * p) - 1\n  return sorted[index]\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}