{"version":3,"names":["GET","cov_x9sej1i2d","f","s","OPTIONS","PATCH","POST","request","params","token","b","length","_server","NextResponse","json","success","error","status","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseServiceKey","SUPABASE_SERVICE_ROLE_KEY","console","supabase","_supabasejs","createClient","sessionManager","_demo","DemoSessionManager","result","getSession","session","now","Date","expiresAt","expires_at","timeRemainingMs","getTime","timeRemainingMinutes","Math","max","floor","trackEvent","id","event_type","action","category","label","business_scenario","response","data","is_valid","isValid","time_remaining_minutes","body","step","feature_used","metadata","updateResult","updateProgress","progress_updated","extend_minutes","reason","extensionCount","analytics","events","filter","event","currentExpiry","newExpiry","value","new_expiry","toISOString","extended_by_minutes","extensions_remaining","headers"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\demo\\status\\[token]\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createClient } from '@supabase/supabase-js'\nimport { DemoSessionManager } from '@/lib/demo'\nimport { DemoStatusResponse } from '@/types/demo'\n\n/**\n * Get demo session status and validity\n * GET /api/demo/status/[token]\n */\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ token: string }> }\n) {\n  try {\n    const { token } = await params\n\n    // Validate token format\n    if (!token || token.length < 10) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Invalid session token'\n        } as DemoStatusResponse,\n        { status: 400 }\n      )\n    }\n\n    // Initialize Supabase client\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n\n    if (!supabaseUrl || !supabaseServiceKey) {\n      console.error('Missing Supabase configuration')\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Service configuration error'\n        } as DemoStatusResponse,\n        { status: 500 }\n      )\n    }\n\n    const supabase = createClient(supabaseUrl, supabaseServiceKey)\n\n    // Get session status\n    const sessionManager = new DemoSessionManager(supabase)\n    const result = await sessionManager.getSession(token)\n\n    if (!result.session) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: result.error || 'Session not found'\n        } as DemoStatusResponse,\n        { status: 404 }\n      )\n    }\n\n    // Calculate time remaining\n    const now = new Date()\n    const expiresAt = new Date(result.session.expires_at)\n    const timeRemainingMs = expiresAt.getTime() - now.getTime()\n    const timeRemainingMinutes = Math.max(0, Math.floor(timeRemainingMs / (1000 * 60)))\n\n    // Track status check event\n    await sessionManager.trackEvent(result.session.id, {\n      event_type: 'api_call',\n      action: 'session_status_checked',\n      category: 'demo',\n      label: result.session.business_scenario\n    })\n\n    const response: DemoStatusResponse = {\n      success: true,\n      data: {\n        session: result.session,\n        is_valid: result.isValid,\n        time_remaining_minutes: timeRemainingMinutes\n      }\n    }\n\n    return NextResponse.json(response)\n\n  } catch (error) {\n    console.error('Error checking demo session status:', error)\n\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Failed to check session status'\n      } as DemoStatusResponse,\n      { status: 500 }\n    )\n  }\n}\n\n/**\n * Update demo session progress and activity\n * PATCH /api/demo/status/[token]\n */\nexport async function PATCH(\n  request: NextRequest,\n  { params }: { params: Promise<{ token: string }> }\n) {\n  try {\n    const { token } = await params\n    const body = await request.json()\n\n    // Validate token\n    if (!token || token.length < 10) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Invalid session token'\n        },\n        { status: 400 }\n      )\n    }\n\n    // Validate request body\n    const { step, feature_used, metadata } = body\n\n    if (!step) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Step is required for progress update'\n        },\n        { status: 400 }\n      )\n    }\n\n    // Initialize Supabase client\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n\n    if (!supabaseUrl || !supabaseServiceKey) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Service configuration error'\n        },\n        { status: 500 }\n      )\n    }\n\n    const supabase = createClient(supabaseUrl, supabaseServiceKey)\n\n    // Update session progress\n    const sessionManager = new DemoSessionManager(supabase)\n    const updateResult = await sessionManager.updateProgress(\n      token,\n      step,\n      feature_used,\n      metadata\n    )\n\n    if (!updateResult) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Failed to update progress - session may be invalid or expired'\n        },\n        { status: 400 }\n      )\n    }\n\n    // Get updated session status\n    const result = await sessionManager.getSession(token)\n\n    if (!result.session) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Session not found after update'\n        },\n        { status: 404 }\n      )\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: {\n        session: result.session,\n        is_valid: result.isValid,\n        progress_updated: true\n      }\n    })\n\n  } catch (error) {\n    console.error('Error updating demo session progress:', error)\n\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Failed to update session progress'\n      },\n      { status: 500 }\n    )\n  }\n}\n\n/**\n * Extend demo session duration (limited usage)\n * POST /api/demo/status/[token]/extend\n */\nexport async function POST(\n  request: NextRequest,\n  { params }: { params: Promise<{ token: string }> }\n) {\n  try {\n    const { token } = await params\n    const body = await request.json()\n\n    // Validate token\n    if (!token || token.length < 10) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Invalid session token'\n        },\n        { status: 400 }\n      )\n    }\n\n    // Validate extension request\n    const { extend_minutes = 15, reason } = body\n\n    if (extend_minutes > 30) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Cannot extend session by more than 30 minutes'\n        },\n        { status: 400 }\n      )\n    }\n\n    // Initialize Supabase client\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n\n    if (!supabaseUrl || !supabaseServiceKey) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Service configuration error'\n        },\n        { status: 500 }\n      )\n    }\n\n    const supabase = createClient(supabaseUrl, supabaseServiceKey)\n\n    // Get current session\n    const sessionManager = new DemoSessionManager(supabase)\n    const result = await sessionManager.getSession(token)\n\n    if (!result.session || !result.isValid) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Session not found or invalid'\n        },\n        { status: 404 }\n      )\n    }\n\n    // Check if session can be extended (limit extensions)\n    const extensionCount = result.session.analytics.events.filter(\n      event => event.action === 'session_extended'\n    ).length\n\n    if (extensionCount >= 2) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Maximum session extensions reached'\n        },\n        { status: 400 }\n      )\n    }\n\n    // Extend session expiration\n    const currentExpiry = new Date(result.session.expires_at)\n    const newExpiry = new Date(currentExpiry.getTime() + extend_minutes * 60 * 1000)\n\n    // Update session (this would require implementing an updateSessionExpiry method)\n    // For now, we'll track the extension event\n    await sessionManager.trackEvent(result.session.id, {\n      event_type: 'feature_interaction',\n      action: 'session_extended',\n      category: 'demo',\n      label: result.session.business_scenario,\n      value: extend_minutes,\n      metadata: { reason, new_expiry: newExpiry.toISOString() }\n    })\n\n    return NextResponse.json({\n      success: true,\n      data: {\n        extended_by_minutes: extend_minutes,\n        new_expiry: newExpiry.toISOString(),\n        extensions_remaining: 2 - extensionCount - 1\n      }\n    })\n\n  } catch (error) {\n    console.error('Error extending demo session:', error)\n\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Failed to extend session'\n      },\n      { status: 500 }\n    )\n  }\n}\n\n/**\n * OPTIONS handler for CORS\n */\nexport async function OPTIONS(request: NextRequest) {\n  return new NextResponse(null, {\n    status: 200,\n    headers: {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'GET, PATCH, POST, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n    },\n  })\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}