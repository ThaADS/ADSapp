{"version":3,"names":["cov_jzt2rxvuq","actualCoverage","s","WhatsAppClient","constructor","accessToken","phoneNumberId","f","baseUrl","sendMessage","to","message","response","fetch","method","headers","body","JSON","stringify","messaging_product","ok","b","error","json","Error","sendTextMessage","text","type","sendTemplateMessage","templateName","languageCode","components","template","name","language","code","sendImageMessage","imageUrl","caption","image","link","sendDocumentMessage","documentUrl","filename","document","markAsRead","messageId","status","message_id","getMedia","mediaId","downloadMedia","mediaUrl"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\lib\\whatsapp\\client.ts"],"sourcesContent":["export class WhatsAppClient {\n  private accessToken: string\n  private phoneNumberId: string\n  private baseUrl = 'https://graph.facebook.com/v18.0'\n\n  constructor(accessToken: string, phoneNumberId: string) {\n    this.accessToken = accessToken\n    this.phoneNumberId = phoneNumberId\n  }\n\n  async sendMessage(to: string, message: {\n    type: 'text' | 'template' | 'media' | 'image' | 'document'\n    text?: { body: string }\n    template?: {\n      name: string\n      language: { code: string }\n      components?: Record<string, unknown>[]\n    }\n    image?: {\n      link?: string\n      caption?: string\n    }\n    document?: {\n      link: string\n      filename?: string\n      caption?: string\n    }\n  }) {\n    const response = await fetch(`${this.baseUrl}/${this.phoneNumberId}/messages`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${this.accessToken}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        messaging_product: 'whatsapp',\n        to,\n        ...message,\n      }),\n    })\n\n    if (!response.ok) {\n      const error = await response.json()\n      throw new Error(`WhatsApp API Error: ${error.error?.message || 'Unknown error'}`)\n    }\n\n    return response.json()\n  }\n\n  async sendTextMessage(to: string, text: string) {\n    return this.sendMessage(to, {\n      type: 'text',\n      text: { body: text },\n    })\n  }\n\n  async sendTemplateMessage(to: string, templateName: string, languageCode = 'en', components: Record<string, unknown>[] = []) {\n    return this.sendMessage(to, {\n      type: 'template',\n      template: {\n        name: templateName,\n        language: { code: languageCode },\n        components,\n      },\n    })\n  }\n\n  async sendImageMessage(to: string, imageUrl: string, caption?: string) {\n    return this.sendMessage(to, {\n      type: 'image',\n      image: {\n        link: imageUrl,\n        caption,\n      },\n    })\n  }\n\n  async sendDocumentMessage(to: string, documentUrl: string, filename?: string, caption?: string) {\n    return this.sendMessage(to, {\n      type: 'document',\n      document: {\n        link: documentUrl,\n        filename,\n        caption,\n      },\n    })\n  }\n\n  async markAsRead(messageId: string) {\n    const response = await fetch(`${this.baseUrl}/${this.phoneNumberId}/messages`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${this.accessToken}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        messaging_product: 'whatsapp',\n        status: 'read',\n        message_id: messageId,\n      }),\n    })\n\n    if (!response.ok) {\n      const error = await response.json()\n      throw new Error(`WhatsApp API Error: ${error.error?.message || 'Unknown error'}`)\n    }\n\n    return response.json()\n  }\n\n  async getMedia(mediaId: string) {\n    const response = await fetch(`${this.baseUrl}/${mediaId}`, {\n      headers: {\n        'Authorization': `Bearer ${this.accessToken}`,\n      },\n    })\n\n    if (!response.ok) {\n      const error = await response.json()\n      throw new Error(`WhatsApp API Error: ${error.error?.message || 'Unknown error'}`)\n    }\n\n    return response.json()\n  }\n\n  async downloadMedia(mediaUrl: string) {\n    const response = await fetch(mediaUrl, {\n      headers: {\n        'Authorization': `Bearer ${this.accessToken}`,\n      },\n    })\n\n    if (!response.ok) {\n      throw new Error('Failed to download media')\n    }\n\n    return response\n  }\n}"],"mappings":"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","ignoreList":[]}