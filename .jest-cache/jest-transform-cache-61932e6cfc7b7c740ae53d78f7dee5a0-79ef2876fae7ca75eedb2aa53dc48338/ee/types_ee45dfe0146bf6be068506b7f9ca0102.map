{"version":3,"names":["cov_1xjxdcs0o6","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","branchMap","s","f","b","inputSourceMap","version","sources","sourcesContent","names","mappings","_coverageSchema","coverage","actualCoverage"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\lib\\gdpr\\types.ts"],"sourcesContent":["/**\n * GDPR Compliance Types\n *\n * Type definitions for GDPR data retention, deletion, and export functionality.\n * Implements: Right to access, Right to erasure, Right to data portability\n *\n * @module gdpr/types\n */\n\n/**\n * Data types subject to retention policies\n */\nexport type DataType =\n  | 'messages'\n  | 'contacts'\n  | 'conversations'\n  | 'sessions'\n  | 'audit_logs'\n  | 'analytics'\n  | 'media_files'\n  | 'demo_data';\n\n/**\n * Deletion request types\n */\nexport type DeletionRequestType =\n  | 'user_account'        // Delete entire user account\n  | 'contact_data'        // Delete specific contact\n  | 'conversation_data'   // Delete conversation history\n  | 'all_personal_data';  // Delete all personal data (GDPR Right to Erasure)\n\n/**\n * Deletion request status\n */\nexport type DeletionStatus =\n  | 'pending'       // Request created, awaiting verification\n  | 'verified'      // Identity verified, awaiting processing\n  | 'in_progress'   // Deletion in progress\n  | 'completed'     // Successfully completed\n  | 'failed'        // Failed with error\n  | 'cancelled';    // Cancelled by user or admin\n\n/**\n * Deletion action types for audit trail\n */\nexport type DeletionActionType =\n  | 'soft_delete'              // Set deleted_at timestamp\n  | 'hard_delete'              // Permanently remove from database\n  | 'anonymize'                // Replace with anonymized data\n  | 'export_before_delete'     // Export data before deletion\n  | 'retention_policy_delete'; // Deleted by retention policy\n\n/**\n * GDPR legal basis for processing\n */\nexport type GDPRLegalBasis =\n  | 'consent'             // User consent\n  | 'contract'            // Necessary for contract\n  | 'legal_obligation'    // Legal requirement\n  | 'vital_interests'     // Protect vital interests\n  | 'public_task'         // Public interest task\n  | 'legitimate_interests'; // Legitimate interests\n\n/**\n * Data retention policy\n */\nexport interface DataRetentionPolicy {\n  id: string;\n  organization_id: string | null; // null = system default\n  data_type: DataType;\n  retention_days: number;\n  is_active: boolean;\n  enforcement_enabled: boolean;\n  auto_delete_enabled: boolean;\n  last_enforced_at: string | null;\n  created_by: string | null;\n  created_at: string;\n  updated_at: string;\n}\n\n/**\n * Default retention policy (system-wide)\n */\nexport interface DefaultRetentionPolicy {\n  id: string;\n  data_type: DataType;\n  retention_days: number;\n  legal_requirement: boolean;\n  description: string | null;\n  created_at: string;\n  updated_at: string;\n}\n\n/**\n * Deletion request\n */\nexport interface DeletionRequest {\n  id: string;\n  organization_id: string;\n  user_id: string | null;\n  contact_id: string | null;\n  request_type: DeletionRequestType;\n  status: DeletionStatus;\n  reason: string | null;\n  verification_token: string | null;\n  verification_expires_at: string | null;\n  verified_at: string | null;\n  requested_by: string | null;\n  processed_by: string | null;\n  started_at: string | null;\n  completed_at: string | null;\n  failed_reason: string | null;\n  records_deleted: RecordsDeletionSummary;\n  created_at: string;\n  updated_at: string;\n}\n\n/**\n * Summary of deleted records\n */\nexport interface RecordsDeletionSummary {\n  profiles?: number;\n  contacts?: number;\n  conversations?: number;\n  messages?: number;\n  media_files?: number;\n  sessions?: number;\n  total: number;\n}\n\n/**\n * Deletion audit log entry\n */\nexport interface DeletionAuditLog {\n  id: string;\n  organization_id: string;\n  deletion_request_id: string | null;\n  action_type: DeletionActionType;\n  table_name: string;\n  record_id: string;\n  record_data: any | null; // Encrypted snapshot of deleted data\n  deleted_by: string | null;\n  deletion_reason: string;\n  is_reversible: boolean;\n  legal_basis: GDPRLegalBasis | null;\n  created_at: string;\n  ip_address: string | null;\n  user_agent: string | null;\n}\n\n/**\n * Retention policy creation input\n */\nexport interface CreateRetentionPolicyInput {\n  organization_id: string;\n  data_type: DataType;\n  retention_days: number;\n  enforcement_enabled?: boolean;\n  auto_delete_enabled?: boolean;\n}\n\n/**\n * Retention policy update input\n */\nexport interface UpdateRetentionPolicyInput {\n  retention_days?: number;\n  is_active?: boolean;\n  enforcement_enabled?: boolean;\n  auto_delete_enabled?: boolean;\n}\n\n/**\n * Deletion request creation input\n */\nexport interface CreateDeletionRequestInput {\n  organization_id: string;\n  request_type: DeletionRequestType;\n  user_id?: string;\n  contact_id?: string;\n  reason?: string;\n}\n\n/**\n * Expired record information\n */\nexport interface ExpiredRecord {\n  id: string;\n  created_at: string;\n  age_days: number;\n}\n\n/**\n * Data export format\n */\nexport type ExportFormat = 'json' | 'csv' | 'pdf';\n\n/**\n * Data export request\n */\nexport interface DataExportRequest {\n  organization_id: string;\n  user_id?: string;\n  contact_id?: string;\n  include_messages?: boolean;\n  include_contacts?: boolean;\n  include_conversations?: boolean;\n  include_profile?: boolean;\n  format: ExportFormat;\n}\n\n/**\n * Data export result\n */\nexport interface DataExportResult {\n  format: ExportFormat;\n  filename: string;\n  data: any;\n  generated_at: string;\n  expires_at: string;\n  download_url?: string;\n  size_bytes: number;\n}\n\n/**\n * Personal data package (GDPR Article 20)\n */\nexport interface PersonalDataPackage {\n  user_profile?: any;\n  contacts?: any[];\n  conversations?: any[];\n  messages?: any[];\n  media_files?: any[];\n  settings?: any;\n  metadata: {\n    exported_at: string;\n    format: string;\n    version: string;\n    organization: string;\n  };\n}\n\n/**\n * Retention enforcement result\n */\nexport interface RetentionEnforcementResult {\n  organization_id: string;\n  data_type: DataType;\n  records_found: number;\n  records_deleted: number;\n  oldest_record_age_days: number | null;\n  enforcement_time_ms: number;\n  errors: string[];\n}\n\n/**\n * Deletion service options\n */\nexport interface DeletionServiceOptions {\n  soft_delete?: boolean; // Default: true\n  cascade?: boolean;     // Delete related records\n  create_backup?: boolean; // Export before delete\n  audit_log?: boolean;   // Log to audit trail (default: true)\n}\n\n/**\n * Data cleanup job data\n */\nexport interface DataCleanupJobData {\n  organization_id: string;\n  data_type: DataType;\n  dry_run?: boolean;\n  batch_size?: number;\n}\n\n/**\n * Data cleanup result\n */\nexport interface DataCleanupResult {\n  organization_id: string;\n  data_type: DataType;\n  records_processed: number;\n  records_deleted: number;\n  errors: number;\n  duration_ms: number;\n  completed_at: string;\n}\n\n/**\n * GDPR compliance status\n */\nexport interface GDPRComplianceStatus {\n  organization_id: string;\n  retention_policies_configured: boolean;\n  auto_deletion_enabled: boolean;\n  data_types_covered: DataType[];\n  pending_deletion_requests: number;\n  last_retention_enforcement: string | null;\n  compliance_score: number; // 0-100\n  issues: string[];\n  recommendations: string[];\n}\n\n/**\n * Anonymization options\n */\nexport interface AnonymizationOptions {\n  anonymize_name?: boolean;\n  anonymize_email?: boolean;\n  anonymize_phone?: boolean;\n  preserve_analytics?: boolean; // Keep anonymized data for analytics\n}\n\n/**\n * Soft delete filter for queries\n */\nexport interface SoftDeleteFilter {\n  include_deleted?: boolean; // Include soft-deleted records\n  deleted_only?: boolean;    // Only return deleted records\n}\n\n/**\n * Batch deletion options\n */\nexport interface BatchDeletionOptions {\n  batch_size?: number;        // Records per batch (default: 100)\n  delay_between_batches?: number; // Milliseconds (default: 1000)\n  max_total_records?: number;     // Maximum total deletions\n  stop_on_error?: boolean;        // Stop if any deletion fails\n}\n\n/**\n * Retention policy statistics\n */\nexport interface RetentionPolicyStats {\n  organization_id: string;\n  data_type: DataType;\n  total_records: number;\n  expired_records: number;\n  oldest_record_age_days: number | null;\n  retention_days: number;\n  last_enforced_at: string | null;\n  estimated_cleanup_time_ms: number;\n}\n"],"mappings":"AAAA;;;;;;;GAAA,CASA;;MAEC;;AAAA;AAAA,SAAAA,eAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,MAAA,OAAAC,QAAA;EAAA,IAAAC,GAAA;EAAA,IAAAC,YAAA;IAAAL,IAAA;IAAAM,YAAA;MAAA;QAAAC,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;IAAA;IAAAE,KAAA;IAAAC,SAAA;IAAAC,CAAA;MAAA;IAAA;IAAAC,CAAA;IAAAC,CAAA;IAAAC,cAAA;MAAAC,OAAA;MAAAC,OAAA;MAAAC,cAAA;MAAAC,KAAA;MAAAC,QAAA;IAAA;IAAAC,eAAA;IAAArB,IAAA;EAAA;EAAA,IAAAsB,QAAA,GAAArB,MAAA,CAAAE,GAAA,MAAAF,MAAA,CAAAE,GAAA;EAAA,KAAAmB,QAAA,CAAAvB,IAAA,KAAAuB,QAAA,CAAAvB,IAAA,EAAAC,IAAA,KAAAA,IAAA;IAAAsB,QAAA,CAAAvB,IAAA,IAAAK,YAAA;EAAA;EAAA,IAAAmB,cAAA,GAAAD,QAAA,CAAAvB,IAAA;EAAA","ignoreList":[]}