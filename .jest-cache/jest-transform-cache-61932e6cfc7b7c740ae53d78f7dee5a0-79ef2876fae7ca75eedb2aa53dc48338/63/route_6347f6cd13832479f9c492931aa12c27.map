{"version":3,"names":["GET","cov_1ypw9r2zxv","f","s","PATCH","request","middlewareResponse","_middleware","adminMiddleware","b","settings","_superadmin","getSystemSettings","_server","NextResponse","json","error","status","logSuperAdminAction","undefined","headers","get","console","key","value","description","success","updateSystemSetting"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\admin\\settings\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { getSystemSettings, updateSystemSetting, logSuperAdminAction } from '@/lib/super-admin'\nimport { adminMiddleware } from '@/lib/middleware'\n\nexport async function GET(request: NextRequest) {\n  // Apply admin middleware (validates super admin access)\n  const middlewareResponse = await adminMiddleware(request);\n  if (middlewareResponse) return middlewareResponse;\n\n  try {\n    const settings = await getSystemSettings()\n\n    if (!settings) {\n      return NextResponse.json(\n        { error: 'Failed to fetch system settings' },\n        { status: 500 }\n      )\n    }\n\n    // Log settings access\n    await logSuperAdminAction(\n      'view_system_settings',\n      'system',\n      undefined,\n      {},\n      request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || 'unknown',\n      request.headers.get('user-agent') || undefined\n    )\n\n    return NextResponse.json({ settings })\n  } catch (error) {\n    console.error('Admin settings API error:', error)\n    return NextResponse.json(\n      { error: 'Failed to fetch system settings' },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function PATCH(request: NextRequest) {\n  // Apply admin middleware (validates super admin access)\n  const middlewareResponse = await adminMiddleware(request);\n  if (middlewareResponse) return middlewareResponse;\n\n  try {\n    const { key, value, description } = await request.json()\n\n    if (!key || value === undefined) {\n      return NextResponse.json(\n        { error: 'Key and value are required' },\n        { status: 400 }\n      )\n    }\n\n    const success = await updateSystemSetting(key, value, description)\n\n    if (!success) {\n      return NextResponse.json(\n        { error: 'Failed to update system setting' },\n        { status: 500 }\n      )\n    }\n\n    return NextResponse.json({ success: true })\n  } catch (error) {\n    console.error('Admin settings update API error:', error)\n    return NextResponse.json(\n      { error: 'Failed to update system setting' },\n      { status: 500 }\n    )\n  }\n}"],"mappings":"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","ignoreList":[]}