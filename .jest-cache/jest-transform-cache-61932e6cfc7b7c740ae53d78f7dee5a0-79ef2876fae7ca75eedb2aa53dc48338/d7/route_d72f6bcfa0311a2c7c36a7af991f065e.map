{"version":3,"names":["GET","cov_1p25yw865s","f","s","POST","request","middlewareResponse","_middleware","standardApiMiddleware","b","organizationId","getTenantContext","searchParams","URL","url","category","get","status","whatsappStatus","page","limit","offset","_apiutils","validatePagination","supabase","_server1","createClient","query","from","select","count","eq","data","templates","error","order","ascending","range","templatesWithStats","Promise","all","map","template","usage","id","usageCount","length","createSuccessResponse","pagination","total","hasMore","console","createErrorResponse","userId","body","json","name","content","variables","whatsappTemplate","submitToWhatsApp","_server","NextResponse","Array","isArray","variable","type","whatsappTemplateId","whatsappClient","_enhancedclient","getWhatsAppClient","org","single","whatsapp_business_account_id","createTemplate","message","insert","organization_id","created_by","whatsapp_template_id","whatsapp_template_name","whatsapp_status","whatsapp_template_data","is_active"],"sources":["C:\\Ai Projecten\\ADSapp\\src\\app\\api\\templates\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createClient } from '@/lib/supabase/server'\nimport { requireAuthenticatedUser, getUserOrganization, createErrorResponse, createSuccessResponse, validatePagination } from '@/lib/api-utils'\nimport { getWhatsAppClient } from '@/lib/whatsapp/enhanced-client'\nimport { standardApiMiddleware, getTenantContext } from '@/lib/middleware'\n\nexport async function GET(request: NextRequest) {\n  // Apply standard API middleware (tenant validation + standard rate limiting)\n  const middlewareResponse = await standardApiMiddleware(request);\n  if (middlewareResponse) return middlewareResponse;\n\n  try {\n    // Get tenant context from middleware (already validated)\n    const { organizationId } = getTenantContext(request);\n\n    const { searchParams } = new URL(request.url)\n    const category = searchParams.get('category')\n    const status = searchParams.get('status')\n    const whatsappStatus = searchParams.get('whatsappStatus')\n    const { page, limit, offset } = validatePagination(request)\n\n    const supabase = await createClient()\n\n    let query = supabase\n      .from('message_templates')\n      .select('*', { count: 'exact' })\n      .eq('organization_id', organizationId)\n\n    if (category) {\n      query = query.eq('category', category)\n    }\n\n    if (status) {\n      query = query.eq('is_active', status === 'active')\n    }\n\n    if (whatsappStatus) {\n      query = query.eq('whatsapp_status', whatsappStatus)\n    }\n\n    const { data: templates, error, count } = await query\n      .order('created_at', { ascending: false })\n      .range(offset, offset + limit - 1)\n\n    if (error) {\n      throw error\n    }\n\n    // Get usage statistics for each template\n    const templatesWithStats = await Promise.all(\n      (templates || []).map(async (template) => {\n        const { data: usage } = await supabase\n          .from('messages')\n          .select('id')\n          .eq('template_id', template.id)\n\n        return {\n          ...template,\n          usageCount: usage?.length || 0\n        }\n      })\n    )\n\n    return createSuccessResponse({\n      templates: templatesWithStats,\n      pagination: {\n        page,\n        limit,\n        total: count || 0,\n        hasMore: offset + limit < (count || 0)\n      }\n    })\n\n  } catch (error) {\n    console.error('Error fetching templates:', error)\n    return createErrorResponse(error)\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  // Apply standard API middleware (tenant validation + standard rate limiting)\n  const middlewareResponse = await standardApiMiddleware(request);\n  if (middlewareResponse) return middlewareResponse;\n\n  try {\n    // Get tenant context from middleware (already validated)\n    const { organizationId, userId } = getTenantContext(request);\n\n    const body = await request.json();\n    const {\n      name,\n      content,\n      category = 'general',\n      variables = [],\n      whatsappTemplate,\n      submitToWhatsApp = false\n    } = body\n\n    if (!name || !content) {\n      return NextResponse.json(\n        { error: 'Name and content are required' },\n        { status: 400 }\n      )\n    }\n\n    const supabase = await createClient()\n\n    // Validate variables format\n    if (!Array.isArray(variables)) {\n      return NextResponse.json(\n        { error: 'Variables must be an array' },\n        { status: 400 }\n      )\n    }\n\n    for (const variable of variables) {\n      if (!variable.name || !variable.type) {\n        return NextResponse.json(\n          { error: 'Each variable must have name and type' },\n          { status: 400 }\n        )\n      }\n    }\n\n    let whatsappTemplateId: string | null = null\n    let whatsappStatus = 'draft'\n\n    // Submit to WhatsApp if requested\n    if (submitToWhatsApp && whatsappTemplate) {\n      try {\n        const whatsappClient = await getWhatsAppClient(organizationId)\n\n        // Get organization's business account ID\n        const { data: org } = await supabase\n          .from('organizations')\n          .select('whatsapp_business_account_id')\n          .eq('id', organizationId)\n          .single()\n\n        if (!org?.whatsapp_business_account_id) {\n          return NextResponse.json(\n            { error: 'WhatsApp Business Account not configured' },\n            { status: 400 }\n          )\n        }\n\n        whatsappTemplateId = await whatsappClient.createTemplate(\n          org.whatsapp_business_account_id,\n          whatsappTemplate\n        )\n\n        whatsappStatus = 'pending'\n      } catch (error) {\n        console.error('Error submitting template to WhatsApp:', error)\n        return NextResponse.json(\n          { error: `Failed to submit template to WhatsApp: ${error.message}` },\n          { status: 400 }\n        )\n      }\n    }\n\n    // Create template in database\n    const { data: template, error } = await supabase\n      .from('message_templates')\n      .insert({\n        organization_id: organizationId,\n        created_by: userId,\n        name,\n        content,\n        category,\n        variables,\n        whatsapp_template_id: whatsappTemplateId,\n        whatsapp_template_name: whatsappTemplate?.name,\n        whatsapp_status: whatsappStatus,\n        whatsapp_template_data: whatsappTemplate,\n        is_active: true\n      })\n      .select()\n      .single()\n\n    if (error) {\n      throw error\n    }\n\n    return createSuccessResponse(template, 201)\n\n  } catch (error) {\n    console.error('Error creating template:', error)\n    return createErrorResponse(error)\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}