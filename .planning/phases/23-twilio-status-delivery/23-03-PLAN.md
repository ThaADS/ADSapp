# Plan 23-03: Real-time Status Updates API

## Overview
Create API endpoint for real-time message status polling and prepare for Supabase Realtime integration.

## Requirements Addressed
- TWWS-01: UI reflects current state via Realtime

## Deliverables

### 1. Message Status API
**File:** `src/app/api/messages/[id]/status/route.ts`

```typescript
// GET /api/messages/[id]/status
// Returns current status and history
{
  currentStatus: 'delivered',
  timestamps: {
    sent: '2026-02-03T10:00:00Z',
    delivered: '2026-02-03T10:00:05Z',
    read: null
  },
  error: null,
  history: [
    { status: 'queued', timestamp: '...' },
    { status: 'sent', timestamp: '...' },
    { status: 'delivered', timestamp: '...' }
  ]
}
```

### 2. Conversation Messages Status API
**File:** `src/app/api/conversations/[id]/messages/status/route.ts`

Batch status check for all messages in conversation:
```typescript
// GET /api/conversations/[id]/messages/status
// Returns status for recent outbound messages
```

### 3. Supabase Realtime Configuration
Document Realtime subscription pattern for frontend:
```typescript
const channel = supabase
  .channel('message-status')
  .on('postgres_changes', {
    event: 'UPDATE',
    schema: 'public',
    table: 'messages',
    filter: `conversation_id=eq.${conversationId}`,
  }, (payload) => {
    // Update UI with new status
  })
  .subscribe()
```

## Acceptance Criteria
- [ ] Single message status API endpoint
- [ ] Batch conversation status endpoint
- [ ] Realtime subscription pattern documented
- [ ] Authentication and authorization enforced

## Dependencies
- Plan 23-02 (status tracking works)
